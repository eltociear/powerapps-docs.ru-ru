---
title: Развертывание приложения для службы экстренной медицинской помощи | Документация Майкрософт
description: Статья содержит подробные инструкции для ИТ-администраторов больниц по развертыванию и настройке примера приложения в организации.
author: pankajarora-msft
manager: annbe
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 04/15/2020
ms.author: pankar
ms.reviewer: kvivek
searchScope:
- PowerApps
ms.openlocfilehash: 132276b88fe23e9ea4a69caeff330c10f7d32daf
ms.sourcegitcommit: 371fb08328f88f8bae7335db413d52b5c961c3e4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81544022"
---
# <a name="deploy-the-hospital-emergency-response-app"></a>Развертывание приложения для службы экстренной медицинской помощи

Приложению для службы экстренной медицинской помощи требуется немного настроек для адаптации к вашим потребностям. Статья содержит пошаговые инструкции для ИТ-администраторов больниц по развертыванию и настройке примера приложения в организации.

Предполагаемое время выполнения этой процедуры: **35–40 минут**.

## <a name="demo-deploy-the-hospital-emergency-response-app"></a>Демонстрация. Развертывание приложения для службы экстренной медицинской помощи

Просмотрите видео о том, как развернуть и настроить приложение для службы экстренной медицинской помощи.

<br/>

> [!VIDEO https://www.youtube.com/embed/-1g44wNiuWI]


## <a name="service-urls-for-us-government-customers"></a>URL-адреса служб для клиентов из государственных организаций США

Решение для службы экстренной медицинской помощи доступно также для государственных организаций США. URL-адреса для доступа к средам Power Apps для государственных организаций США и Power BI отличаются от URL-адресов коммерческой версии.

В этой статье используется URL-адрес коммерческой версии служб. Если вы клиент из государственной организации США, используйте соответствующий URL-адрес, как указано здесь:


| **URL-адрес коммерческой версии**                | **URL-адрес версии для государственных организаций США**  |
|-------------------------------------------|--------------------------------|
| https://make.powerapps.com                | https://make.gov.powerapps.us (GCC)<br/><br/>https://make.high.powerapps.us (GCC High)                |
| https://admin.powerplatform.microsoft.com | https://gcc.admin.powerplatform.microsoft.us (GCC)<br/><br/>https://high.admin.powerplatform.microsoft.us (GCC High) |
| https://app.powerbi.com/                  | <https://app.powerbigov.us> (GCC)<br/><br/>https://app.high.powerbigov.us (GCC High)                  |

Подробные сведения о планах на Power Apps и Power BI для государственных организаций США см. в следующих статьях:
- [Power Apps для государственных организаций США](https://docs.microsoft.com/power-platform/admin/powerapps-us-government)
- [Power BI для государственных организаций США](https://docs.microsoft.com/power-bi/service-govus-overview)


## <a name="deploy-the-hospital-emergency-response-app"></a>Развертывание приложения для службы экстренной медицинской помощи

Чтобы развернуть пример приложения для службы экстренной медицинской помощи, выполните следующие шаги:

- [Шаг 1. Регистрация в Power Apps и создание среды](#step-1-sign-up-for-power-apps-and-create-an-environment)
- [Шаг 2. Скачивание и развертывание пакета](#step-2-download-the-deployment-package)
- [Шаг 3. Импорт файла решения в среду](#step-3-import-the-solution-file-into-your-environment)
- [Шаг 4. Загрузка конфигурации и основных данных организации](#step-4-load-configuration-and-master-data-for-your-organization)
    - [Шаг 4.1. Загрузка обязательных данных конфигурации](#step-41-load-mandatory-configuration-data)
    - [Шаг 4.2. Загрузка основных данных](#step-42-load-master-data)
- [Шаг 5. Обновление фирменной символики мобильного приложения](#step-5-update-the-mobile-app-branding)
- [Шаг 6. Обход согласия для мобильных приложений](#step-6-bypass-consent-for-mobile-apps)
- [Шаг 7. Добавление ключа Azure Application Insights в мобильные приложения для телеметрии (необязательно)](#step-7-add-azure-application-insights-key-to-mobile-apps-for-telemetry-optional)
- [Шаг 8. Предоставление общего доступа к приложениям холста пользователям в организации](#step-8-share-canvas-apps-with-users-in-your-organization)
- [Шаг 9. Настройка мобильного приложения в качестве главного и рекомендуемого приложения](#step-9-set-your-mobile-app-as-hero-and-featured-app)
- [Шаг 10. Совместное использование приложения на основе модели с администраторами в организации](#step-10-share-model-driven-app-with-admins-in-your-organization)

### <a name="step-1-sign-up-for-power-apps-and-create-an-environment"></a>Шаг 1. Регистрация в Power Apps и создание среды

Если у вас еще нет Power Apps, зарегистрируйтесь в этой службе и приобретите соответствующую лицензию.

Дополнительные сведения:

-   [Цены на приложения Power Apps](https://powerapps.microsoft.com/pricing/).
-   [Покупка Power Apps для вашей организации](https://docs.microsoft.com/power-platform/admin/signup-for-powerapps-admin).

После приобретения Power Apps создайте среду с базой данных Common Data Service.

1.  Войдите в [Центр администрирования Power Platform](https://aka.ms/ppac).

2.  Создайте среду Common Data Service с базой данных. Дополнительные сведения: [Создание сред и управление ими в Центре администрирования Power Platform](https://docs.microsoft.com/power-platform/admin/create-environment).

    > [!IMPORTANT]
    > При создании базы данных в ходе выбора группы безопасности для базы данных приложения могут быть общими *только* с пользователями, входящими в группу безопасности.

3.  Создайте соответствующих пользователей в среде. Дополнительные сведения: [Создание пользователей и назначение ролей безопасности](https://docs.microsoft.com/power-platform/admin/create-users-assign-online-security-roles).

### <a name="step-2-download-the-deployment-package"></a>Шаг 2. Скачивание и развертывание пакета

Получите последний пакет развертывания (ZIP-файл) по адресу <https://aka.ms/emergency-response-solution>. Этот пакет содержит файл решения, образы и файлы с данными для настройки приложений и бизнес-логики для приложения для службы экстренной медицинской помощи.

> [!IMPORTANT]
> Перед извлечением пакета развертывания (ZIP-файла) убедитесь, что файл разблокирован. Чтобы разблокировать файл, выполните действия ниже:
> 1. Щелкните правой кнопкой мыши этот ZIP-файл и выберите пункт **Свойства**.
> 2. В диалоговом окне свойств щелкните **Разблокировать**, **Применить**, а затем нажмите кнопку **ОК**.

<br/>

После разблокировки файла развертывания (ZIP-файла) извлеките файл в расположение на компьютере. Извлеченная папка будет содержать следующие папки:

| **Папка или файл**       | **Описание**  |
|-----------------------|------------------|
| **App Icons** (Значки приложений)         | Содержит значки приложений по умолчанию для мобильных приложений (приложения холста).|
| **Data Files** (Файлы данных)        | Содержит основные файлы и файлы образцов данных (XLSX) для работы решения или приложения. Вы можете импортировать данные из этих файлов, чтобы начать работу с приложением. Дополнительные сведения см. в разделе [Шаг 4. Загрузка конфигурации и основных данных организации](#step-4-load-configuration-and-master-data-for-your-organization). |
| **Шаблон Power BI** | Содержит файл шаблона отчета Power BI (PBIT-файл), который будет использоваться для настройки отчетов в вашей организации. Дополнительные сведения: [Публикация панели мониторинга Power BI](#publish-the-power-bi-dashboard)|
| **PowerShell**        | Содержит сценарии, которые вы будете использовать для настройки своих мобильных приложений (приложений холста). |
| **Solution File** (Файл решения)     | Содержит файл решения Common Data Service, который создает приложения и метаданные, необходимые для приложения для службы экстренной медицинской помощи.  |

### <a name="step-3-import-the-solution-file-into-your-environment"></a>Шаг 3. Импорт файла решения в среду

1.  Перейдите в папку, в которую извлечен файл развертывания (ZIP-файл). Вы найдете папку **Solution File** (Файл решения). Импортируйте файл управляемого решения (ZIP-файл) в папку **Solution File** (Файл решения) в нашу среду.

2.  Выполните вход в [Power Apps](https://make.powerapps.com).

3.  Выберите среду в правом верхнем углу.

4.  В левой области выберите **Solutions** (Решения), а затем щелкните **Импорт**.

    > [!div class="mx-imgBorder"] 
    > ![Импорт решения](media/conf-import-solution.png "Импорт решения")

5.  В диалоговом окне **Import Solution** (Импорт решения) выберите файл решения, упомянутый на шаге 1, и следуйте указаниям мастера, чтобы импортировать решение.

6.  После успешного импорта решения щелкните **Закрыть** в диалоговом окне импорта.

Теперь вы увидите новые приложения в разделе **Приложения**:

> [!div class="mx-imgBorder"] 
> ![Новые приложения](media/conf-apps-new-apps.png "Новые приложения")

Выберите **Admin App** (Приложение администрирования), чтобы открыть приложение на основе модели, позволяющее настроить остальные параметры развертывания. Дополнительные сведения: [Основные сведения о приложениях на основе модели](https://docs.microsoft.com/powerapps/maker/model-driven-apps/model-driven-app-overview)

> [!div class="mx-imgBorder"] 
> ![Открытие приложения администрирования](media/conf-admin-app-open.png "Открытие приложения администратора")

В приложении администрирования есть несколько сущностей, с помощью которых можно добавлять данные в систему больницы и управлять ими. Чтобы выбрать другую область, можно использовать средство выбора области в нижней части левой панели навигации.

### <a name="step-4-load-configuration-and-master-data-for-your-organization"></a>Шаг 4. Загрузка конфигурации и основных данных организации

Все данные, необходимые для приложения для службы экстренной медицинской помощи, доступны в папке **Data Files** (Файлы данных) в извлеченной папке развертывания.

Папка **Data Files** (Файлы данных) содержит следующие файлы и папки:

<table style="width:100%">
<tr>
<th>Имя</th>
<th>Описание</th>
</tr>
<tr>
<td>В корневой папке доступны следующие файлы:
<ul>
<li>00 - Acuities Import.xlsx</li>
<li>00 - App Config Import.xlsx</li>
<li>00 - App Import.xlsx</li>
<li>00 - Request Roles Import.xlsx</li>
<li>00 - Supplies Import.xlsx</li>
</ul>
</td>
<td>Это файлы данных конфигурации, которые необходимо импортировать в следующие сущности с помощью приложения администрирования:
<ul>
<li>Acuities (Неотложность медицинской помощи)</li>
<li>App Config (Конфигурация приложения)</li>
<li>Приложения</li>
<li>Request Roles (Запрошенные роли)</li>
<li>Supplies Import (Импорт запасов)</li>
</ul>
<br/>При импорте данных в эти сущности для этих сущностей будут созданы записи, которые необходимы для работы приложения для службы экстренной медицинской помощи.
<br/>
<br/>
<strong>Внимание</strong>! Убедитесь, что значения конфигурации в этих сущностях, за исключением <strong>Apps</strong> (Приложения) и <strong>App Config</strong> (Конфигурация приложений), не будут обновляться. Необходимость в этом описана ниже.</td>
</tr>
<tr>
<td>Папка <strong>Sample Data</strong> (Примеры данных)</td>
<td><p>В этой папке содержатся образцы файлов данных (XLSX-файлы), которые можно импортировать для заполнения примера данных в приложении. Имена присваиваются файлам согласно последовательности, в которой данные должны быть импортированы в приложение. </p>
<p>Импортируйте данные для следующих сущностей, содержащих пример данных приложения для службы экстренной медицинской помощи:
<ul>
<li>Systems (Системы)</li>
<li>области</li>
<li>Facilities (Учреждения)</li>
<li>Расположения</li>
<li>Подразделения</li>
</ul>
<p>Если вы хотите импортировать данные организации вместо примеров данных, можно заменить примеры в этих файлах Excel данными организации, а затем импортировать данные в приложение.</p>
<p>Можно также вручную ввести данные для этих сущностей. Сведения о каждой из этих сущностей и их полях см. в статье <a href="configure-data-reporting.md#configure-and-manage-master-data-for-your-organization">о настройке основных данных об организации и управлению ими</a>.</p></td>
</tr>
<tr>
<td>Папка <strong>Data Template File for Master Data</strong> (Файл примеров данных для основных данных)</td>
<td><p>Папка содержит пустые файлы данных (XLSX-файлы) для основных сущностей, которые можно использовать для заполнения данных организации, а затем импортировать их в приложение.</p>
<p>Имена присваиваются файлам согласно последовательности, в которой данные должны быть импортированы в приложение. Это тот же список сущностей, который упоминается ранее для папки <strong>Sample Data</strong> (Примеры данных).</p>
<p>Можно также вручную ввести данные для этих сущностей. Сведения о каждой из этих сущностей и их полях см. в статье <a href="configure-data-reporting.md#configure-and-manage-master-data-for-your-organization">о настройке основных данных об организации и управлению ими</a>.</p>
</td>
</tr>
</table>

#### <a name="step-41-load-mandatory-configuration-data"></a>Шаг 4.1. Загрузка обязательных данных конфигурации

Импорт данных конфигурации под следующими сущностями в приложении администратора является **обязательным** перед переходом к следующему шагу:

| Имя области | Имя сущности| Имя файла
|-|-|-
| Расположения | Acuities (Неотложность медицинской помощи) | 00 - Acuities Import.xlsx
| Администрирование | App Config (Конфигурация приложений) | 00 - App Config Import.xlsx
| Администрирование | Приложения | 00 - App Import.xlsx
| Staffing (Персонал) | Request Roles (Запрошенные роли) | 00 - Request Roles Import.xlsx
| Расположения | Supplies (Снабжение) | 00 - Supplies Import.xlsx

##### <a name="how-to-load-data-from-data-files"></a>Как загружать данные из файлов данных

Чтобы импортировать данные из одного из файлов данных в сущность, выполните следующие действия:

1.  В области навигации слева в приложении администрирования выберите сущность, для которой требуется загрузить данные. Например, щелкните **Администрирование** в средстве выбора области, а затем выберите **Acuities**.

2.  Щелкните **Импорт из Excel** и выберите файл **00 - Acuities Import.xlsx** в папке **Data Files** (Файлы данных).

    > [!div class="mx-imgBorder"]
    > ![Импорт данных из Excel](media/conf-import-from-excel.png "Импорт данных из Excel")

3.  Перейдите к шагам мастера импорта, чтобы импортировать данные.

4.  После импорта данных вы увидите импортированную запись в сущности:

    > [!div class="mx-imgBorder"] 
    > ![Запись сущности](media/conf-entity-record.png "Запись в сущности после импорта")

Повторите описанные выше действия с другими сущностями данных конфигурации.

Сведения о том, как вручную ввести основные данные, см. в статье [о настройке основных данных об организации и управлению ими](configure-data-reporting.md#configure-and-manage-master-data-for-your-organization).

#### <a name="step-42-load-master-data"></a>Шаг 4.2. Загрузка основных данных

Как говорилось ранее,
- вы можете использовать образцы файлов данных для сущностей основных данных в папке **Data Files/Sample Data**, чтобы импортировать образцы данных в нужные сущности. 

- Можно использовать "пустые" файлы данных для основных сущностей в папке **Data Files/Data Template File for Master Data** для заполнения данных организации, а затем импортировать данные в нужные сущности.

Основные данные также можно добавить в дальнейшем вручную. Дополнительные сведения: [Настройка основных данных об организации и управление ими](configure-data-reporting.md#configure-and-manage-master-data-for-your-organization)

### <a name="step-5-update-the-mobile-app-branding"></a>Шаг 5. Обновление фирменной символики мобильного приложения

Можно менять значок, цветовую схему или отображаемое имя мобильных приложений в соответствии с фирменной символикой вашей организации.

Это делается с помощью сущностей **Apps** (Приложения) и **App Config** (Конфигурация приложений) в области **Администрирование** путем импорта данных приложения и его конфигурации из файла Excel, доступного в папке **Data Files** (Файлы данных) и файлов значков в папке **App Icons** в пакете развертывания, как описано в разделе [Шаг 2. Скачивание пакета развертывания](#step-2-download-the-deployment-package).

> [!div class="mx-imgBorder"] 
> ![Сущности Apps (Приложения) и App Config (Конфигурация приложений)](media/conf-app-app-config-entities.png "Сущности Apps (Приложения) и App Config (Конфигурация приложений)")

1.  Убедитесь, что вы импортировали данные конфигурации для сущностей **Apps** (Приложения) и **App Config** (Конфигурация приложений) из файлов **App Import.xlsx** и **App Config Import.xlsx** соответственно.

1.  Теперь скопируйте идентификаторы для приложений холста, чтобы ими можно было заполнить значения в импортированных записях сущности **Apps** (Приложения). Выполните вход в [Power Apps](https://make.powerapps.com).

1.  Выберите среду в правом верхнем углу.

1.  В области слева щелкните **Apps** (Приложения), нажмите меню-многоточие (...), чтобы открыть приложения холста, а затем выберите пункт **Сведения**.

    > [!div class="mx-imgBorder"] 
    > ![Сведения о приложениях](media/conf-environments-apps-details.png "Сведения о приложении")

1.  Идентификатор отобразится внизу в области  **Сведения**  этого приложения. Скопируйте идентификатор приложения вместе с его именем в файл Блокнота.

    > [!div class="mx-imgBorder"] 
    > ![Сведения об идентификаторе приложения](media/conf-details-app-id.png "Сведения об идентификаторе приложения")

1.  Повторите шаги 4 и 5 для каждого приложения на основе холста.

1.  Откройте приложение администрирования и в левой области навигации выберите **Администрирование** в средстве выбора области, а затем **Apps** (Приложения). Будут показаны все записи приложений холста, импортированные из файла **App Import.xlsx**.

    > [!div class="mx-imgBorder"] 
    > ![Приложения администрирования](media/conf-admin-app-records.png "Приложения администрирования")

1.  Выберите и откройте одну из записей приложений. Обратите внимание, что поле **Power App ID** (Идентификатор Power App) является пустым.

    > [!div class="mx-imgBorder"] 
    > ![Поле идентификатора Power App](media/conf-powerapp-id-field.png "Обновление сведений о приложении")

1.  На странице сведений о приложении:

    1. скопируйте из файла Блокнота идентификатор приложения, скопированный ранее, в поле **Идентификатор Power App**.

    2. Дважды щелкните значок приложения и выберите файл значка для приложения в папке **App Icons**. Файлы изображений имеют интуитивно понятные имена, поэтому можно легко выбрать правильный значок. Например, выберите файл "Emergency Response App.png" в случае **приложения для реагирования на чрезвычайные ситуации**. Вы также можете выбрать пользовательское изображение в соответствии с фирменной символикой организации.

    3. При необходимости измените **описание** или **отображаемое имя** приложения.

    4. При необходимости измените параметр **Hide App from Menu** (Скрыть приложение в меню), чтобы указать, должно ли приложение отображаться в списке приложений. Поскольку **приложение для реагирования на чрезвычайные ситуации** является приложением-контейнером, значение по умолчанию — **Нет**.

    5. При необходимости измените **App Display Rank** (Ранг отображения приложения), чтобы указать место приложения в списке.

    6. Если нужно, выберите значение в поле **Уровень отслеживания**, чтобы указать, следует ли отслеживать данные в этом мобильном приложении на уровне **расположения** или **учреждения**. Дополнительные сведения: [Управление уровнем отслеживания для мобильных приложений](configure-data-reporting.md#manage-tracking-level-for-mobile-apps)

    7. Нажмите кнопку **Сохранить**.

1.  Повторите шаги 8 и 9 для каждого приложения на основе холста в разделе **Приложения**.

1.  В левой области щелкните сущность **App Config** (Конфигурация приложений).

1.  Выберите запись **Приложение для реагирования на чрезвычайные ситуации** , чтобы открыть ее для редактирования.

    1.  При необходимости измените цвета для приложения.

    2.  Выберите значение **Да** или **Нет** в поле **Device Sharing Enabled** (Включение общего доступа к устройствам), чтобы указать, будет ли доступен параметр **Выход** в мобильных приложениях. При выборе варианта **Да** будет доступен **Выход**. Дополнительные сведения: см. раздел [End shift — sign out](use.md#end-shift---sign-out) (Закончить смену — выход) в руководстве пользователя.

    > [!div class="mx-imgBorder"] 
    > ![Поле Device Sharing Enabled (Включение общего доступа к устройствам)](media/conf-device-sharing-enabled-field.png "Поле Device Sharing Enabled (Включение общего доступа к устройствам)")

1.  Нажмите кнопку **Сохранить** в правом нижнем углу, чтобы сохранить изменения.

### <a name="step-6-bypass-consent-for-mobile-apps"></a>Шаг 6. Обход согласия для мобильных приложений

Для выполнения этого шага необходимо быть администратором клиента. Кроме того, для выполнения этого шага требуется идентификатор для каждого мобильного приложения (приложения холста).

Чтобы получить идентификатор для приложения, в приложении администрирования выберите **Администрирование** в средстве выбора области, а затем щелкните **Apps** (Приложения). Отобразятся все мобильные приложения (приложения холста). Выберите мобильное приложение, чтобы просмотреть его идентификатор. Скопируйте идентификатор приложения для каждого приложения в файл Блокнота.

> [!div class="mx-imgBorder"] 
> ![Получение идентификатора приложения](media/conf-admin-get-app-id.png "Получение идентификатора приложения")

Затем выполните описанные ниже действия.

1.  Откройте Блокнот и скопируйте этот сценарий PowerShell:

    ```powershell
    # MUST BE A TENANT ADMIN TO RUN THIS
    Install-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Install-Module -Name Microsoft.PowerApps.PowerShell -AllowClobber
    Import-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Import-Module -Name Microsoft.PowerApps.PowerShell
    
    # This call opens prompt to collect credentials 
    # (Azure Active Directory account and password) 
    # used by the commands
    Add-PowerAppsAccount
    
    # Change the App ID for each new app (APPGUIDHERE)
    Set-AdminPowerAppApisToBypassConsent -AppName APPGUIDHERE
    ```

2.  Замените значение `APPGUIDHERE` фактическим идентификатором приложения на основе холста.

3.  Сохраните файл в формате PS.

4.  Запустите PowerShell от имени администратора и выполните только что созданный PS-файл.

5.  Повторите шаги 2 и 4 для каждого приложения холста.

### <a name="step-7-add-azure-application-insights-key-to-mobile-apps-for-telemetry-optional"></a>Шаг 7. Добавление ключа Azure Application Insights в мобильные приложения для телеметрии (необязательно)

Вы можете использовать Application Insights Azure для сбора подробных данных телеметрии для мобильных приложений (холста), чтобы получать сведения об использовании приложения. Подробные сведения об этом см. в статье [Анализ телеметрии приложения с помощью Application Insights](https://docs.microsoft.com/powerapps/maker/canvas-apps/application-insights).

### <a name="step-8-share-canvas-apps-with-users-in-your-organization"></a>Шаг 8. Предоставление общего доступа к приложениям холста пользователям в организации

Чтобы пользователи использовали данные с помощью приложений холста на своих мобильных устройствах, пользователям необходимо предоставить к ним общий доступ. Для простого предоставления доступа группам пользователей к приложениям можно использовать группы Azure AD.

> [!IMPORTANT]
> Убедитесь, что пользователь или группа, которым будет предоставлен общий доступ к приложениям, *уже* имеют доступ к вашей среде. Как правило, пользователи или группы добавляются во время [настройки среды](#step-1-sign-up-for-power-apps-and-create-an-environment). Кроме того, вы можете выполнить описанные здесь действия, чтобы добавить пользователей в среду и предоставить им соответствующие разрешения перед предоставлением общего доступа к приложениям. [Создание пользователей и назначение ролей безопасности](https://docs.microsoft.com/power-platform/admin/create-users-assign-online-security-roles).

1.  Войдите в [Power Apps](https://make.powerapps.com).

2.  В области навигации слева выберите сущность **Apps** (Приложения), чтобы просмотреть список всех приложений.

3.  Выберите мобильное приложение (приложение холста) и нажмите кнопку **Share** (Общий доступ) на баннере.

    > [!div class="mx-imgBorder"] 
    > ![Предоставление общего доступа к приложениям холста](media/conf-share-canvas-apps.png "Предоставление общего доступа к приложениям холста")

4.  Укажите группу или пользователей Azure AD, которым необходимо предоставить доступ к этому приложению. Так как приложение подключается к данным Common Data Service, необходимо также предоставить разрешения для сущностей. На панели общего доступа отобразится запрос управления безопасностью для сущностей. Назначьте роли безопасности **Emergency Response User** (Пользователь для реагирования на чрезвычайные ситуации) и **Common Data Service User** (Пользователь Common Data Service) для сущностей, используемых этим приложением, и щелкните **Share** (Общий доступ).

    > [!div class="mx-imgBorder"] 
    > ![Предоставление общего доступа к приложению группе или пользователям Azure AD](media/conf-share-app-groups-users.png "Предоставление общего доступа к приложению группе или пользователям Azure AD")

5.  Повторите шаги 3 и 4 для каждого мобильного приложения.

Подробные сведения о предоставлении общего доступа к приложениям см. [здесь](https://docs.microsoft.com/powerapps/maker/canvas-apps/share-app).

### <a name="step-9-set-your-mobile-app-as-hero-and-featured-app"></a>Шаг 9. Настройка мобильного приложения в качестве главного и рекомендуемого приложения

На этом шаге вы сможете сделать мобильное приложение главным и рекомендуемым в мобильном приложении **Power Apps**. Для выполнения этого шага необходимо быть администратором клиента.

Для выполнения этого шага требуется идентификатор для каждого мобильного приложения (приложения холста), которое вы хотите задать в качестве главного и рекомендуемого приложения. Сведения о получении идентификатора приложения холста см. в разделе [Шаг 6. Обход согласия для мобильных приложений](#step-6-bypass-consent-for-mobile-apps).

Затем выполните описанные ниже действия.

1.  Откройте Блокнот и скопируйте этот сценарий PowerShell:


    ```powershell
    # MUST BE A TENANT ADMIN TO RUN THIS
    Install-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Install-Module -Name Microsoft.PowerApps.PowerShell -AllowClobber
    Import-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Import-Module -Name Microsoft.PowerApps.PowerShell

    # This call opens prompt to collect credentials 
    # (Azure Active Directory account and password) 
    # used by the commands
    Add-PowerAppsAccount

    # Use the "Emergency Response App" App ID
    # To clear a featured app use Clear-AdminPowerAppAsFeatured

    #Change the App ID for each new app (APPGUIDHERE)
    Set-AdminPowerAppAsFeatured -AppName APPGUIDHERE

    # To clear a hero app use Clear-AdminPowerAppAsHero
    # Change the App ID for each new app (APPGUIDHERE)
    Set-AdminPowerAppAsHero -AppName APPGUIDHERE
    ```

2.  Замените значение `APPGUIDHERE` в скрипте фактическим идентификатором приложения, которое вы хотите задать в качестве главного и рекомендуемого приложения.

3.  Сохраните файл в формате PS.

4.  Запустите PowerShell от имени администратора и выполните только что созданный PS-файл.
 

### <a name="step-10-share-model-driven-app-with-admins-in-your-organization"></a>Шаг 10. Совместное использование приложения на основе модели с администраторами в организации

Чтобы пользователи с правами администратора могли использовать приложение администрирования (на основе модели), им необходимо предоставить общий доступ к этому приложению. Для простого предоставления доступа группе администраторов к приложениям можно использовать группы Azure AD.

> [!IMPORTANT]
> Убедитесь, что пользователь или группа, которым будет предоставлен общий доступ к приложению, *уже* имеют доступ к вашей среде. Как правило, пользователи или группы добавляются во время [настройки среды](#step-1-sign-up-for-power-apps-and-create-an-environment). Кроме того, вы можете выполнить описанные здесь действия, чтобы добавить пользователей в среду и предоставить им соответствующие разрешения перед предоставлением общего доступа к приложению. [Создание пользователей и назначение ролей безопасности](https://docs.microsoft.com/power-platform/admin/create-users-assign-online-security-roles).

1. Выполните вход в [Power Apps](https://make.powerapps.com).

2. В области навигации слева выберите сущность Apps (Приложения), чтобы просмотреть список всех приложений.

3. Выберите приложение на основе модели (**Admin App – Emergency Response App** (Приложение администрирования — приложение для реагирования на чрезвычайные ситуации)) и нажмите кнопку **Share** (Общий доступ) на баннере.

4. Укажите группу или администраторов Azure AD, которым необходимо предоставить общий доступ к этому приложению, назначьте роль **Emergency Response Admin** (Администратор приложения для реагирования на чрезвычайные ситуации) и щелкните **Share** (Общий доступ).

## <a name="publish-the-power-bi-dashboard"></a>Публикация панели мониторинга Power BI

Опубликуйте панель мониторинга Power BI и предоставьте к ней доступ пользователям в своей организации, чтобы они могли использовать эту панель для анализа и принятия решений.

Вы можете опубликовать панель мониторинга Power BI либо из шаблона приложения в AppSource, *либо* из **PBIT**-файла в пакете развертывания.

### <a name="option-a-publish-using-the-template-app-from-appsource-preferred-option"></a>Вариант А. Публикация с помощью шаблона приложения из AppSource (предпочтительный вариант)

Подробные сведения об использовании шаблона приложения из AppSource см. в статье [Подключение к панели поддержки принятия решений по неотложной медицинской помощи](https://docs.microsoft.com/power-bi/connect-data/service-connect-to-health-emergency-response).

> [!IMPORTANT]
> Это более простой способ публикации панели мониторинга Power BI по сравнению с использованием PBIT-файла. Рекомендуем клиентам использовать именно этот вариант. 

### <a name="option-b-publish-using-the-pbit-file-in-the-deployment-package"></a>Вариант Б. Публикация с помощью PBIT-файла в пакете развертывания

В этом разделе содержатся сведения о том, как использовать для публикации панели мониторинга **приложение аварийного реагирования** в формате PBIT-файла в пакете развертывания.

#### <a name="prerequisites"></a>Предварительные требования

- Лицензии "Емкость Power BI премиум-класса" и Power BI Pro, назначенные пользователям, получающим доступ к отчету. 

- Создайте рабочую область в Power BI, где будет опубликован отчет. Войдите в Power BI и создайте рабочую область. Дополнительные сведения: [Create the new workspaces in Power BI](https://docs.microsoft.com/power-bi/service-create-the-new-workspaces) (Создание рабочих областей новой версии в Power BI)

- Установите Power BI Desktop из магазина приложений Windows: <https://aka.ms/pbidesktop>

   > [!NOTE] 
   > Если вы установили Power BI Desktop, скачав решение напрямую со страницы Центра загрузки в качестве исполняемого файла, удалите его и используйте приложение из Microsoft Store. Версия из Microsoft Store будет обновляться автоматически при публикации новых выпусков.
   >
   > Если вы не можете установить приложение из Microsoft Store, установите последнюю версию не из Microsoft Store, на [странице Центра загрузки](https://www.microsoft.com/download/details.aspx?id=58494).

- После установки Power BI Desktop из магазина приложений запустите решение, войдите с использованием учетной записи с разрешением на публикацию приложений Power BI в вашей организации.

#### <a name="publish-the-dashboard-using-the-pbit-file"></a>Публикация панели мониторинга с помощью PBIT-файла

1. Перейдите в папку, в которую извлечен пакет развертывания. В папке **Шаблон Power BI** можно найти файл **App.pbit** для приложения для реагирования на чрезвычайные ситуации.

2. Откройте файл **App.pbit** приложения для реагирования на чрезвычайные ситуации в Power BI Desktop. Вам будет предложено ввести следующие значения:

    - **Organization_name** — введите название организации. Оно будет указано в левом верхнем углу каждой страницы отчета.
    - **CDS_base_solution_URL** — введите URL-адрес экземпляра среды Common Data Service. Например: https:// *[myenv]* .crm.dynamics.com.

    > [!div class="mx-imgBorder"]
    > ![Указание имени организации и базового URL-адреса](media/pbi-pub-rep1.png)

    Выберите **Загрузить**.

3. Вам будет предложено ввести учетные данные для подключения к среде Common Data Service. Выберите элементы **Учетная запись организации** > **Войти**, чтобы указать учетные данные Common Data Service.  

    > [!div class="mx-imgBorder"]
    > ![select-organizational-account](media/select-organizational-account.png)

4. После входа нажмите кнопку **Подключиться**, чтобы подключиться к своим данным в Common Data Service.

5. При успешном подключении данные будут отображаться в отчете Power BI. Вам будет предложено применить ожидающие изменения к запросу. Щелкните **Применить изменения**.

6. Нажмите кнопку **Опубликовать**, чтобы опубликовать данные в рабочей области Power BI. Вам будет предложено сохранить изменения. Нажмите кнопку **Сохранить**.

    > [!div class="mx-imgBorder"]
    > ![select-refresh-publish](media/select-refresh-publish.png)

7. Вам будет предложено сохранить PBIX-файл вместе со сведениями о среде Common Data Service. Укажите имя и сохраните его на компьютере.

8. После сохранения PBIX-файла вам будет предложено опубликовать отчет. На странице **Публикация в Power BI** выберите рабочую область, в которой необходимо выполнить публикацию. Затем щелкните **Выбрать**.

12. Отчет станет доступен в вашей рабочей области. Теперь настроим параметры обновления данных для набора данных. Выберите набор данных в рабочей области и щелкните значок **Запланировать обновление**.  
    
    > [!div class="mx-imgBorder"]
    > ![schedule-refresh](media/schedule-refresh.png)

13. При первой попытке установить параметр обновления данных отображается страница **параметров** с сообщением о том, что учетные данные недействительны. В разделе **Учетные данные источников данных** щелкните ссылку **Изменить учетные данные**.  

    > [!div class="mx-imgBorder"]
    > ![select-edit-credentials](media/select-edit-credentials.png)

14. На следующем экране выполните следующие шаги:
    - В качестве **метода проверки подлинности** выберите **OAuth2**.
    - В качестве **параметра уровня конфиденциальности для этого источника данных** выберите **Организационный**.
    - Выберите **Войти**.

    Вам будет предложено указать учетные данные и войти. После успешного входа вы вернетесь на страницу **параметров**.

15. На странице **параметров** разверните раздел **Запланированное обновление** и укажите необходимые сведения для обновления данных по расписанию. Нажмите кнопку **Применить**.

    > [!div class="mx-imgBorder"]
    > ![Запланированное обновление](media/refresh-schedule.png)

    > [!NOTE] 
    > Существуют ограничения на то, сколько раз данные могут обновляться. Для наборов данных в общей емкости Power BI допускает до восьми ежедневных обновлений. Если набор данных находится в емкости Premium, можно запланировать в параметрах набора данных до 48 обновлений в день. Дополнительные сведения: [Обновление данных](https://docs.microsoft.com/power-bi/refresh-data#data-refresh)

16. Выберите имя рабочей области в левой области, а затем нажмите кнопку **Создать приложение** в правом верхнем углу.  

    > [!div class="mx-imgBorder"]
    > ![select-create-app](media/select-create-app.png)

17. На странице публикации приложения выполните следующие действия.

    1. На вкладке **Setup** (Настройка) укажите имя и описание приложения.

    2. На вкладке **Навигация** укажите расположение панели мониторинга, в котором она будет опубликована.

    3. На вкладке **Разрешения** укажите пользователей или группу, которые смогут просматривать это приложение. Убедитесь, что установлен флажок **Install this app automatically** (Установить это приложение автоматически), чтобы автоматически устанавливать это приложение для пользователей. Дополнительные сведения: [Автоматическая установка приложений для конечных пользователей](https://docs.microsoft.com/power-bi/service-create-distribute-apps#automatically-install-apps-for-end-users)  

        > [!div class="mx-imgBorder"]
        > ![select-install-apps-automatically](media/select-install-apps-automatically.png)

18. Щелкните **Публикация приложения**. Дополнительные сведения о публикации приложений в Power BI см. в разделе [Публикация приложения](https://docs.microsoft.com/power-bi/service-create-distribute-apps#publish-your-app).

### <a name="after-publishing-the-dashboard"></a>Действия после публикации панели мониторинга

Сведения о просмотре опубликованной панели мониторинга Power BI см. в разделе [Просмотр панели мониторинга Power BI](configure-data-reporting.md#view-power-bi-dashboard).

## <a name="issues-and-feedback"></a>Проблемы и отзывы

- Чтобы сообщить о проблемах с примером приложения для службы экстренной медицинской помощи, перейдите по адресу <https://aka.ms/emergency-response-issues>.

- Чтобы оставить отзыв о примере приложения для службы экстренной медицинской помощи, перейдите по адресу <https://aka.ms/emergency-response-feedback>.

## <a name="next-step"></a>Следующий шаг

[Использование приложения для службы экстренной медицинской помощи](use.md)

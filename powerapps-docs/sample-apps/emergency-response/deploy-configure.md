---
title: Развертывание и настройка приложения для реагирования на чрезвычайные ситуации | Документация Майкрософт
description: Статья содержит подробные инструкции для ИТ-администраторов больниц по развертыванию и настройке примера приложения в организации.
author: KumarVivek
manager: annbe
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 03/26/2020
ms.author: kvivek
ms.reviewer: kvivek
searchScope:
- GetStarted
- PowerApps
ms.openlocfilehash: e58b23503e1730c8606a833cb05f7253b5b96f49
ms.sourcegitcommit: 77e00640a59a7db9d67d3ac52f74d264cbe3a494
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "80327703"
---
# <a name="deploy-and-configure-the-emergency-response-app"></a>Развертывание и настройка приложения для реагирования на чрезвычайные ситуации

Приложению для реагирования на чрезвычайные ситуации требуется небольшое количество настроек для адаптации к вашим потребностям. Статья содержит пошаговые инструкции для ИТ-администраторов больниц по развертыванию и настройке примера приложения в организации.

Предполагаемое время выполнения этой процедуры: **35–40 минут**.

## <a name="demo-deploy-and-configure-the-emergency-response-app"></a>Демонстрация. Развертывание и настройка приложения для реагирования на чрезвычайные ситуации

Смотрите, как можно развернуть и настроить приложение для реагирования на чрезвычайные ситуации.

<br/>

> [!VIDEO https://www.youtube.com/embed/-1g44wNiuWI]


## <a name="deploy-the-emergency-response-app"></a>Развертывание приложения для реагирования на чрезвычайные ситуации

Чтобы развернуть пример приложения для реагирования на чрезвычайные ситуации в организации, выполните следующие шаги:

- [Шаг 1. Регистрация в Power Apps и создание среды](#step-1-sign-up-for-power-apps-and-create-an-environment)
- [Шаг 2. Скачивание и развертывание пакета](#step-2-download-the-deployment-package)
- [Шаг 3. Импорт файла решения в среду](#step-3-import-the-solution-file-into-your-environment)
- [Шаг 4. Загрузка конфигурации и основных данных организации](#step-4-load-configuration-and-master-data-for-your-organization)
    - [Шаг 4.1. Как загружать данные из файлов данных](#step-41-how-to-load-data-from-data-files)
    - [Шаг 4.2. Импорт обязательных данных конфигурации](#step-42-import-mandatory-configuration-data)
- [Шаг 5. Обновление фирменной символики мобильного приложения](#step-5-update-the-mobile-app-branding)
- [Шаг 6. Обход согласия для мобильных приложений](#step-6-bypass-consent-for-mobile-apps)
- [Шаг 7. Добавление ключа Azure Application Insights в мобильные приложения для телеметрии](#step-7-add-azure-application-insights-key-to-mobile-apps-for-telemetry)
- [Шаг 8. Предоставление общего доступа к приложениям холста пользователям в организации](#step-8-share-canvas-apps-with-users-in-your-organization)
- [Шаг 9. Настройка мобильного приложения в качестве главного и рекомендуемого приложения](#step-9-set-your-mobile-app-as-hero-and-featured-app)
- [Шаг 10. Совместное использование приложения на основе модели с администраторами в организации](#step-10-share-model-driven-app-with-admins-in-your-organization)

### <a name="step-1-sign-up-for-power-apps-and-create-an-environment"></a>Шаг 1. Регистрация в Power Apps и создание среды

Если у вас еще нет Power Apps, зарегистрируйтесь в этой службе и приобретите соответствующую лицензию.

Дополнительные сведения:

-   [Цены на приложения Power Apps](https://powerapps.microsoft.com/pricing/).
-   [Покупка Power Apps для вашей организации](https://docs.microsoft.com/power-platform/admin/signup-for-powerapps-admin).

После приобретения Power Apps создайте среду с базой данных Common Data Service.

1.  Войдите в [Центр администрирования Power Platform](https://aka.ms/ppac).

2.  Создайте среду Common Data Service с базой данных. Дополнительные сведения: [Создание сред и управление ими в Центре администрирования Power Platform](https://docs.microsoft.com/power-platform/admin/create-environment).

3.  Создайте соответствующих пользователей в среде. Дополнительные сведения: [Создание пользователей и назначение ролей безопасности](https://docs.microsoft.com/power-platform/admin/create-users-assign-online-security-roles).

### <a name="step-2-download-the-deployment-package"></a>Шаг 2. Скачивание и развертывание пакета

Получите последний пакет развертывания (ZIP-файл) по адресу <https://aka.ms/emergency-response-solution>. Этот пакет содержит файл решения, образы и данные для настройки приложений и бизнес-логики для приложения для реагирования на чрезвычайные ситуации.

Чтобы начать развертывание, извлеките файл развертывания (ZIP-файл) в расположение на компьютере. Извлеченная папка будет содержать следующие папки:

| **Папка или файл**       | **Описание**  |
|-----------------------|------------------|
| **App Icons** (Значки приложений)         | Содержит значки приложений по умолчанию для мобильных приложений (приложения холста).|
| **Data Files** (Файлы данных)        | Содержит основные файлы и файлы образцов данных (XLSX) для работы решения или приложения. Вы можете импортировать данные из этих файлов, чтобы начать работу с приложением. Дополнительные сведения см. в разделе [Шаг 4. Загрузка конфигурации и основных данных организации](#step-4-load-configuration-and-master-data-for-your-organization). |
| **Шаблон Power BI** | Содержит файл шаблона отчета Power BI (PBIT-файл), который будет использоваться для настройки отчетов в вашей организации. Дополнительные сведения: [Получение аналитических сведений с помощью панелей мониторинга Power BI](#get-insights-using-power-bi-dashboards)|
| **PowerShell**        | Содержит сценарии, которые вы будете использовать для настройки своих мобильных приложений (приложения холста). |
| **Solution File** (Файл решения)     | Содержит файл решения Common Data Service, который создает приложения и метаданные, необходимые приложению для реагирования на чрезвычайные ситуации.  |

### <a name="step-3-import-the-solution-file-into-your-environment"></a>Шаг 3. Импорт файла решения в среду

1.  Перейдите в папку, в которую извлечен файл развертывания (ZIP-файл). Вы найдете папку **Solution File** (Файл решения). Импортируйте файл управляемого решения (ZIP-файл) в папку **Solution File** (Файл решения) в нашу среду.

2.  Выполните вход в [Power Apps](https://make.powerapps.com).

3.  Выберите среду в правом верхнем углу.

4.  В левой области выберите **Solutions** (Решения), а затем щелкните **Импорт**.

    > [!div class="mx-imgBorder"] 
    > ![Импорт решения](media/conf-import-solution.png "Импорт решения")

5.  В диалоговом окне **Import Solution** (Импорт решения) выберите файл решения, упомянутый на шаге 1, и следуйте указаниям мастера, чтобы импортировать решение.

6.  После успешного импорта решения щелкните **Закрыть** в диалоговом окне импорта, а затем нажмите кнопку **Public all customizations** (Опубликовать все настройки). Это может занять некоторое время.

Теперь вы увидите новые приложения в разделе **Приложения**:

> [!div class="mx-imgBorder"] 
> ![Новые приложения](media/conf-apps-new-apps.png "Новые приложения")

Выберите **Admin App** (Приложение администрирования), чтобы открыть приложение на основе модели, позволяющее настроить остальные параметры развертывания. Дополнительные сведения: [Основные сведения о приложениях на основе модели](https://docs.microsoft.com/powerapps/maker/model-driven-apps/model-driven-app-overview)

> [!div class="mx-imgBorder"] 
> ![Открытие приложения администрирования](media/conf-admin-app-open.png "Открытие приложения администратора")

В приложении администрирования есть несколько сущностей, с помощью которых можно добавлять данные в систему больницы и управлять ими. Чтобы выбрать другую область, можно использовать средство выбора области в нижней части левой панели навигации.

### <a name="step-4-load-configuration-and-master-data-for-your-organization"></a>Шаг 4. Загрузка конфигурации и основных данных организации

Все данные, необходимые для приложения для реагирования на чрезвычайные ситуации, доступны в папке **Data Files** (Файлы данных) в извлеченной папке развертывания.

Папка **Data Files** (Файлы данных) содержит следующие файлы и папки:

<table style="width:100%">
<tr>
<th>Имя</th>
<th>Описание</th>
</tr>
<tr>
<td>В корневой папке доступны следующие файлы:
<ul>
<li>00 - Acuities Import.xlsx</li>
<li>00 - App Config Import.xlsx</li>
<li>00 - App Import.xlsx</li>
<li>00 - Request Roles Import.xlsx</li>
<li>00 - Supplies Import.xlsx</li>
</ul>
</td>
<td>Это файлы данных конфигурации, которые необходимо импортировать в следующие сущности с помощью приложения администрирования:
<ul>
<li>Acuities (Неотложность медицинской помощи)</li>
<li>App Config (Конфигурация приложения)</li>
<li>Приложения</li>
<li>Request Roles (Запрошенные роли)</li>
<li>Supplies Import (Импорт запасов)</li>
</ul>
<br/>При импорте данных в эти сущности будут созданы записи для этих сущностей, которые необходимы для работы приложения для реагирования на чрезвычайные ситуации.
<br/>
<br/>
<strong>Внимание</strong>! Убедитесь, что значения конфигурации в этих сущностях, за исключением <strong>Apps</strong> (Приложения) и <strong>App Config</strong> (Конфигурация приложений), не будут обновляться. Необходимость в этом описана ниже.</td>
</tr>
<tr>
<td>Папка <strong>Sample Data</strong> (Примеры данных)</td>
<td><p>В этой папке содержатся образцы файлов данных (XLSX-файлы), которые можно импортировать для заполнения примера данных в приложении. Имена присваиваются файлам согласно последовательности, в которой данные должны быть импортированы в приложение. </p>
<p>Необходимо импортировать данные для следующих сущностей, содержащих образец данных приложения для реагирования на чрезвычайные ситуации:
<ul>
<li>Systems (Системы)</li>
<li>области</li>
<li>Facilities (Учреждения)</li>
<li>Расположения</li>
<li>Подразделения</li>
</ul>
<p>Если вы хотите импортировать данные организации вместо примеров данных, можно заменить примеры в этих файлах Excel данными организации, а затем импортировать данные в приложение.</p>
<p>Можно также вручную ввести данные для этих сущностей. Сведения о каждой из этих сущностей и их полей см. в разделе <a href="#manually-configure-and-manage-master-data-for-your-organization">Настройка основных данных в организации вручную и управление ими</a>.</p></td>
</tr>
<tr>
<td>Папка <strong>Data Template File for Master Data</strong> (Файл примеров данных для основных данных)</td>
<td><p>Папка содержит пустые файлы данных (XLSX-файлы) для основных сущностей, которые можно использовать для заполнения данных организации, а затем импортировать их в приложение.</p>
<p>Имена присваиваются файлам согласно последовательности, в которой данные должны быть импортированы в приложение. Это тот же список сущностей, который упоминается ранее для папки <strong>Sample Data</strong> (Примеры данных).</p>
<p>Можно также вручную ввести данные для этих сущностей. Сведения о каждой из этих сущностей и их полей см. в разделе <a href="#manually-configure-and-manage-master-data-for-your-organization">Настройка основных данных в организации вручную и управление ими</a>.</p>
</td>
</tr>
</table>

#### <a name="step-41-how-to-load-data-from-data-files"></a>Шаг 4.1. Как загружать данные из файлов данных

Чтобы загрузить образец данных из одного из файлов данных в сущность, выполните следующие действия:

1.  В области навигации слева в приложении администрирования выберите сущность, для которой требуется загрузить данные. Например, щелкните **Locations** (Местоположения) в средстве выбора области, а затем выберите **Systems** (Системы).

2.  Щелкните **Импорт из Excel** и выберите файл **01-Load Systems.xlsx** в папке **Sample Data** (Примеры данных).

    > [!div class="mx-imgBorder"] 
    > ![Импорт данных из Excel](media/conf-import-from-excel.png "Импорт данных из Excel")

3.  Перейдите к шагам мастера импорта, чтобы импортировать данные.

4.  После импорта примера данных вы увидите импортированную запись в сущности:

    > [!div class="mx-imgBorder"] 
    > ![Запись сущности](media/conf-entity-record.png "Запись в сущности после импорта")

Повторите описанные выше действия с другими сущностями.

Сведения о том, как вручную ввести основные данные, см. в разделе [Настройка основных данных в организации вручную и управление ими](#manually-configure-and-manage-master-data-for-your-organization).

#### <a name="step-42-import-mandatory-configuration-data"></a>Шаг 4.2. Импорт обязательных данных конфигурации

Импорт данных конфигурации под следующими сущностями в приложении администратора является **обязательным** перед переходом к следующему шагу:

| Имя области | Имя сущности| Имя файла
|-|-|-
| Расположения | Acuities (Неотложность медицинской помощи) | 00 - Acuities Import.xlsx
| Администрирование | App Config (Конфигурация приложений) | 00 - App Config Import.xlsx
| Администрирование | Приложения | 00 - App Import.xlsx
| Staffing (Персонал) | Request Roles (Запрошенные роли) | 00 - Request Roles Import.xlsx
| Расположения | Supplies (Снабжение) | 00 - Supplies Import.xlsx

Данные для других сущностей можно позже добавить [вручную](#manually-configure-and-manage-master-data-for-your-organization) или с использованием примеров файлов данных, описанных выше.

### <a name="step-5-update-the-mobile-app-branding"></a>Шаг 5. Обновление фирменной символики мобильного приложения

Можно изменить значок или цветовую схему мобильных приложений в соответствии с фирменной символикой вашей организации.

Это делается с помощью сущностей **Apps** (Приложения) и **App Config** (Конфигурация приложений) в области **Администрирование** путем импорта данных приложения и его конфигурации из файла Excel, доступного в папке **Data Files** (Файлы данных) в пакете развертывания, как описано в предыдущем шаге.

> [!div class="mx-imgBorder"] 
> ![Сущности Apps (Приложения) и App Config (Конфигурация приложений)](media/conf-app-app-config-entities.png "Сущности Apps (Приложения) и App Config (Конфигурация приложений)")

1.  Убедитесь, что вы импортировали данные конфигурации для сущностей **Apps** (Приложения) и **App Config** (Конфигурация приложений) из файлов **App Import.xlsx** и **App Config Import.xlsx** соответственно в извлеченном пакете развертывания.

1.  Теперь скопируйте идентификаторы для приложений холста, чтобы ими можно было заполнить значения в импортированных записях сущности **Apps** (Приложения). Выполните вход в [Power Apps](https://make.powerapps.com).

1.  Выберите среду в правом верхнем углу.

1.  В области слева щелкните **Apps** (Приложения), нажмите меню-многоточие (...), чтобы открыть приложения холста, а затем выберите пункт **Сведения**.

    > [!div class="mx-imgBorder"] 
    > ![Сведения о приложениях](media/conf-environments-apps-details.png "Сведения о приложении")

1.  Идентификатор отобразится внизу в области  **Сведения**  этого приложения. Скопируйте идентификатор приложения вместе с его именем в файл Блокнота.

    > [!div class="mx-imgBorder"] 
    > ![Сведения об идентификаторе приложения](media/conf-details-app-id.png "Сведения об идентификаторе приложения")

1.  Повторите шаги 3 и 4 для каждого приложения холста.

1.  Откройте приложение администрирования и в левой области навигации выберите **Администрирование** в средстве выбора области, а затем **Apps** (Приложения). Будут показаны все записи приложений холста, импортированные из файла **App Import.xlsx**.

    > [!div class="mx-imgBorder"] 
    > ![Приложения администрирования](media/conf-admin-app-records.png "Приложения администрирования")

1.  Выберите и откройте одну из записей приложений. Обратите внимание, что поле Power App ID (Идентификатор Power App) является пустым.

    > [!div class="mx-imgBorder"] 
    > ![Поле идентификатора Power App](media/conf-powerapp-id-field.png "Поле идентификатора Power App")

1.  Скопируйте из файла Блокнота идентификатор приложения, скопированный ранее на шагах 2–6, в поле **Power App ID** (Идентификатор Power App). Можно также обновить значок приложения, дважды щелкнув его и указав другое изображение. Сохраните запись.

1.  Повторите шаг 9 для каждой записи приложения холста в разделе **Apps** (Приложения), чтобы добавить значение **Power App ID** (Идентификатор Power App).

1.  В левой области щелкните сущность **App Config** (Конфигурация приложений).

1.  Выберите запись **Приложение для реагирования на чрезвычайные ситуации** , чтобы открыть ее для редактирования.

    1.  Дважды щелкните значок, чтобы указать новое изображение в качестве значка приложения.

    2.  Обновите имена и цвета для приложения.

    3.  Выберите значение **Да** или **Нет** в поле **Device Sharing Enabled** (Включение общего доступа к устройствам), чтобы указать, будет ли доступен параметр **Выход** в мобильных приложениях. При выборе варианта **Да** будет доступен **Выход**.

    > [!div class="mx-imgBorder"] 
    > ![Поле Device Sharing Enabled (Включение общего доступа к устройствам)](media/conf-device-sharing-enabled-field.png "Поле Device Sharing Enabled (Включение общего доступа к устройствам)")

1.  Нажмите кнопку **Сохранить** в правом нижнем углу, чтобы сохранить изменения.

### <a name="step-6-bypass-consent-for-mobile-apps"></a>Шаг 6. Обход согласия для мобильных приложений

Для выполнения этого шага необходимо быть администратором клиента. Кроме того, для выполнения этого шага требуется идентификатор для каждого мобильного приложения (приложения холста).

Чтобы получить идентификатор для приложения, в приложении администрирования выберите **Администрирование** в средстве выбора области, а затем щелкните **Apps** (Приложения). Отобразятся все мобильные приложения (приложения холста). Выберите мобильное приложение, чтобы просмотреть его идентификатор. Скопируйте идентификатор приложения для каждого приложения в файл Блокнота.

> [!div class="mx-imgBorder"] 
> ![Получение идентификатора приложения](media/conf-admin-get-app-id.png "Получение идентификатора приложения")

Затем выполните описанные ниже действия.

1.  Откройте Блокнот и скопируйте этот сценарий PowerShell:

    ```powershell
    # MUST BE A TENANT ADMIN TO RUN THIS
    Install-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Install-Module -Name Microsoft.PowerApps.PowerShell -AllowClobber
    Import-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Import-Module -Name Microsoft.PowerApps.PowerShell
    
    # This call opens prompt to collect credentials 
    # (Azure Active Directory account and password) 
    # used by the commands
    Add-PowerAppsAccount
    
    # Change the App ID for each new app (APPGUIDHERE)
    Set-AdminPowerAppApisToBypassConsent -AppName APPGUIDHERE
    ```

2.  Замените значение `APPGUIDHERE` в каждой строке фактическим идентификатором приложения холста.

3.  Сохраните файл в формате PS.

4.  Запустите PowerShell от имени администратора и выполните только что созданный PS-файл.

5.  Повторите шаги 2 и 4 для каждого приложения холста.

### <a name="step-7-add-azure-application-insights-key-to-mobile-apps-for-telemetry"></a>Шаг 7. Добавление ключа Azure Application Insights в мобильные приложения для телеметрии

Вы можете использовать Application Insights Azure для сбора подробных данных телеметрии для мобильных приложений (холста), чтобы получить сведения об использовании приложения. Подробные сведения об этом см. в статье [Анализ телеметрии приложения с помощью Azure Application Insights](https://powerapps.microsoft.com/blog/log-telemetry-for-your-apps-using-azure-application-insights/).

### <a name="step-8-share-canvas-apps-with-users-in-your-organization"></a>Шаг 8. Предоставление общего доступа к приложениям холста пользователям в организации

Чтобы пользователи использовали данные с помощью приложений холста на своих мобильных устройствах, пользователям необходимо предоставить к ним общий доступ. Для простого предоставления доступа группам пользователей к приложениям можно использовать группы Azure AD.

1.  Войдите в [Power Apps](https://make.powerapps.com).

2.  В области навигации слева выберите сущность **Apps** (Приложения), чтобы просмотреть список всех приложений.

3.  Выберите мобильное приложение (приложение холста) и нажмите кнопку **Share** (Общий доступ) на баннере.

    > [!div class="mx-imgBorder"] 
    > ![Предоставление общего доступа к приложениям холста](media/conf-share-canvas-apps.png "Предоставление общего доступа к приложениям холста")

4.  Укажите группу или пользователей Azure AD, которым необходимо предоставить доступ к этому приложению. Так как приложение подключается к данным Common Data Service, необходимо также предоставить разрешения для сущностей. На панели общего доступа отобразится запрос управления безопасностью для сущностей. Назначьте роли безопасности **COVID 19 End User** (Пользователь COVID 19) и **Common Data Service User** (Пользователь Common Data Service) для сущностей, используемых этим приложением, и щелкните **Share** (Общий доступ).

    > [!div class="mx-imgBorder"] 
    > ![Предоставление общего доступа к приложению группе или пользователям Azure AD](media/conf-share-app-groups-users.png "Предоставление общего доступа к приложению группе или пользователям Azure AD")

5.  Повторите шаги 3 и 4 для каждого мобильного приложения.

Подробные сведения о предоставлении общего доступа к приложениям см. [здесь](https://docs.microsoft.com/powerapps/maker/canvas-apps/share-app).

### <a name="step-9-set-your-mobile-app-as-hero-and-featured-app"></a>Шаг 9. Настройка мобильного приложения в качестве главного и рекомендуемого приложения

На этом шаге вы сможете сделать мобильное приложение главным и рекомендуемым в мобильном приложении **Power Apps**. Для выполнения этого шага необходимо быть администратором клиента.

Для выполнения этого шага требуется идентификатор для каждого мобильного приложения (приложения холста), которое вы хотите задать в качестве главного и рекомендуемого приложения. Сведения о получении идентификатора приложения холста см. в разделе [Шаг 6. Обход согласия для мобильных приложений](#step-6-bypass-consent-for-mobile-apps).

Затем выполните описанные ниже действия.

1.  Откройте Блокнот и скопируйте этот сценарий PowerShell:


    ```powershell
    # MUST BE A TENANT ADMIN TO RUN THIS
    Install-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Install-Module -Name Microsoft.PowerApps.PowerShell -AllowClobber
    Import-Module -Name Microsoft.PowerApps.Administration.PowerShell
    Import-Module -Name Microsoft.PowerApps.PowerShell

    # This call opens prompt to collect credentials 
    # (Azure Active Directory account and password) 
    # used by the commands
    Add-PowerAppsAccount

    # Use the "Emergency Response App" App ID
    # To clear a featured app use Clear-AdminPowerAppAsFeatured

    #Change the App ID for each new app (APPGUIDHERE)
    Set-AdminPowerAppAsFeatured -AppName APPGUIDHERE

    # To clear a hero app use Clear-AdminPowerAppAsHero
    # Change the App ID for each new app (APPGUIDHERE)
    Set-AdminPowerAppAsHero -AppName APPGUIDHERE
    ```

2.  Замените значение `APPGUIDHERE` в каждой строке фактическим идентификатором приложения, которое вы хотите задать в качестве главного и рекомендуемого приложения.

3.  Сохраните файл в формате PS.

4.  Запустите PowerShell от имени администратора и выполните только что созданный PS-файл.

### <a name="step-10-share-model-driven-app-with-admins-in-your-organization"></a>Шаг 10. Совместное использование приложения на основе модели с администраторами в организации

Чтобы пользователи с правами администратора могли использовать приложение администрирования (на основе модели), им необходимо предоставить общий доступ к этому приложению. Для простого предоставления доступа группе администраторов к приложениям можно использовать группы Azure AD.

1. Выполните вход в [Power Apps](https://make.powerapps.com).

2. В области навигации слева выберите сущность Apps (Приложения), чтобы просмотреть список всех приложений.

3. Выберите приложение на основе модели (**Admin App – Emergency Response App** (Приложение администрирования — приложение для реагирования на чрезвычайные ситуации)) и нажмите кнопку **Share** (Общий доступ) на баннере.

4. Укажите группу или администраторов Azure AD, которым необходимо предоставить общий доступ к этому приложению, назначьте роль **Emergency Response Admin** (Администратор приложения для реагирования на чрезвычайные ситуации) и щелкните **Share** (Общий доступ).


## <a name="manually-configure-and-manage-master-data-for-your-organization"></a>Настройка основных данных в организации вручную и управление ими

Администраторы могут использовать приложение на основе модели в [Power Apps](https://make.powerapps.com) для создания основных данных и управления ими в организации. Эти данные необходимы для работы приложения для реагирования на чрезвычайные ситуации.

> [!NOTE]
> Вы также можете импортировать данные организации в файлы данных, доступные в пакете развертывания, а затем импортировать их в эти сущности. Дополнительные сведения: [Шаг 4. Загрузка конфигурации и основных данных организации](#step-4-load-configuration-and-master-data-for-your-organization).

Необходимо добавить основные данные в эти сущности в следующей последовательности:

1. [Systems](#systems-data) (Системы)

1. [Регионы](#regions-data)

1. [Facilities](#facilities-data) (Учреждения)

1. [Расположения](#locations-data)

1. [Departments](#departments-data) (Подразделения)

Управление основными данными осуществляется из области **Locations** (Местоположения) в левой панели навигации в приложении администрирования.

> [!div class="mx-imgBorder"]
> ![locations-area](media/locations-area.png)

Сущности в разделе **Иерархия** перечислены в том порядке, в котором следует заполнять данные.

### <a name="systems-data"></a>Системные данные

Сущность **Systems** (Системы) позволяет создавать записи для больничных систем и управлять ими. Это позволяет управлять несколькими больничными системами в одной организации.

Чтобы создать запись, выполните следующие действия:

1. В левой области выберите сущность **Systems** (Системы) и нажмите кнопку **Создать**:  
    > [!div class="mx-imgBorder"]
    > ![select-systems-new](media/select-systems-new.png)

2. На странице **New System** (Новая система) укажите соответствующие значения.  
   > [!div class="mx-imgBorder"]
   > ![enter-details-new-system](media/enter-details-new-system.png)

   | **Поле**            | **Описание**                                    |
   |----------------------|----------------------------------------------------|
   | Имя системы          | Введите название вашей больницы.                     |
   | Описание          | Введите дополнительное описание.                      |
   | Effective Start Data (Дата начала действия) | Введите дату и время начала действия для этой системы больницы. |
   | Effective End Date (Дата завершения действия)   | Введите дату и время завершения действия для этой системы больницы.   |

3. Выберите **Сохранить и закрыть**. Созданная запись будет доступна в списке **Systems** (Системы).

Чтобы изменить запись, выберите запись, обновите значения по мере необходимости и выберите **Save & Close** (Сохранить и закрыть).

### <a name="regions-data"></a>Данные регионов

Сущность **Regions** (Регионы) позволяет управлять географическими регионами для систем больниц.

Чтобы создать запись, выполните следующие действия:

1. В левой области выберите сущность **Regions** (Регионы) и нажмите кнопку **Создать**:

2. На странице **Новый регион** укажите соответствующие значения.  

    > [!div class="mx-imgBorder"]
    > ![enter-details-new-region](media/enter-details-new-region.png)

    | **Поле**            | **Описание**                                                                                          |
    |----------------------|----------------------------------------------------------------------------------------------------------|
    | Система               | Выберите систему больницы. Этот список заполняется на основе данных в разделе **Systems** (Системы), созданных ранее. |
    | Имя региона          | Введите имя региона. Например, Сиэтл.                                                              |
    | Описание          | Введите дополнительное описание.                                                                            |
    | Effective Start Data (Дата начала действия) | Введите дату и время начала действия для этой системы больницы.                                                       |
    | Effective End Date (Дата завершения действия)   | Введите дату и время завершения действия для этой системы больницы.                                                         |

3. Выберите **Сохранить и закрыть**. Созданная запись будет доступна в списке **Regions** (Регионы).

Чтобы изменить запись, выберите запись, обновите значения по мере необходимости и выберите **Save & Close** (Сохранить и закрыть).

### <a name="facilities-data"></a>Данные учреждений

Сущность **Facilities** (Учреждения) позволяет управлять местоположениями больницы в каждом регионе. Например, **Редмонд** и **Белвью** в регионе **Сиэтл**.

Чтобы создать запись, выполните следующие действия:

1. В левой области выберите **Facilities** (Учреждения) и нажмите кнопку **Создать**:

2. На странице **New Facility** (Новое учреждение) укажите соответствующие значения. 

    > [!div class="mx-imgBorder"] 
    > ![enter-details-new-facility](media/enter-details-new-facility.png)

    | **Поле**            | **Описание**                                                                                 |
    |----------------------|-------------------------------------------------------------------------------------------------|
    | Регион               | Выберите регион. Этот список заполняется на основе данных в разделе **Regions** (Регионы), созданных ранее. |
    | Facility Name (Название учреждения)        | Введите название учреждения. Например, Белвью.                                                  |
    | Описание          | Введите дополнительное описание.                                                                   |
    | Total Vents (Всего аппаратов ИВЛ)          | Введите общее число аппаратов ИВЛ, доступных в учреждении.                                  |
    | Effective Start Data (Дата начала действия) | Введите дату и время начала для этого учреждения.                                                     |
    | Effective End Date (Дата завершения действия)   | Задайте дату и время окончания действия для этого учреждения.                                                       |

    При необходимости введите адрес учреждения.

3. Выберите **Сохранить и закрыть**. Созданная запись будет доступна в списке **Total Vents** (Учреждения).

Чтобы изменить запись, выберите запись, обновите значения по мере необходимости и выберите **Save & Close** (Сохранить и закрыть).

### <a name="locations-data"></a>Данные о местоположениях

Сущность **Locations** (Местоположения) позволяет управлять конкретными расположениями в рамках каждой больницы.

> [!NOTE]
> Прежде чем создавать записи сущности **Locations** (Местоположения), убедитесь, что вы импортировали данные о неотложности медицинской помощи с помощью файла **00 - Acuities Import.xlsx**, как описано выше в разделе [Шаг 4. Загрузка конфигурации и основных данных в организации](#step-4-load-configuration-and-master-data-for-your-organization). Это обусловлено тем, что для создания записи сущности **Locations** (Местоположения) требуются сведения о неотложности медицинской помощи.

Чтобы создать запись, выполните следующие действия:

1. В левой области выберите сущность **Locations** (Местоположения) и нажмите кнопку **Создать**:

2. На странице **New Location** (Новое местоположение) укажите соответствующие значения.  
 
    > [!div class="mx-imgBorder"]
    > ![enter-details-new-location](media/enter-details-new-location.png)

    | **Поле**            | **Описание**                                                                                      |
    |----------------------|------------------------------------------------------------------------------------------------------|
    | Имя расположения        | Введите имя местоположения.                                                                       |
    | Facility             | Выберите учреждение. Этот список заполняется на основе данных в сущности **Facilities** (Учреждения), созданных ранее. |
    | Этаж                | Введите сведения об этаже в учреждении.                                                         |
    | Единица                 | Введите сведения об отделении учреждения.                                                           |
    | Location Acuity (Неотложность медицинской помощи в местоположении)      | Выберите степень неотложности медицинской помощи, связанную с этим местоположением.                                                                                                     |
    | Total Beds (Всего коек)           | Введите общее число коек в учреждении.                                                       |
    | Blocked beds (Занятые койки в учреждении)         | Введите число занятых коек в учреждении.                                                     |
    | Last Census (Последняя перепись)          | Заполняется на основе последней создаваемой переписи.                                             |
    | Occupancy Percentage (Процент занятости) | Автоматически рассчитывается на основе последних переписей и общего количества коек.                                         |
    | Effective Start Data (Дата начала действия) | Введите дату и время начала действия для этой системы больницы.                                                   |
    | Effective End Date (Дата завершения действия)   | Введите дату и время завершения действия для этой системы больницы.                                                     |
    | Location Order (Порядок местоположений)       | Введите число для сортировки расположений в раскрывающихся списках местоположений.                               |
    | Alternate Site Flag (Альтернативный флаг сайта)  | Для внутреннего использования.                                                                                     |

3. Выберите **Сохранить и закрыть**. Созданная запись будет доступна в списке **Locations** (Местоположения).

Чтобы изменить запись, выберите запись, обновите значения по мере необходимости и выберите **Save & Close** (Сохранить и закрыть).

### <a name="departments-data"></a>Данные подразделений

Сущность **Departments** (Подразделения) позволяет управлять сведениями о подразделениях в больнице.

Чтобы создать запись, выполните следующие действия:

1. В области слева выберите сущность **Departments** (Подразделения) и нажмите кнопку **Создать**:

2. На странице **New Department** (Новое подразделение) укажите соответствующие значения.    

    > [!div class="mx-imgBorder"]
    > ![enter-details-new-department](media/enter-details-new-department.png)

    | **Поле**            | **Описание**                                    |
    |----------------------|----------------------------------------------------|
    | Название отдела      | Введите название подразделения.                            |
    | Описание          | Введите дополнительное описание.                      |
    | Effective Start Data (Дата начала действия) | Введите дату и время начала действия для этой системы больницы. |
    | Effective End Date (Дата завершения действия)   | Введите дату и время завершения действия для этой системы больницы.   |

3. Выберите **Сохранить и закрыть**. Созданная запись будет доступна в списке **Departments** (Подразделения).

Чтобы изменить запись, выберите запись, обновите значения по мере необходимости и выберите **Save & Close** (Сохранить и закрыть).

## <a name="get-insights-using-common-data-service-dashboards"></a>Получение аналитических сведений с помощью панелей мониторинга Common Data Service

Следующие панели мониторинга доступны по умолчанию в приложении администрирования реагирования на чрезвычайные ситуации (на основе модели):

- **Bed Management** (Управление койками)

   Показывает наличие коек, процент занятости и общее число коек в разных учреждениях.

- **Equipment and Supply** (Оборудование и поставки)

  Показывает, какое оборудование и запасы сейчас доступны в различных учреждениях.

- **Staff Management** (Управление персоналом)

  Показывает число запрошенных, назначенных и доступных сотрудников в разных учреждениях.

- **COVID Patients** (Пациенты, зараженные COVID)

  Показывает количество пациентов в процессе обследования и фактически зараженных COVID-19 в различных учреждениях.

- **Discharges** (Выписки)

  Показывает число пациентов, ожидающих выписку, и уже выписанных.

Кроме того, можно создавать собственные панели мониторинга в дополнение к доступным по умолчанию.

### <a name="manage-dashboards"></a>Управление панелями мониторинга

Для управления панелями мониторинга необходимо сделать следующее:

1. Войдите в [Power Apps](https://make.powerapps.com) и перейдите к своему приложению администрирования.

2. В области навигации слева щелкните **Панели мониторинга** в средстве выбора области:

    > [!div class="mx-imgBorder"]
    > ![select-dashboards](media/select-dashboards.png)

3. Выберите имя панели мониторинга в области навигации слева, чтобы просмотреть диаграммы:

    > [!div class="mx-imgBorder"]
    > ![view-charts](media/view-charts.png)

    > [!NOTE]
    > Вы можете фильтровать данные в нижней части экрана, а диаграммы сверху автоматически будут обновляться отфильтрованными значениями.

4. Щелкните значок **развертывания**, чтобы просмотреть диаграмму в полноэкранном режиме:

    > [!div class="mx-imgBorder"]
    > ![select-expand](media/select-expand.png)

### <a name="additional-analysis"></a>Дополнительный анализ

- **Детализация**. Для сущности можно выбрать область диаграммы и детализировать ее с углублением, используя дополнительные атрибуты (поля):

    > [!div class="mx-imgBorder"]
    > ![select-chart-area-drill-down](media/select-chart-area-drill-down.png)

- **Обновить**. Вы можете обновить панели мониторинга, чтобы на них отображались обновленные данные. Вы можете обновить все диаграммы на определенной панели мониторинга с помощью кнопки **Refresh All** (Обновить все) или обновить выбранную диаграмму с помощью команды **Обновить**:

    > [!div class="mx-imgBorder"]
    > ![refresh-dashboards](media/refresh-dashboards.png)

- **Просмотр записей**. Щелкните меню **Больше команд** ( **...** ), а затем команду **Просмотр записей**, чтобы просмотреть все записи, связанные с этой диаграммой:

    > [!div class="mx-imgBorder"]
    > ![select-more-commands](media/select-more-commands.png)

    > [!NOTE] 
    > При выборе команды **Просмотр записей** вы увидите представление сущности с разделением на диаграмму и записи. Любое изменение фильтров для записей в правой части экрана влечет автоматическое обновление диаграммы в левой части экрана.

Дополнительные сведения о редактировании существующей панели мониторинга и обновлении свойств диаграмм см. в разделе [Изменение существующей панели мониторинга](https://docs.microsoft.com/powerapps/maker/model-driven-apps/create-edit-dashboards#edit-an-existing-dashboard).

### <a name="create-new-dashboards"></a>Создание новых панелей мониторинга

Можно также создавать собственные панели мониторинга и настраивать их в соответствии с потребностями. Чтобы создать панель мониторинга, нажмите кнопку **Создать**, а затем выберите пункт **Панель мониторинга Dynamics 365**:

> [!div class="mx-imgBorder"]
> ![select-new-dynamics-dashboard](media/select-new-dynamics-dashboard.png)

Дополнительные сведения о создании панели мониторинга см. в разделе [Создать новую панель мониторинга](https://docs.microsoft.com/powerapps/maker/model-driven-apps/create-edit-dashboards#create-a-new-dashboard).

## <a name="get-insights-using-power-bi-dashboards"></a>Получение аналитических сведений с помощью панелей мониторинга Power BI

Опубликуйте панель мониторинга Power BI и предоставьте к ней доступ пользователям в своей организации, чтобы они могли использовать эту панель для анализа и принятия решений.

### <a name="prerequisites"></a>Предварительные требования

- Лицензии "Емкость Power BI премиум-класса" и Power BI Pro, назначенные пользователям, получающим доступ к отчету. 

- Создайте рабочую область в Power BI, где будет опубликован отчет. Войдите в Power BI и создайте рабочую область. Дополнительные сведения: [Create the new workspaces in Power BI](https://docs.microsoft.com/power-bi/service-create-the-new-workspaces) (Создание рабочих областей новой версии в Power BI)

- Установите Power BI Desktop из магазина приложений Windows: <https://aka.ms/pbidesktop>

   > [!NOTE] 
   > Если вы установили Power BI, скачав решение напрямую с сайта Power BI в качестве исполняемого файла, удалите его и используйте из магазина приложений. Версия из магазина приложений будет обновляться автоматически при публикации новых выпусков.

- После установки Power BI Desktop из магазина приложений запустите решение, войдите с использованием учетной записи с разрешением на публикацию приложений Power BI в вашей организации.

### <a name="publish-the-power-bi-dashboard"></a>Публикация панели мониторинга Power BI

1. Перейдите в папку, в которую извлечен пакет развертывания. В папке **Шаблон Power BI** можно найти файл **App.pbit** для приложения для реагирования на чрезвычайные ситуации.

2. Откройте файл **App.pbit** приложения для реагирования на чрезвычайные ситуации в Power BI Desktop. Когда этот файл откроется в Power BI Desktop, откроется диалоговое окно **Обновить**, сообщающее, что обновление данных завершилось сбоем. Это вызвано тем, что мы еще не указали сведения о подключении к среде Common Data Service.

3. Щелкните меню **Преобразование данных**, чтобы указать подключение к среде Common Data Service.  
    
    > [!div class="mx-imgBorder"]
    > ![select-transform-data](media/select-transform-data.png)

4. В редакторе запросов обновите параметр **CDSBaseURL**, указав URL-адрес среды Common Data Service. Щелкните правой кнопкой мыши **CDSBaseURL**, выберите пункт **Расширенный редактор**, а затем укажите соответствующее значение.  

    > [!div class="mx-imgBorder"]
    > ![select-advanced-editor](media/select-advanced-editor.png)

5. Сохраните изменения. Появится сообщение с предложением применить ожидающие изменения к запросу. Нажмите кнопку **Применить**.

6. Вам будет предложено ввести учетные данные для подключения к среде Common Data Service. Выберите элементы **Учетная запись организации** > **Войти**, чтобы указать учетные данные Common Data Service.  

    > [!div class="mx-imgBorder"]
    > ![select-organizational-account](media/select-organizational-account.png)

7. Нажмите кнопку **Подключить**, чтобы установить подключение.

8. При успешном подключении вам будет предложено сохранить PBIX-файл вместе со сведениями о среде Common Data Service. Укажите имя и сохраните его на компьютере.

9. На вкладке **Главная** щелкните **Close & Apply** (Закрыть и применить).

10. Нажмите кнопку **Обновить**, чтобы обновить данные в среде Common Data Service. Нажмите кнопку **Опубликовать**, чтобы опубликовать данные в рабочей области Power BI.  
    
    > [!div class="mx-imgBorder"]
    > ![select-refresh-publish](media/select-refresh-publish.png)

11. На странице **Публикация в Power BI** выберите рабочую область, в которой необходимо выполнить публикацию.

12. Отчет станет доступен в вашей рабочей области. Теперь настроим обновление данных для набора данных. Выберите набор данных в рабочей области и щелкните значок **Запланировать обновление**.  
    
    > [!div class="mx-imgBorder"]
    > ![schedule-refresh](media/schedule-refresh.png)

13. На странице настройки набора данных разверните раздел **Учетные данные источников данных** и щелкните ссылку **Изменить учетные данные**, чтобы убедиться в правильности сведений о соединении для подключения к источнику данных.  

    > [!div class="mx-imgBorder"]
    > ![select-edit-credentials](media/select-edit-credentials.png)

14. Разверните раздел **Запланированное обновление** и укажите необходимые сведения для обновления данных по расписанию.

    > [!NOTE] 
    > Существуют ограничения на то, сколько раз данные могут обновляться. Для наборов данных в общей емкости Power BI допускает до восьми ежедневных обновлений. Если набор данных находится в емкости Premium, можно запланировать в параметрах набора данных до 48 обновлений в день. Дополнительные сведения: [Обновление данных](https://docs.microsoft.com/power-bi/refresh-data#data-refresh)

15. Выберите имя рабочей области в левой области, а затем нажмите кнопку **Создать приложение** в правом верхнем углу.  

    > [!div class="mx-imgBorder"]
    > ![select-create-app](media/select-create-app.png)

16. На странице публикации приложения выполните следующие действия.

    1. На вкладке **Setup** (Настройка) укажите имя и описание приложения.

    2. На вкладке **Навигация** укажите расположение панели мониторинга, в котором она будет опубликована.

    3. На вкладке **Разрешения** укажите пользователей или группу, которые смогут просматривать это приложение. Убедитесь, что установлен флажок **Install this app automatically** (Установить это приложение автоматически), чтобы автоматически устанавливать это приложение для пользователей. Дополнительные сведения: [Автоматическая установка приложений для конечных пользователей](https://docs.microsoft.com/power-bi/service-create-distribute-apps#automatically-install-apps-for-end-users)  

        > [!div class="mx-imgBorder"]
        > ![select-install-apps-automatically](media/select-install-apps-automatically.png)

17. Щелкните **Публикация приложения**. Дополнительные сведения о публикации приложений в Power BI см. в разделе [Публикация приложения](https://docs.microsoft.com/power-bi/service-create-distribute-apps#publish-your-app).

### <a name="view-the-power-bi-dashboard"></a>Просмотр панели мониторинга Power BI

Войдите в [Power BI](https://apps.powerbi.com), чтобы получить доступ к панели мониторинга Power BI и просмотреть ее.

> [!div class="mx-imgBorder"]
> ![view-power-dashboard](media/view-power-dashboard.png)

## <a name="view-and-manage-app-feedback"></a>Просмотр отзывов о приложении и управление ими

Все отзывы, предоставленные персоналом, использующим приложения холста на своих мобильных устройствах, хранятся в сущности **App Feedback** (Отзывы о приложении), администраторы могут просматривать эту сущность, а также управлять ею с помощью области **Администрирование** на панели навигации слева в приложении администрирования.

Чтобы просмотреть отзывы о приложении и управлять ими:

1. Войдите в [Power Apps](https://make.powerapps.com) и перейдите к своему приложению администрирования.

2. В области навигации слева щелкните область **Администрирование** в средстве выбора области:

3. Щелкните сущность **App Feedback** (Отзывы о приложении), чтобы просмотреть список отзывов о приложении, отправленных пользователями. Можно щелкнуть запись, чтобы просмотреть подробные сведения и пометить, просмотрена она или нет.  

    > [!div class="mx-imgBorder"]
    > ![select-app-feedback](media/select-app-feedback.png)

## <a name="issues-and-feedback"></a>Проблемы и отзывы

- Чтобы сообщить о проблемах с примером приложения для реагирования на чрезвычайные ситуации, перейдите по адресу <https://aka.ms/emergency-response-issues>.

- Чтобы оставить отзыв о примере приложения для реагирования на чрезвычайные ситуации, перейдите по адресу <https://aka.ms/emergency-response-feedback>.

## <a name="next-step"></a>Следующий шаг

[Использование приложения для реагирования на чрезвычайные ситуации](use.md)

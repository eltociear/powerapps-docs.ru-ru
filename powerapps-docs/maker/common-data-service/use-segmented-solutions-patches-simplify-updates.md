---
title: Использование сегментированных решений с Power Apps | MicrosoftDocs
description: Научитесь использовать сегментацию решений для обновления своих решений
ms.custom: ''
ms.date: 02/04/2020
ms.reviewer: ''
ms.service: powerapps
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 (online)
- Dynamics 365 Version 9.x
- powerapps
author: Mattp123
ms.assetid: 5c05f683-e1bd-4885-be23-b6973128773f
caps.latest.revision: 15
ms.author: matp
manager: kvivek
search.audienceType:
- maker
search.app:
- PowerApps
- D365CE
ms.openlocfilehash: d13eafa6858a6eec86de2db08504575c7fab9acd
ms.sourcegitcommit: 60a721432b3fa2abd14ccb3bd16a6b34e13ada85
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2020
ms.locfileid: "3026384"
---
# <a name="use-segmented-solutions"></a>Использование сегментированных решений 

Для получения возможности точнее контролировать, что именно распространяется в виде решений и исправлений к решениям, рекомендуется использовать сегментацию решений. В зависимости от сложности вашего приложения, сегментация решения может быть такой же простой, как и все в одном решении, для сегментации по типу компонента, например, сущности в одном решении, приложений холста во втором, и подключаемых модулей в третьем. Для создания сегментированных решений можно использовать область решений в Power Apps без написания программного кода.  

Существует три основных способа сегментации решений: 
- Делайте решения сегментированными при создании приложения. Для этого вы добавляете конкретные компоненты для управления тем, что входит в решение. Дополнительные сведения: [Создание сегментированного решения с активами сущностей](#create-a-segmented-solution-with-entity-assets)
- Создавайте сегментированные решения для сборки и выпуска небольших обновлений решения. Для этого вы клонируете исправление. Дополнительные сведения: [Создание исправления решения](#create-a-solution-patch)
- Создавайте сегментированные решения для сборки и выпуска крупных обновлений решения. Для этого вы клонируете решение. Дополнительные сведения: [Клонирование решения](#clone-a-solution)

## <a name="when-to-plan-for-segmentation"></a>Когда планировать сегментацию 
Аналогично планированию, которое используется при моделировании данных, поступающих в ваше приложение, планирование сегментации следует учитывать перед распространением решения. Сегментирование решений из одного решения в несколько решений через месяц или два года после создания исходного приложения может быть сложным и может вызывать проблемы.  

## <a name="solutions-as-patches"></a>Решения как исправления
Сегментация решений позволяет экспортировать исправления решения с выбранными компонентами сущностей — например, полями, формами или представлениями сущностей — а не целыми сущностями со всеми компонентами. 

Помимо получения большего контроля над составом решения, вы сможете управлять тем, что попадает в исправления. Вы можете создать исправление для родительского решения и экспортировать его в качестве дополнительного обновления базового решения. При клонировании решения система добавляет все связанные исправления в базовое решение и создает новую версию.  
  
 При работе с исправлениями и клонированными решениями следует помнить следующее:  
  
-   исправление представляет собой дифференциальное дополнительное обновление родительского решения; исправление может добавлять или обновлять компоненты или активы в родительском решении при установке на целевой системе, но оно не может удалить никакие компоненты или активы из родительского решения;  
  
-   исправление может иметь только одно родительское решение, но родительское решение может иметь одно или несколько исправлений;  
  
-   исправление создается для неуправляемого решения; невозможно создать исправление для управляемого решения;  
  
-   при экспорте исправление в целевую систему необходимо экспортировать его как управляемое исправление; не используйте неуправляемые исправления в производственных средах;  
  
-   родительское решение должно присутствовать в целевой системе, чтобы можно было установить исправление;  
  
-   исправление можно удалить или обновить;  
  
-   при удалении родительского решения все дочерние исправления также удаляются; Система дает предупреждение, что операцию удаления невозможно отменить. Удаление выполняется в одной транзакции. если одно из исправлений родительского решения не удается удалить, вся транзакция откатывается;  
  
-   после создания первого исправления для родительского решения, решение становится заблокированным и в него нельзя вносить какие-либо изменения или экспортировать его. Однако при удалении всех его дочерних исправлений родительское решение разблокируется.  
  
-   При клонировании базового решения все дочерние исправления добавляются в базовое решение и создается новая версия. Можно добавить, изменить или удалить компоненты и активы в клонированном решение;  
  
-   клонированное решение представляет собой замену базового решения, когда оно установлено в целевой системе как управляемое решение. Обычно клонированное решение используется для распространения основных обновлений предшествующему решению.  
  
### <a name="understanding-version-numbers-for-cloned-solutions-and-patches"></a>Схема номеров версий для клонированных решений и исправлений  
 Версия решения имеет следующий формат номера: основная.дополнительная.сборка.редакция. Исправление должны быть более высокий номер сборки или редакции, чем родительское решение. Оно не может иметь более высокий номер основной или дополнительной версии. Например, если базовое решение имеет версию 3.1.5.7, исправление может иметь версию 3.1.5.8 или 3.1.7.0, но не 3.2.0.0. Клонированное решение должно иметь номер версии больше или равный номеру версии базового решения. Например, если базовое решение имеет версию 3.1.5.7, клонированное решение может иметь версию 3.2.0.0 или 3.1.5.7. В пользовательском интерфейсе можно задавать только основной и дополнительный номера версий клонированного решения и значения сборки и редакции исправлений.  
  
## <a name="create-a-segmented-solution-with-entity-assets"></a>Создание сегментированного решения с активами сущностей 
 Чтобы создать сегментированное решение, начните с созданием неуправляемого решения и добавления существующих ресурсов. Можно добавить несколько системных или настраиваемых сущностей, а для каждой сущности выбрать активы, которые требуется включить в решение. Похожая на мастер процедура настройки позволяет по шагам выполнить процесс добавления активов сущностей.  
  
1. Перейдите на портал Power Apps, затем выберите **Решения**.  
  
2.  Выберите **Создать решение** и создайте решение. Заполните необходимые поля. Выберите **Создать**.  
  
3.  Откройте созданное решение. На панели команд выберите **Добавить существующий**, затем выберите **Сущность**.  
  
4.  На панели **Добавить существующие сущности** выберите одну или несколько сущностей, которые вы хотите добавить в решение, например стандартную сущность, такую как контакт, и настраиваемую сущность. Выберите **Далее**.  
    > [!div class="mx-imgBorder"] 
    > ![Добавление существующих сущностей](media/add-existing-entities1.png)

5.  На панели **Выберите сущности** можно выбрать из активов для включения. 
    - **Включить все компоненты**. Эта опция включает в себя все компоненты *и* метаданные, связанные с сущностью. Она может включать в себя другие сущности или компоненты сущности, такие как последовательности операций бизнес-процесса, отчеты, соединения и очереди. 
    - **Включить метаданные сущности**. Этот параметр включает в себя *только* метаданные, связанные с сущностью. Метаданные включают атрибуты сущности, такие как аудит, поиск повторяющихся данных или отслеживание изменений. 
    - **Выбрать компоненты**. Этот параметр позволяет индивидуально выбирать каждый компонент, связанный с сущностью, например поля, отношения, бизнес-правила, представления, формы и диаграммы. 
      > [!div class="mx-imgBorder"] 
      > ![Выберите компоненты сущности](media/add-existing-entities2.png)
  
6.  Выберите **Добавить**.  

### <a name="create-a-segmented-solution-using-solution-explorer"></a>Создание сегментированного решения с помощью обозревателя решений  
Следующие иллюстрации содержат примеры создания сегментированного решения путем выбора активов сущностей `Account`, `Case` и `Contact`.  

> [!NOTE]
> Сущность обращения включена в некоторые приложения Dynamics 365, такие как Dynamics 365 Customer Service. 
  
Начните с открытия неуправляемого решения, которое вы создали. Выберите компонент **Сущность**.  

 > [!div class="mx-imgBorder"] 
 > ![Добавьте существующие ресурсы.](media/solution-segmentation-add-existing-resources-admin.png "Добавьте существующие ресурсы.")  
  
 Затем выберите компоненты решения.  
  
 ![Выберите компоненты решения.](media/solution-segmentation-select-components-admin.png "Выберите компоненты решения.")  
  
 Следуйте указаниям мастера. В шаге 1 выберите активы (упорядочены по алфавиту) для первой сущности — `Account`, как показано ниже.  
  
 ![Запустите мастер.](media/solution-segmentation-wizard-starts-admin.png "Запустите мастер.")  
  
 Откройте вкладку **Поля** и выберите поле **Код организации**.  
  
 ![Выберите активы сущности "Организация".](media/solution-segmentation-select-account-assets-admin.png "Выберите активы сущности "Организация".")  
  
 В шаге 2 для сущности **Обращение** добавьте все активы.  
  
 ![Выберите активы сущности "Обращение".](media/solution-segmentation-select-case-assets-admin.png "Выберите активы сущности "Обращение".")  
  
 В шаге 3 добавьте поле **Годовщина** для сущности **Контакт**.  
  
 ![Выберите активы сущности "Контакт".](media/solution-segmentation-select-contact-assets-admin.png "Выберите активы сущности "Контакт".")  
  
 В результате созданное сегментированное решение содержит три сущности — `Account`, `Case` и `Contact`. Каждая сущность содержит только те активы, которые были выбраны.  
  
 > [!div class="mx-imgBorder"] 
 > ![Решение с сущностями.](media/solution-segmentation-solution-entities-admin.png "Решение с сущностями.")  
  
## <a name="create-a-solution-patch"></a>Создание исправления решения  
 Исправление содержит изменения родительского решения, например добавление или изменение активов и компонентов. Не следует включать компоненты родительского решения, если вы не планируете изменять их.  
  
### <a name="create-a-patch-for-an-unmanaged-solution"></a>Создание исправления для неуправляемого решения  
  
1. Перейдите на портал Power Apps, затем выберите **Решения**.   
  
2. В списке решений выберите неуправляемое решение для которого требуется создать исправление. На панели команд щелкните **Клонировать**, затем выберите **Клонировать исправление**. Открывшаяся правая панель содержит имя базового решения и номер версии исправления. Нажмите кнопку **Сохранить**.  
   > [!div class="mx-imgBorder"] 
   > <img src="media/clone-a-patch.png" alt="Clone a patch" height="735" width="408">
 
3. В списке решений найдите и откройте только что созданное исправление. Обратите внимание, что к уникальному имени решения добавлен текст _Patch_*шестнадцатеричный_номер*. Как и в случае базового решения, добавьте нужные компоненты и активы.  
  
#### <a name="create-a-patch-using-solution-explorer"></a>Создание исправления с помощью обозревателя решений
 Ниже приведен пример создания исправления для существующего решения. Для начала выберите **Клонировать исправление** (в компактном представлении значок **Клонировать исправление** содержит два небольших прямоугольника, как показано ниже).  
  
 > [!div class="mx-imgBorder"] 
 > ![Значок клонирования исправления.](media/solution-segmentation-click-patch-icon-admin.png "Значок клонирования исправления.")  
  
 В диалоговом окне **Клонировать в исправление** видно, что номер версии для исправления основан на номере версии родительского решения, а номер сборки увеличен на единицу. Каждое последующее исправление имеет более высокий номер сборки или редакции по сравнению с предыдущим исправлением.  
  
 ![Используйте диалоговое окно "Клонировать в исправление".](media/solution-segmentation-clone-patch-dialog-admin.png "Используйте диалоговое окно "Клонировать в исправление".")  
  
 Следующий скриншот показывает базовое решение **SegmentedSolutionExample**, версия **1.0.1.0**, и исправление **SegmentedSolutionExample_Patch**, версия **1.0.2.0**.  
  
 > [!div class="mx-imgBorder"] 
 > ![Сетка с решениями и исправлениями.](media/solution-segmentation-solution-patch-grid-admin.png "Сетка с решениями и исправлениями.")  
  
 В исправление мы добавили новую настраиваемую сущность `Book`и включили все активы сущности `Book` в это исправление.  
  
 ![Добавьте настраиваемую сущность в исправление.](media/solution-segmentation-add-book-patch-admin.png "Добавьте настраиваемую сущность в исправление.")  
  
## <a name="clone-a-solution"></a>Клонирование решения  
 При клонировании неуправляемого решения исходное решение и все относящиеся к нему исправления добавляются в новую версию исходного решения. После клонирования новая версия решения содержит первоначальные сущности и все компоненты или сущности, добавленные в исправлении. 

![Клонирование решения](media/cloned-solution.png)

> [!IMPORTANT]
> Клонирование решения удаляет исходное решение и связанные исправления. 
  
1. Перейдите на портал Power Apps, затем выберите **Решения**.   
  
2.  В списке решений выберите неуправляемое решение, для которого требуется создать клон. На панели команд щелкните **Клонировать**, затем выберите **Клонировать решение**. Правая панель отображает имя базового решения и новый номер версии. Нажмите кнопку **Сохранить**.  
  
  
### <a name="next-steps"></a>Дальнейшие шаги  
 [Обзор решений](solutions-overview.md)



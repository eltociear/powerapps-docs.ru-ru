---
title: Создание отношения между сущностями с помощью поля подстановки | Microsoft Docs
description: Пошаговые инструкции по созданию отношения между сущностями в PowerApps с помощью поля подстановки.
author: lancedMicrosoft
manager: kvivek
ms.service: powerapps
ms.component: cds
ms.topic: conceptual
ms.date: 02/21/2019
ms.author: lanced
search.audienceType:
  - maker
search.app:
  - PowerApps
  - D365CE
---

# <a name="create-a-relationship-between-entities"></a>Создание отношения между сущностями
Данные в одной сущности часто связаны с данными в другой сущности. Например, может иметься сущность **Преподаватели** и сущность **Класс**,и сущность **Класс** может иметь отношение подстановки с сущностью **Преподаватели** для отображения того, какой преподаватель преподает в этом классе. Можно использовать поле подстановки для отображения данных из сущности **Преподаватели**. Обычно это называется полем подстановки.

## <a name="define-a-relationship"></a>Определение отношения
Можно создать несколько типов отношений одной сущности с другой (или между сущностью и ей самой). Каждая сущность может иметь отношение с несколькими сущностями, и каждая сущность может иметь несколько отношений с другой сущностью. Некоторые распространенные типы отношений:

* **Многие к одному** — в этом типе отношений каждая запись в сущности A может соответствовать нескольким записям в сущности B, но каждая запись в сущности B может соответствовать только одной записи в сущности A. Например, класс имеет одну классную комнату. Это самый распространенный тип отношения, и он отображается в списке полей как **Поле подстановки**
* **Один ко многим** — в этом типе отношений каждая запись в сущности B может соответствовать нескольким записям в сущности A, но каждая запись в сущности A может соответствовать только одной записи в сущности B. Например, один преподаватель может преподавать в нескольких классах.
* **Многие ко многим** — в этом типе отношений каждой записи в сущности A может соответствовать несколько записей в сущности B и наоборот. Например, учащиеся посещают много классов, и в каждом классе имеется несколько учащихся.

Кроме того, можно настроить расширенное каскадное поведение для отношений "многие-к-одному" и "один-ко-многим" при каждом выполнении действия с родительским объектом.

## <a name="add-a-lookup-field-many-to-one-relationship"></a>Добавление поля подстановки (отношение "многие-к-одному")

Для добавления отношения подстановки в сущность создайте отношение на вкладке **Отношения** и укажите сущность, с которой требуется создать отношение.

1. На сайте [powerapps.com](https://web.powerapps.com/?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc) разверните раздел **Данные** и щелкните или нажмите **Сущности** на левой панели навигации.

2. Щелкните или нажмите существующую сущность или [Создайте новую сущность](data-platform-create-entity.md)

3. Щелкните **Отношения**

4. Щелкните **Добавить отношение**, при этом открывается новая панель, в которой можно выбрать сущность, с которой требуется создать отношение. Выберите сущность в раскрывающемся списке **Связанная сущность**.

    > [!div class="mx-imgBorder"] 
    > ![Отношение "многие к одному"](./media/data-platform-cds-newrelationship/manytoone-1.png "Отношение \"многие к одному\"")

5. После выбора сущности поля подстановки будут отображаться в основной сущности с именем по умолчанию, совпадающим с именем сущности (в данном примере это аудитория), однако их можно изменить при необходимости.

    ![Отношение "многие к одному"](./media/data-platform-cds-newrelationship/manytoone-2.png "Отношение \"многие к одному\"")

6. Щелкните **Готово** для добавления отношения к сущности, затем щелкните **Сохранить сущность**.

    > [!div class="mx-imgBorder"] 
    > ![Отношение "многие к одному"](./media/data-platform-cds-newrelationship/manytoone-3.png "Отношение \"многие к одному\"")

## <a name="add-a-one-to-many-relationship"></a>Добавление отношения "один-ко-многим"

Для добавления отношения "один-ко-многим" создайте отношение на вкладке **Отношения** и укажите сущность, с которой требуется создать отношение.

1. На сайте [powerapps.com](https://web.powerapps.com/?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc) разверните раздел **Данные** и щелкните или нажмите **Сущности** на левой панели навигации.

2. Щелкните или нажмите существующую сущность или [Создайте новую сущность](data-platform-create-entity.md)

3. Щелкните **Отношения**

4. Нажмите на стрелку вниз справа от **Добавить отношение**, это позволит выбирать оба типа отношений. Щелкните **Один-ко-многим**, при этом открывается новая панель, в которой можно выбрать сущность, с которой требуется создать отношение. Выберите сущность в раскрывающемся списке **Связанная сущность**.
    > [!div class="mx-imgBorder"] 
    > ![Отношение "один-ко-многим"](./media/data-platform-cds-newrelationship/onetomany-1.png "Отношение \"один-ко-многим\"")

5. После выбора сущности поля подстановки будут отображаться в основной сущности с именем по умолчанию, совпадающим с именем сущности (в данном примере это класс), однако их можно изменить при необходимости.

    > [!NOTE]
    > В случае отношений "один-ко-многим" поле подстановки будет создано в связанной сущности, а не в текущей выбранной сущности. Если нужно поле подстановки в текущей сущности, создайте отношение типа "многие к одному".

    > [!div class="mx-imgBorder"] 
    > ![Отношение "один-ко-многим"](./media/data-platform-cds-newrelationship/onetomany-2.png "Отношение \"один-ко-многим\"")

6. Щелкните **Готово** для добавления отношения к сущности, затем щелкните **Сохранить сущность**.

    > [!div class="mx-imgBorder"] 
    > ![Отношение "один-ко-многим"](./media/data-platform-cds-newrelationship/onetomany-3.png "Отношение \"один-ко-многим\"")

## <a name="add-a-many-to-many-relationship"></a>Добавление отношения "многие ко многим"
Для добавления отношения "многие-ко-многим" создайте отношение на вкладке **Отношения** и укажите сущность, с которой требуется создать отношение.

1. На сайте [powerapps.com](https://web.powerapps.com/?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc) разверните раздел **Данные** и щелкните или нажмите **Сущности** на левой панели навигации.

2. Щелкните или нажмите существующую сущность или [Создайте новую сущность](data-platform-create-entity.md)

3. Щелкните **Отношения**

4. Нажмите на стрелку вниз справа от **Добавить отношение**, это позволит выбирать оба типа отношений. Щелкните **Многие-ко-многим**, при этом открывается новая панель, в которой можно выбрать сущность, с которой требуется создать отношение. Выберите сущность в раскрывающемся списке **Связанная сущность**.

5. После выбора сущности появятся имена для отношения и сущности отношения. Они будут по умолчанию равны именам объединенных сущностей, однако их можно изменить при необходимости.

    > [!div class="mx-imgBorder"] 
    > ![Отношение "многие-ко-многим"](./media/data-platform-cds-newrelationship/manytomany-1.png "Отношение \"многие-ко-многим\"")

6. Щелкните **Готово** для добавления отношения к сущности, затем щелкните **Сохранить сущность**.


## <a name="add-advanced-relationship-behavior"></a>Добавление расширенного поведения отношения

При создании отношения "один-ко-многим" или "многие-к-одному" можно также задать расширенные поведения.

![Расширенное поведение](./media/data-platform-cds-newrelationship/advanced-1.png "Расширенное поведение")

Эти параметры также называются каскадными поведениями, поскольку они каскадом распространяются вниз по иерархии связанных сущностей. Например, может быть желательно удалить связанные тесты домашнюю работу студента, если студент удаляется из системы. Этот тип поведения называется родительским отношением.

С другой стороны, можно решить, что действие не должно каскадом распространяться вниз по иерархия. Например, в отношении преподавателя с классом можно решить, что дочерняя сущность (класс) *не* должна удаляться при удалении родительской сущности (учитель). Это называется ссылающимся отношением.

Когда вы моделируете бизнес-данных путем создания настраиваемых сущностей или при использовании существующих сущностей Common Data Model, рассмотрите требуемое вам поведение, а также последствия для всей иерархии связанных сущностей, затем выберите одно из следующих обычных поведений:

* **Ссылочный, удалить ссылку:** при ссылочном отношении между двумя сущностями можно переходить к любым связанным записям, но действия, выполняемые над одной записью, не выполняются над другими. Например, если имеется отношение "один-ко-многим" между учителями и классами, удаление учителя не повлияет на соответствующий класс.

* **Ссылочный, ограничить удаление:** при наличии ссылочного отношения с ограничением удаления между двумя сущностями можно переходить к любым связанным записям. Действия, выполняемые над родительской записью, не будут выполняться над дочерней, но пока она существует, удалить родительскую запись будет невозможно. Это полезно, если вы не хотите, чтобы дочерние записи стали сиротами. Пользователь должен обязательно удалить все дочерние записи перед удалением родительской.

    > [!div class="mx-imgBorder"] 
    > ![Ссылочный, ограничить удаление](./media/data-platform-cds-newrelationship/advanced-3.png "Ссылочный, ограничить удаление")

* **Родительский:** в родительском отношении между двумя сущностями любое действие, выполняемое над записью родительской сущности, также выполняется над всеми связанными с ней записями дочерних сущностей. Например, это может привести к тому, что все дочерние записи будут удалены при удалении родительской записи.

* **Настраиваемый:** в настраиваемом отношении между двумя сущностями выбирается поведение, связанное с каждым из наборов возможных действий. 

    > [!div class="mx-imgBorder"] 
    > ![Настраиваемое поведение](./media/data-platform-cds-newrelationship/advanced-2.png "Настраиваемое поведение")

Дополнительные сведения по значениям по умолчанию и настраиваемому поведению: [Настройка поведения отношений сущностей](entity-relationship-behavior.md).



## <a name="use-a-lookup-field-in-an-app"></a>Использование поля подстановки в приложении
Если [приложение создается автоматически](../canvas-apps/data-platform-create-app.md) из сущности, которая содержит поле подстановки, оно отображается как элемент управления **Раскрывающийся список**, содержащий данные из поля **Основное имя** сущности.

## <a name="add-1n-and-nn-relationships-for-canvas-apps"></a>Добавление отношений 1:N и N:N для приложений холста
Воспользуйтесь функцией **Связать**, чтобы связать две записи с помощью отношения "один-ко-многим" или "многие-ко-многим" в Common Data Service. Дополнительные сведения: [Функции связывания и отмены связывания в PowerApps](../canvas-apps/functions/function-relate-unrelate.md)

## <a name="next-steps"></a>Дальнейшие шаги
* [Формирование приложения с использованием базы данных Common Data Service](../canvas-apps/data-platform-create-app.md)
* [Создание приложения с нуля с помощью базы данных Common Data Service](../canvas-apps/data-platform-create-app-scratch.md)


---
title: Создание с нуля приложения на основе холста из данных Excel | Документация Майкрософт
description: В этом руководстве вы создадите приложение на основе холста с двумя экранами, позволяющее пользователям создавать, изменять и удалять записи в файле Excel.
author: tapanm-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: ''
ms.date: 03/26/2019
ms.author: tapanm
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 81426f24eea958b40f6d03da787a729603ec6f7f
ms.sourcegitcommit: d9cecdd5a35279d78aa1b6c9fc642e36a4e4612c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73537029"
---
# <a name="create-a-canvas-app-from-scratch-based-on-excel-data"></a>Создание с нуля приложения на основе холста из данных Excel

Создайте с нуля собственное приложение на основе холста, используя данные Excel в табличном формате, и при необходимости добавьте в него данные из других источников. Следуя указаниям в этом руководстве, вы создадите приложение с двумя экранами. На одном экране пользователи смогут просматривать набор записей. На другом экране пользователи могут создать запись, обновить одно или несколько полей в записи или удалить всю запись. Этот подход требует больше времени по сравнению с [автоматическим созданием приложения](get-started-create-from-data.md), но позволяет опытным пользователям создавать приложения в соответствии со своими потребностями.

## <a name="prerequisites"></a>Технические условия

Чтобы точно выполнить действия из этого руководства, создайте файл Excel на основе следующего примера данных.

1. Скопируйте эти данные и вставьте их в файл Excel.

    | StartDay | StartTime | Доброволец | Копия |
    | --- | --- | --- | --- |
    | Суббота |10:00–12:00 |Васкес (Vasquez) |Кумаширо (Kumashiro) |
    | Суббота |12:00–14:00 |Айс (Ice) |Сингхал (Singhal) |
    | Суббота |14:00–16:00 |Мик (Myk) |Мюллер (Mueller) |
    | Воскресенье |10:00–12:00 |Ли (Li) |Адамс (Adams) |
    | Воскресенье | 12:00–14:00 |Сингх (Singh) |Морган (Morgan) |
    | Воскресенье | 14:00–16:00 |Батье (Batye) |Нгуен (Nguyen) |

2. Отформатируйте данные в виде таблицы под названием **Schedule**, чтобы приложение PowerApps могло проанализировать их.

    Дополнительные сведения см. в разделе [Форматирование таблицы в Excel](how-to-excel-tips.md).

3. Сохраните файл с именем **евентсигнуп. xlsx**, закройте его, а затем отправьте в [учетную запись облачного хранилища](connections/cloud-storage-blob-connections.md), например в OneDrive.

> [!IMPORTANT]
> Вы можете использовать собственный файл Excel и ознакомиться только с общими понятиями в этом учебнике. Тем не менее данные в файле Excel должны быть отформатированы в виде таблицы. Дополнительные сведения см. в разделе [Форматирование таблицы в Excel](how-to-excel-tips.md).

## <a name="open-a-blank-app"></a>Пустое приложение

1. Войдите в [PowerApps](https://make.powerapps.com?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc).

1. В разделе **Создание собственного приложения** выберите **Приложение на основе холста с нуля**.

    > [!div class="mx-imgBorder"]
    >![Создание приложения на основе холста с нуля](./media/get-started-create-from-blank/blank-app.png)

1. Укажите имя приложения, выберите **Телефон**, а затем выберите **Создать**.

    Вы можете разработать с нуля приложение для телефонов или других устройств (например, планшетов). Этот раздел посвящен разработке приложения для телефонов.

    > [!div class="mx-imgBorder"]
    >![Указание имени и формата приложения](./media/get-started-create-from-blank/excel-demo.png)

    PowerApps Studio создаст пустое приложение для телефонов.

1. Если отобразится диалоговое окно **Вас приветствует PowerApps Studio**, выберите **Пропустить**.

## <a name="connect-to-data"></a>Подключение к данным

1. В центре экрана выберите **подключение к данным**.

1. На панели **Данные** выберите подключение к нужному облачному хранилищу, если оно отображается. В противном случае выполните следующие действия для добавления подключения:

    1. Щелкните **Новое подключение**, а затем — плитку облачной учетной записи и выберите **Создать**.
    2. Если появится запрос, предоставьте учетные данные для этой учетной записи.

1. В разделе **выбора файла Excel** вставьте строку **eventsignup** или введите ее первые буквы, чтобы отфильтровать список, а затем выберите загруженный файл.

1. В разделе **выбора таблицы** установите флажок **Расписание** и щелкните **Подключиться**.

1. Закройте область **Данные**, нажав значок закрытия (X) в правом верхнем углу.

## <a name="create-the-view-screen"></a>Создание экрана просмотра

1. На вкладке **Главная** щелкните стрелку вниз рядом с элементом **Новый экран**, чтобы открыть список типов экрана, и выберите **Список**.

    Экран добавляется с несколькими элементами управления по умолчанию, в том числе с полем поиска и элементом управления **[Коллекция](controls/control-gallery.md)** . Коллекция занимает размер всего экрана под полем поиска.

1. В верхней части нового экрана выберите элемент управления **[Метка](controls/control-text-box.md)** , а затем замените текст **[Title]** строкой **Просмотр записей**.

     ![Изменение строки заголовка](./media/get-started-create-from-blank/change-title-bar.png)

1. На панели навигации слева выберите **BrowseGallery1**.

    Вокруг коллекции появится рамка выделения с маркерами захвата.

    ![Добавление окна списка](./media/get-started-create-from-blank/select-gallery.png)

1. На вкладке **Свойства** на панели справа щелкните стрелку вниз в меню **Макет**.

    ![Открытие меню макета](./media/get-started-create-from-blank/select-layout.png)

1. Выберите **Заголовок, подзаголовок и текст**.

1. В строке формулы замените **CustomGallerySample** на **Schedule**, а также замените оба экземпляра **SampleText** на **Volunteer**.

1. Справа от строки формулы щелкните стрелку вниз, а затем выберите **Форматирование текста**.

    Формула соответствует следующему примеру:

    ```powerapps-dot
    SortByColumns(
        Search(
            Schedule,
            TextSearchBox1.Text,
            "Volunteer"
        ),
        "Volunteer",
        If(
            SortDescending1,
            SortOrder.Descending,
            SortOrder.Ascending
        )
    )
    ```

1. На вкладке **Свойства** на панели справа выберите **Изменить** рядом с меткой **Поля**.

1. В поле **Title2** выберите " **добровольный**", в поле **Subtitle2** выберите **Стартдай**, а в поле **Body1** выберите **StartTime**.

1. Закройте область **Данные**, нажав значок закрытия (X) в правом верхнем углу.

Пользователи могут сортировать и фильтровать коллекции по имени волонтера, используя функции формулы **SortByColumns** и **Search**.

- Когда пользователь вводит в поле поиска хотя бы одну букву, в коллекции отображаются только те записи, для которых поле **Volunteer** содержится эта буква.
- Когда пользователь нажимает кнопку сортировки (между кнопкой "Обновить" и кнопкой со знаком "плюс" в строке заголовка), записи в коллекции отображаются в возрастающем или убывающем порядке (в зависимости от того, сколько раз пользователь нажал на кнопку) на основе значения поля **Volunteer**.

Дополнительные сведения об этих и других функциях приведены в [справочнике формул](formula-reference.md).

## <a name="create-the-change-screen"></a>Создание экрана изменений

1. На вкладке **Главная** щелкните стрелку вниз рядом с элементом **Новый экран** и выберите **Форма**.

1. На левой панели навигации выберите **EditForm1**.

1. На вкладке **Свойства** на панели справа щелкните стрелку вниз рядом с элементом **Источник данных** и в появившемся списке выберите **Расписание**.

1. В указанном источнике данных выберите **Изменить поля**.

1. В области **Поля** выберите **Добавить поле**, установите флажок для каждого поля и выберите **Добавить**.

1. Щелкните стрелку рядом с именем каждого поля, чтобы свернуть его, а затем перетащите поле **Volunteer** вверх, чтобы оно появилось в верхней части списка полей.

     ![Изменение порядка полей](./media/get-started-create-from-blank/reorder-fields.png)

1. Закройте область **Поля**, нажав значок закрытия (X) в правом верхнем углу.

1. Установите это выражение в качестве значения свойства **Item**, скопировав и вставив его в строку формул или набрав с помощью клавиатуры:

    `BrowseGallery1.Selected`

1. В верхней части экрана выберите элемент управления **[Метка](controls/control-text-box.md)** , а затем замените текст **[Title]** строкой **Изменение записей**.

    ![Изменение строки заголовка](./media/get-started-create-from-blank/change-title-bar2.png)

## <a name="delete-and-rename-screens"></a>Добавление и переименование экранов

1. На панели навигации слева нажмите на кнопку с многоточием (...) для экрана **Screen1** и выберите действие **Удалить**.

    ![Удаление экрана](./media/get-started-create-from-blank/delete-screen.png)

1. Нажмите на кнопку с многоточием (...) для экрана **Screen2**, выберите действие **переименовать** и введите для него имя **ViewScreen**.

1. Нажмите на кнопку с многоточием (...) для экрана **Screen3**, выберите действие **переименовать** и введите для него имя **ChangeScreen**.

## <a name="configure-icons-on-the-view-screen"></a>Настройка значков на экране просмотра

1. В верхней части экрана **ViewScreen** щелкните значок с кольцевой стрелкой.

    ![Добавление записи](./media/get-started-create-from-blank/refresh-icon.png)

1. Для свойства **OnSelect** этой кнопки введите следующую формулу:

    `Refresh(Schedule)`

    Когда пользователь щелкнет этот значок, данные из таблицы **Schedule** будут заново извлечены из файла Excel.

    Дополнительные сведения об этих и других функциях приведены в [справочнике по формулам](formula-reference.md).

1. В правом верхнем углу экрана **ViewScreen** щелкните значок "плюс".

    ![Добавление записи](./media/get-started-create-from-blank/add-record.png)

1. Для свойства **OnSelect** этой кнопки введите следующую формулу:

    `NewForm(EditForm1);Navigate(ChangeScreen,ScreenTransition.None)`

    Когда пользователь щелкнет этот значок, откроется экран **ChangeScreen** с пустыми полями для быстрого создания записи.

1. Щелкните стрелку вправо рядом с первой записью в коллекции.

    ![Выбор стрелки](./media/get-started-create-from-blank/select-arrow.png)

1. Задайте для свойства **OnSelect** этой стрелки следующую формулу:

    `EditForm(EditForm1); Navigate(ChangeScreen, ScreenTransition.None)`

    Когда пользователь щелкнет этот значок, отобразится экран **ChangeScreen** с информацией из выбранной записи в каждом поле, что позволит легко изменить или удалить эту запись.

## <a name="configure-icons-on-the-change-screen"></a>Настройка значков на экране редактирования

1. На экране **ChangeScreen** щелкните значок "X" в левом верхнем углу.

    ![Значок отмены](./media/get-started-create-from-blank/cancel-icon.png)

1. Для свойства **OnSelect** этой кнопки введите следующую формулу:

    `ResetForm(EditForm1);Navigate(ViewScreen, ScreenTransition.None)`

    Когда пользователь щелкнет этот значок, отменятся все внесенные на этом экране изменения и отобразится экран просмотра.

1. В правом верхнем углу щелкнет значок галочки.

    ![Значок с галочкой](./media/get-started-create-from-blank/checkmark-icon.png)

1. Задайте для свойства **OnSelect** этой галочки следующую формулу:

    `SubmitForm(EditForm1); Navigate(ViewScreen, ScreenTransition.None)`

    Когда пользователь щелкнет этот значок, сохранятся все внесенные на этом экране изменения и отобразится экран просмотра.

1. На вкладке **Вставка** выберите **Значки**, а затем — значок **мусорной корзины**.

1. Задайте для свойства **Цвет** этого значка значение **Белый** и переместите его так, чтобы он располагался рядом со значком галочки.

    ![Значок корзины](./media/get-started-create-from-blank/trash-icon.png)

1. Для свойства **Visible** значка мусорной корзины введите следующую формулу:

    `EditForm1.Mode = FormMode.Edit`

    Этот значок будет отображаться, только если форма находится в состоянии **Изменить**, а не в состоянии **Создать**.

1. Для свойства **OnSelect** значка мусорной корзины введите следующую формулу:

    `Remove(Schedule, BrowseGallery1.Selected); Navigate(ViewScreen, ScreenTransition.None)`

    Когда пользователь щелкнет этот значок, выбранная запись будет удалена из источника данных и откроется экран просмотра.

## <a name="test-the-app"></a>Тестирование приложения

1. Выберите экран **ViewScreen**, откройте режим предварительного просмотра, нажав клавишу F5 или щелкнув значок **Предварительный просмотр** в правом верхнем углу.

    ![Открытие режима предварительного просмотра](./media/get-started-create-from-blank/open-preview.png)

1. Введите или вставьте одну или несколько букв в поле поиска, чтобы отфильтровать список по имени добровольца.

1. Выберите значок сортировки один или более раз, чтобы отсортировать данные по имени добровольца по возрастанию или по убыванию.

1. Добавьте запись.

1. Измените значения полей в новой записи и сохраните эти изменения.

1. Измените значения полей в этой же записи и отмените эти изменения.

1. Удалите запись, которую вы добавили ранее.

1. Закройте режим предварительного просмотра, нажав клавишу Esc или выбрав значок закрытия в правом верхнем углу.

## <a name="next-steps"></a>Дальнейшие действия

- Нажмите клавиши CTRL+S, чтобы сохранить приложение в облаке. После этого его можно будет запускать с других устройств.
- [Поделитесь приложением](share-app.md), чтобы другие пользователи могли с ним работать.
- См. дополнительные сведения о таких [функциях](working-with-formulas.md), как **Исправление**, которые позволяют управлять данными без необходимости создавать стандартную форму.
- [Связать это приложение с решением](add-app-solution.md), чтобы можно было, например, развернуть его в другой среде или опубликовать его в AppSource.

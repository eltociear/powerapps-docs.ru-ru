---
title: Отправка push-уведомлений | Документация Майкрософт
description: Узнайте, как отправлять собственные push-уведомления в приложение в Power Apps.
author: kavishi
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 08/08/2017
ms.author: kaagar
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: b336b6d73cbd3db8aac435035d44859080208534
ms.sourcegitcommit: 6b27eae6dd8a53f224a8dc7d0aa00e334d6fed15
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2019
ms.locfileid: "74724619"
ms.PowerAppsDecimalTransform: true
---
# <a name="send-a-push-notification-in-power-apps"></a>Отправка push-уведомления в Power Apps
Push-уведомления используются в мобильных приложениях преимущественно при работе с потребителями и в бизнес-сценариях для привлечения пользователей приложений и определения приоритетности ключевых задач. В Power Apps можно отправлять уведомления с помощью соединителя уведомлений Power Apps. Собственные push-уведомления можно отправлять в любое приложение, создаваемое в Power Apps. В будущем мы планируем добавить больше типов уведомлений.

![Пример того, как выглядит push-уведомление](./media/add-notifications/pic1-notification-screenshot.png)

Добавьте в приложение функцию push-уведомлений, если:

* вам нужно оперативно информировать пользователей;
* пользователи должны выполнять важные задачи с помощью приложения в предварительно загруженном контексте;
* вам нужно привлечь пользователей на определенный срок или требуется, чтобы пользователи вошли в приложение в определенном контексте.

> [!NOTE]
> Чтобы получать push-уведомления, каждый пользователь должен открыть приложение в Power Apps на мобильных устройствах или получить приложение из AppSource в [Dynamics 365](https://home.dynamics.com/).

## <a name="before-you-start"></a>Перед началом работы
В приложении, для которого у вас есть разрешение **участник** , добавьте подключение к уведомлению Power Apps. Если у вас еще нет приложения, вы можете быстро [создать его из шаблона](get-started-test-drive.md). Вы получите необходимые разрешения по умолчанию. В этих руководствах используется приложение на основе шаблона Case Management.

## <a name="send-a-notification-from-a-flow"></a>Отправка уведомления из потока
> [!NOTE]
> Если активировать push-уведомление из потока, сейчас вы сможете отправить уведомление только одному пользователю или группе безопасности за раз.

1. В [Power Автоматизируйте](https://flow.microsoft.com)создание триггера, который указывает, когда отправляется push-уведомление.

    Например, можно отправлять уведомление при добавлении записи в сущность **Case** в службе Common Data Service.

    ![Снимок экрана создания потока с триггером Common Data Service](./media/add-notifications/pic4-step1-flowupdated.png)
2. Создайте действие для последовательности с помощью соединителя **уведомлений Power Apps** и введите **идентификатор приложения** , для которого требуется отправлять уведомления.

    Вы также можете переименовать подключение в соответствии со своим сценарием.

    ![Снимок экрана создания подключения к приложениям Power Apps, которые будут получать push-уведомления](./media/add-notifications/pic5-step2-create-connection.jpg)
3. (Необязательно.) Передайте параметры в приложение, когда оно откроется (при касании push-уведомления).

    В нашем примере мы передаем выбранному контакту поля **Case ID** (Идентификатор обращения) и **Initial Owner** (Первоначальный владелец).

    ![Снимок экрана с передачей необязательных параметров в push-уведомление](./media/add-notifications/pic6-step3-configure-notif.jpg)

## <a name="send-a-notification-from-an-app"></a>Отправка уведомления из приложения
Вы можете отправлять push-уведомления из одного приложения в другое или то же приложение.

1. В [Power Apps](https://make.powerapps.com?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc)перейдите к приложению, для которого нужно отправить push-уведомления.
2. На вкладке **Подробности** скопируйте **идентификатор приложения**.

    ![Получение идентификатора приложения](./media/add-notifications/grab-id.png)
3. На вкладке **подключения** создайте подключение к соединителю уведомлений Power Apps и вставьте идентификатор приложения из предыдущего шага.

    ![Создание подключения](./media/add-notifications/create-connection.png)
4. Добавьте подключение к приложению триггера.

    В нашем примере используется приложение триггера. Пользователь, который переназначает задание, также активирует отправку push-уведомления новому владельцу обращения.

    ![Добавление подключения](./media/add-notifications/add-connection.png)
5. Из подключения push-уведомления вызовите метод **SendPushNotification**.

    В нашем примере это уведомление активируется с помощью свойства **OnSuccess** в форме.

    ![Формула Power Apps](./media/add-notifications/powerapps-function.png)

## <a name="load-a-specific-page-and-context-when-a-user-taps-the-notification"></a>Загрузка определенной страницы и контекста при касании уведомления
### <a name="pass-parameters"></a>Передача параметров
Вы можете использовать push-уведомления для передачи определенных параметров в приложение. Например, чтобы считать значение **CaseID**, используйте *Param("CaseID")* . Чтобы быстро определять этот параметр, добавьте элемент управления **Метка** в приложение. Для свойства **Text** этого элемента управления задайте значение **Param("CaseID")** . Если приложение открывается из списка **Все приложения**, значение будет пустым. Если же открыть приложение из другого расположения на устройстве, указывается значение **CaseID**.

### <a name="set-the-start-page"></a>Настройка начальной страницы
Можно настроить, чтобы при открытии приложения открывалась страница, например, **Сведения об обращении**.

1. Добавьте элемент управления **Таймер** и задайте для свойства **OnTimerEnd** следующую формулу в качестве значения:
   <br>**Navigate(EditCase; ScreenTransition.None)** .
2. (Необязательно.) Чтобы скрыть элемент управления **Таймер**, задайте для его свойства **Visible** значение **false**.
3. Для свойства экрана **OnVisible** установите значение **Timer.Start()** .

> [!TIP]
> Мы рекомендуем создать в приложении уникальную первую страницу для уведомления:
> 
> 1. Создайте пустую страницу, которая еще не открывалась в приложении. Добавьте элемент управления **Текстовое поле** и задайте для него значение **timer.Duration**.
> 2. Создавая приложение, установите для таймера ненулевое значение. Когда приложение будет готово к публикации, установите значение **0**, чтобы сразу же активировать таймер.

## <a name="syntax"></a>Синтаксис

| Имя | Description |
| --- | --- |
| SendPushNotification |Отправляет push-уведомление в приложение, указанное в настройках подключения push-уведомления. |

### <a name="parameters"></a>Вход

| Имя | Тип | Description |
| --- | --- | --- |
| recipients |Обязательный массив строк |Представляет собой список: <ul> <li>адресов электронной почты пользователей или групп безопасности;</li> <li>идентификаторов объектов для пользователей или групп безопасности в Azure Active Directory.</li></ul> |
| message |Строка, обязательный параметр |Текст сообщения для push-уведомления. |
| openApp |Логический, необязательный параметр |Настройка открытия приложения, когда пользователь касается push-уведомления. |
| params |Параметры, необязательный параметр |Параметры типа "ключ-значение" для передачи с уведомлением. Они могут дополнительно обрабатываться в приложении для открытия определенной страницы и загрузки необходимого состояния. |

### <a name="sample-formulas"></a>Примеры формул
Отправьте базовое уведомление.

```powerapps-comma
PowerAppsNotification.SendPushNotification(
    {
        recipients: ["f60ccf6f-7579-4f92-967c-2920473c966b"; "72f988bf-86f1-41af-91ab-2d7cd011db47"];
        message: "A new case was assigned to you."
    }
)
```

Отправьте уведомление, которое открывает приложение и передает определенные параметры.

```powerapps-comma
PowerAppsNotification.SendPushNotification(
    {
        recipients: ["email1@contoso.com"; "email2@contoso.com"];
        message: "message in the notif toast";
        params: Table({key:"notificationKey"; value:"The value for notificationKey"});
        openApp: true
    }
)
```

## <a name="known-limitations"></a>Известные ограничения
* В настоящее время уведомления не отображаются на мобильном устройстве Power Apps для Windows Phone.
* На этом этапе push-уведомления не поддерживаются, если пользователи запускают приложение только в веб-браузере.
* В уведомлениях отображается значок универсальных приложений Power Apps вместо определенного значка приложения.
* При использовании Power Автоматизация вы можете отправлять push-уведомления только одному получателю за раз.

Справочные сведения см. в статье [Справочник по уведомлениям Power Apps](https://docs.microsoft.com/connectors/powerappsnotification/).


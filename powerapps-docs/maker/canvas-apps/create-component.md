---
title: Создание компонента для приложений Canvas | Документация Майкрософт
description: Общие сведения о многократно используемых компонентах для приложений Canvas
author: yifwang
ms.service: powerapps
ms.topic: article
ms.date: 02/20/2020
ms.author: yifwang
ms.reviewer: tapanm
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: b86f6c94a7a267fc28a70216c6b89d154cd7b865
ms.sourcegitcommit: efb05dbd29c4e4fb31ade1fae340260aeba2e02b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2020
ms.locfileid: "78293231"
---
# <a name="create-a-component-for-canvas-apps"></a>Создание компонента для приложений Canvas

> [!IMPORTANT]
> Эта функция по-прежнему доступна в общедоступной предварительной версии. Дополнительные сведения см. в статье [Экспериментальные и предварительные версии](working-with-experimental.md).

Компоненты — это многократно используемые стандартные блоки для приложений Canvas, позволяющие создателям приложений создавать пользовательские элементы управления для использования внутри приложения или приложения, использующие [библиотеку компонентов](component-library.md). Компоненты могут использовать дополнительные функции, такие как пользовательские свойства и включающие сложные возможности. В этой статье описываются концепции компонентов и некоторые примеры.

Компоненты полезны при создании больших приложений с похожими шаблонами элементов управления. При обновлении определения компонента внутри приложения все экземпляры в приложении будут отражать изменения. Компоненты также снижают количество усилий, устраняя необходимость в копировании и вставке элементов управления и повышении производительности. Кроме того, компоненты помогают создавать совместную разработку и стандартизировать внешний вид и поведение в Организации при использовании [библиотеки компонентов](component-library.md).

## <a name="components-in-canvas-app"></a>Компоненты в приложении Canvas

Можно создать компонент в приложении, как описано в этой статье, или создать новый компонент в [библиотеке компонентов](component-library.md). Библиотеку компонентов следует использовать для требований к использованию компонентов на нескольких экранах приложения. Можно также скопировать существующие компоненты в существующую или новую библиотеку компонентов.

Чтобы создать компонент в приложении, перейдите в представление " **дерево**", выберите вкладку " **компоненты** " и щелкните " **создать компонент**":

![Создание нового пользовательского компонента с помощью представления в виде дерева](./media/create-component/insert-new-component-treeview.png)

При выборе пункта **новый компонент** открывается пустой холст. Элементы управления можно добавлять как часть определения компонента на холсте. При редактировании компонента на холсте экземпляры одного и того же компонента будут обновляться на других экранах приложения. Приложения, которые повторно используют уже созданный компонент, могут также получать обновления компонентов после публикации изменений компонентов.

Вы можете выбрать компонент из списка существующих компонентов в левой области навигации после выбора экрана. При выборе компонента экземпляр этого компонента вставляется на экран; точно так же, как вы вставляете элемент управления.

Компоненты, доступные внутри приложения, перечислены в разделе **Пользовательская** Категория в списке компонентов в представлении в виде дерева. Компоненты импортированных библиотек компонентов перечислены в разделе Категория **компонентов библиотеки** :

![Вставка компонентов в приложение](./media/create-component/insert-components.png)

> [!NOTE]
> Компоненты, обсуждаемые в этой статье, отличаются от платформы компонентов Power Apps, которая позволяет разработчикам и создателям создавать компоненты кода для приложений на основе моделей и Canvas. Дополнительные сведения см. в статье [Обзор платформы компонентов Power Apps](https://docs.microsoft.com/powerapps/developer/component-framework/overview).

## <a name="scope"></a>Область видимости

Придумайте компонент как инкапсулированный черный прямоугольник со свойствами в качестве интерфейса. К элементам управления в компоненте нельзя обращаться извне компонента. И вы не можете ссылаться на что-либо за пределами компонента внутри компонента. Исключением являются источники данных, совместно используемые приложением и его компонентами. Ограничения области обеспечивают простой и целостный контракт данных компонента, а также позволяют выполнять обновления определений компонентов, особенно в приложениях с библиотеками компонентов. Контракт данных компонента можно обновить, создав одно или несколько пользовательских свойств.

> [!NOTE]
> Экземпляры компонентов можно вставлять в экран в библиотеке компонентов и просматривать на экране в целях тестирования. Кроме того, обратите внимание, что библиотека компонентов не отображается при использовании [Power Apps Mobile](https://powerapps.microsoft.com/downloads/).

## <a name="custom-properties"></a>Пользовательские свойства

Компонент может принимать входные значения и выдавать данные при создании одного или нескольких пользовательских свойств. Эти сценарии расширены и потребовали понимания [формул](formula-reference.md) и привязки контрактов.

**Свойство Input** — это способ, которым компонент получает данные для использования в компоненте. Входные свойства отображаются на вкладке **Свойства** правой панели, если выбран экземпляр компонента. Можно настроить входные свойства с помощью выражений или формул так же, как стандартные свойства в других элементах управления. Другие элементы управления имеют входные свойства, такие как свойство **по умолчанию** элемента управления **вводом текста** .

**Свойство Output** используется для выдачи данных или состояния компонента. Например, **выбранное** свойство элемента управления " **коллекция** " является выходным свойством. При создании выходного свойства можно определить, какие другие элементы управления могут ссылаться на состояние компонента.

Ниже приводится пошаговое описание этих концепций.

## <a name="create-an-example-component"></a>Создание примера компонента

В этом примере вы создадите компонент меню, похожий на следующий рисунок. Вы можете изменить текст позже, чтобы использовать его на нескольких экранах, приложениях или в обоих окнах:

![Окончательная версия коллекции](./media/create-component/menu-instance-new.png)

> [!NOTE]
> При создании компонентов для повторного использования рекомендуется использовать [библиотеку компонентов](component-library.md) . Обновление компонентов внутри приложения делает доступными только обновления компонентов внутри приложения. При импорте компонентов из одного приложения в другое новые обновления для компонентов в исходном приложении не распространяются на приложение, которое импортировало эти компоненты ранее. При использовании библиотеки компонентов появляется запрос на обновление компонентов при обновлении и публикации компонентов в библиотеке.

### <a name="create-a-new-component"></a>Создание нового компонента

1. Войдите в [make.powerapps.com](https://make.powerapps.com).

1. Выберите **приложения** и выберите **приложение холста из пустого**поля. 

1. Укажите имя приложения, выберите любой макет и нажмите кнопку **создать**.

1. В **представлении в виде дерева**выберите **компоненты** и щелкните **создать компонент** , чтобы создать новый компонент.

    ![Создание нового пользовательского компонента с помощью представления в виде дерева](./media/create-component/insert-new-component-treeview.png)

1. Выберите новый компонент в левой области навигации, нажмите кнопку с многоточием (...) и выберите **Переименовать**. Введите или вставьте имя как **менукомпонент**.

1. На правой панели установите ширину компонента **150** , а его высоту — **250**, а затем выберите **новое настраиваемое свойство**. Можно также задать для высоты & ширину любое другое значение, если это необходимо.

    ![Создать свойство](./media/create-component/new-property.png)

1. В полях **Отображаемое имя**, **имя свойства**и **Описание** введите или вставьте текст как *элементы*.

    ![Отображаемое имя, имя свойства, поля описания](./media/create-component/property-names.png)

    Не включайте пробелы в имя свойства, так как при написании формулы вы будете ссылаться на компонент по этому имени. Например, **ComponentName. PropertyName**.

    Отображаемое имя отображается на вкладке **Свойства** правой панели, если выбран компонент. Описательное отображаемое имя помогает и другим руководителям понять назначение этого свойства. **Описание** отображается в подсказке при наведении указателя мыши на отображаемое имя этого свойства на вкладке **свойства** .

1. В списке **тип данных** выберите **Таблица**, а затем щелкните **создать**.

    ![Тип данных свойства](./media/create-component/property-data-type.png)

    Свойству **Items** присваивается значение по умолчанию, основанное на указанном типе данных. Вы можете задать значение, соответствующее вашим потребностям. Если указан тип данных **Таблица** или **запись**, может потребоваться изменить значение свойства **Items** в соответствии со схемой данных, которую необходимо ввести в компонент. В этом случае вы измените его на список строк.

    Значение свойства можно задать в строке формул, если выбрать имя свойства на вкладке **Свойства** на правой панели.

    ![Пользовательское свойство ввода на вкладке "Свойства"](./media/create-component/properties-tab.png)

    Как показано на следующем рисунке, можно также изменить значение свойства на вкладке **Дополнительно** панели справа.

1. Задайте для свойства Components ( **элементы** ) значение этой формулы:

    ```powerapps-dot
    Table({Item:"SampleText"})
    ```

    ![Формула](./media/create-component/set-component-items.png)

1. В компоненте Вставьте пустой вертикальный элемент управления " **коллекция** " и выберите **Макет** на панели свойств в качестве **заголовка**.

1. Убедитесь, что в списке свойств отображается свойство **Items** (как оно выполняется по умолчанию). Затем присвойте этому свойству значение, равное этому выражению:

    ```powerapps-dot
    MenuComponent.Items
    ```

    Таким образом, свойство **Items** элемента управления " **коллекция** " считывает и зависит от свойства "входные **элементы** " компонента.

1. Необязательно. Задайте для свойства **BorderThickness** элемента управления **галереи** значение **1** , а для свойства **темплатесизе** — значение **50**. Кроме того, можно изменить значения толщины и размера шаблона на любое другое значение.

### <a name="add-component-to-a-screen"></a>Добавление компонента на экран

Далее предстоит добавить компонент на экран и указать таблицу строк для отображения компонента.

1. На панели навигации слева выберите список экранов, а затем щелкните экран по умолчанию.

    ![Экран по умолчанию](./media/create-component/default-screen.png)

1. На вкладке **Вставка** откройте меню **компоненты** и выберите **менукомпонент**.

    ![Вставить](./media/create-component/insert.png)

    Новый компонент называется **MenuComponent_1** по умолчанию.

1. Задайте для свойства **Items** **MenuComponent_1** следующую формулу:

    ```powerapps-dot
    Table({Item:"Home"}, {Item:"Admin"}, {Item:"About"}, {Item:"Help"})
    ```

    Этот экземпляр напоминает этот рисунок, но можно настроить текст и другие свойства каждого экземпляра.

    ![Окончательная версия коллекции](./media/create-component/menu-instance-new.png)

### <a name="create-and-use-output-property"></a>Создание и использование свойства Output

До сих пор вы создали компонент и добавили его в приложение. Далее предстоит создать выходное свойство, отражающее элемент, который пользователь выбирает в меню.

1. Откройте список компонентов и выберите **менукомпонент**.

1. На правой панели перейдите на вкладку **Свойства** и выберите **новое настраиваемое свойство**.

1. В полях **Отображаемое имя**, **имя свойства**и **Описание** введите или вставьте **Выбранные**.

1. В разделе **тип свойства**выберите **выходные данные**, а затем щелкните **создать**.

    ![Тип свойства в качестве выходных данных](./media/create-component/output-property-type.png)

1. На вкладке **Дополнительно** задайте этому выражению значение **выбранного** свойства, при необходимости изменяя цифру в имени коллекции:

    ```powerapps-dot
    Gallery1.Selected.Item
    ```

    ![Панель "Дополнительно"](./media/create-component/advance.png)

1. На экране приложения по умолчанию добавьте метку и присвойте этому выражению свойство **Text** , при необходимости настроив цифру в имени компонента:

    ```powerapps-dot
    MenuComponent_1.Selected
    ```

    **MenuComponent_1** является именем экземпляра по умолчанию, а не именем определения компонента. Любой экземпляр можно переименовать.

1. Удерживая нажатой клавишу Alt, выберите каждый элемент в меню.

    Элемент управления " **Метка** " отражает пункт меню, который вы выбрали в последнее время.

## <a name="import-and-export-components"></a>Импорт и экспорт компонентов

> [!NOTE]
> Эта функция будет устаревшей. [Библиотеки компонентов](component-library.md) — это рекомендуемый способ повторного использования компонентов в приложениях. При использовании библиотеки компонентов приложение поддерживает зависимости от используемых компонентов. Если обновления зависимых компонентов станут доступны, создатель приложения получит оповещение. Таким образом, все новые многократно используемые компоненты должны создаваться в библиотеках компонентов.

### <a name="import-components-from-another-app"></a>Импорт компонентов из другого приложения

Чтобы импортировать один или несколько компонентов из одного приложения в другое, выберите **импортировать компоненты** из меню **Вставка** , а затем используйте **Пользовательский** раскрывающийся список. Или с помощью **компонентов** в древовидном представлении в левой области навигации.

В диалоговом окне перечислены все приложения, содержащие компоненты, для которых имеется разрешение на изменение. Выберите приложение, а затем нажмите кнопку **Импорт** , чтобы импортировать последнюю опубликованную версию всех компонентов в этом приложении. После импорта по крайней мере одного компонента можно изменить копию и удалить ненужные.

![Диалоговое окно «Импорт компонентов»](./media/create-component/import-component-screen.png)

Вы можете сохранить приложение с существующими компонентами в локальном файле, а затем повторно использовать файл, импортировав его. Файл можно использовать для импорта компонентов в другое приложение.

Если приложение содержит измененную версию того же компонента, вам будет предложено решить, следует ли заменить измененную версию или отменить импорт. 

После создания компонентов в приложении другие приложения могут использовать эти компоненты из этого приложения, импортировав их.

### <a name="export-components-from-your-app"></a>Экспорт компонентов из приложения

Вы можете экспортировать компоненты в файл и скачать их для импорта в другое приложение.

Выберите параметр **экспортировать компоненты** из раздела **компоненты** в представлении слева в дереве навигации:

![Экспорт компонентов TreeView](./media/create-component/export-components-treeview.png)

Можно также использовать меню **Вставка** , а затем выбрать **Настраиваемый** раскрывающийся список.

![Меню вставки компонентов экспорта](./media/create-component/export-components-insert-menu.png)

Выбор **компонентов экспорта** загружает компоненты в файл:

![Скачать компонент](./media/create-component/download-component.png)

Скачанный файл компонента использует расширение имени файла *MSApp* . 

### <a name="import-components-from-exported-components-file"></a>Импорт компонентов из экспортированного файла компонентов

Чтобы импортировать компоненты из экспортированного файла компонентов, выберите **Импорт компонентов** в меню **Вставка** . А затем с помощью **настраиваемого** раскрывающегося списка или **компонентов** в древовидном представлении в левой области навигации. В диалоговом окне Компоненты выберите **Импорт файла** вместо выбора других компонентов или приложений:

![Импорт файла компонента](./media/create-component/import-component-file.png)

В диалоговом окне **Открыть** перейдите к расположению файла компонента и выберите **Открыть** , чтобы импортировать компоненты внутри приложения.

### <a name="import-components-from-exported-app"></a>Импорт компонентов из экспортированного приложения

Приложение можно сохранить локально с помощью команды **файл** -> **Сохранить как** .

![Сохранить приложение](./media/create-component/save-app-locally.png)

После сохранения приложения можно повторно использовать компоненты этого приложения, используя тот же метод импорта компонентов из файла. Выполните действия, описанные в разделе Импорт компонентов из экспортированных компонентов в файл выше.

## <a name="known-limitations"></a>Известные ограничения

- Нельзя сохранять источники данных, формы и таблицы данных с компонентами.
- Коллекции в компонентах не поддерживаются.
- Нельзя вставить компонент в галерею или форму.
- Главный экземпляр компонента — это локальная Главная реплика и область действия приложения. При изменении экземпляра главного класса изменения будут отражены только в копиях компонента в приложении. Копии в других приложениях останутся прежними, если библиотека компонентов не будет импортирована повторно. Все экземпляры Master в этих приложениях будут автоматически обнаружены и обновлены.
- При импорте компонента невозможно упаковать файлы мультимедиа.
- Компоненты не поддерживают функцию [**упдатеконтекст**](./functions/function-updatecontext.md) , но вы можете создавать и обновлять переменные в компоненте с помощью функции [**Set**](functions/function-set.md) . Область этих переменных ограничена компонентом, но к ним можно получить доступ извне компонента с помощью пользовательских свойств вывода.

## <a name="next-steps"></a>Следующие шаги

Ознакомьтесь с [библиотекой компонентов](component-library.md) , чтобы создать репозиторий для многократно используемых компонентов.
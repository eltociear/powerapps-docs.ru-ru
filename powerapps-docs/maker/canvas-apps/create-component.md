---
title: Создание компонента для приложений Canvas | Документация Майкрософт
description: Общие сведения о многократно используемых компонентах для приложений Canvas
author: yifwang
ms.service: powerapps
ms.topic: article
ms.date: 12/12/2018
ms.author: yifwang
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 857ca2c78da5b3a7ced4d4d09dfb335fab02d47c
ms.sourcegitcommit: dd2a8a0362a8e1b64a1dac7b9f98d43da8d0bd87
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2019
ms.locfileid: "74678702"
---
# <a name="create-a-component-for-canvas-apps"></a>Создание компонента для приложений Canvas

> [!IMPORTANT]
> Эта функция по-прежнему является экспериментальной и отключенной по умолчанию. Дополнительные сведения см. в разделе [экспериментальные и предварительные версии функций](working-with-experimental.md).

Компоненты — это многократно используемые стандартные блоки для приложений Canvas, позволяющие создателям приложений создавать пользовательские элементы управления для использования в приложении или в разных приложениях. Дополнительные функции, такие как пользовательские свойства, позволяют включать в компоненты сложные возможности. В этой статье описываются концепции компонентов и некоторые примеры.

Компоненты полезны при создании больших приложений с похожими шаблонами элементов управления. При обновлении определения компонента все экземпляры в приложении будут отражать изменения. Можно также повысить производительность с помощью одного или нескольких компонентов, так как вы не копируете и не вставляете элементы управления, которые дублируют издержки. Компоненты также облегчают совместную разработку и стандартизацию внешнего вида и поведения в Организации.

## <a name="prerequisite"></a>Необходимое условие

Откройте экран **Параметры приложения** , выберите **Дополнительные параметры**и включите функцию, а также убедитесь, что включена **Улучшенная визуализация приложений** .

## <a name="component-canvas"></a>Холст компонентов

Вы можете создать компонент из меню **компоненты** на вкладке **Вставка** или, как показано на следующем рисунке, на левой панели навигации. В этом списке показаны компоненты, определенные в приложении, отсортированные по времени создания.

![Представление списка компонентов](./media/create-component/list-view.png)

Независимо от того, какой подход вы принимаете, отображается пустой холст, в который можно добавить элементы управления как часть определения компонента. При редактировании компонента на холсте экземпляры одного и того же компонента будут обновляться на других экранах приложения и других приложениях.

При выборе экрана можно выбрать компонент из списка существующих компонентов на панели навигации слева или в меню **компоненты** на вкладке **Вставка** . При выборе компонента на экран вставляется экземпляр этого компонента, как и при вставке элемента управления.

## <a name="scope"></a>Область действия

Придумайте компонент как инкапсулированный черный прямоугольник со свойствами в качестве интерфейса. Вы не можете получить доступ к элементам управления в компоненте извне компонента, и вы не можете ссылаться на что-либо за пределы компонента, находящегося внутри компонента. Если вы попробуете, появится сообщение об ошибке. Ограничения области обеспечивают простой и целостный контракт данных компонента, а также позволяют легко обновлять определения компонентов, особенно в приложениях. Контракт данных компонента можно обновить, создав одно или несколько пользовательских свойств.

## <a name="variables"></a>Среды

Компоненты не поддерживают функцию **упдатеконтекст** , но вы можете создавать и обновлять переменные в компоненте с помощью функции **Set** . Область этих переменных ограничена компонентом, но доступ к ним можно получить извне компонента, используя пользовательские свойства вывода.

## <a name="import-and-export"></a>Импорт и экспорт

Чтобы импортировать один или несколько компонентов из одного приложения в другое, выберите **Импорт компонентов** в раскрывающемся списке компонентов. В диалоговом окне перечислены все приложения, содержащие компоненты, для которых имеется разрешение на изменение. Выберите приложение, а затем нажмите кнопку **Импорт** , чтобы импортировать последнюю опубликованную версию всех компонентов в этом приложении. После импорта по крайней мере одного компонента можно изменить копию и удалить ненужные.

> [!div class="mx-imgBorder"]
> ![диалоговое окно "Импорт компонентов"](./media/create-component/import-components.png)

При экспорте компонента создается локальный файл, который можно импортировать в другое приложение. Если приложение содержит измененную версию того же компонента, вам будет предложено решить, следует ли заменить измененную версию или отменить импорт. 

## <a name="custom-properties"></a>Пользовательские свойства

Компонент может принимать входные значения и выдавать данные при создании одного или нескольких пользовательских свойств. Эти сценарии расширены и потребовали понимания формул и привязки контрактов.

Входное свойство — это способ, которым компонент получает данные для использования в компоненте. Входные свойства отображаются на вкладке **Свойства** правой панели, если выбран экземпляр компонента. Можно настроить входные свойства с помощью выражений или формул так же, как стандартные свойства в других элементах управления. Другие элементы управления имеют входные свойства, такие как свойство **по умолчанию** элемента управления **вводом текста** .

Выходные свойства могут выдавать данные или состояние компонента. Например, **выбранное** свойство элемента управления " **коллекция** " является выходным свойством. При создании выходного свойства можно определить, какие другие элементы управления могут ссылаться на состояние компонента.

В этом пошаговом руководстве рассматриваются эти понятия.

## <a name="create-an-example-component"></a>Создание примера компонента

В этом примере вы создадите компонент меню, напоминающий эту график, и в котором можно изменить текст и использовать его на нескольких экранах, приложениях или в обоих окнах:

![Окончательная версия коллекции](./media/create-component/menu-instance.png)

1. В Power Apps Studio создайте пустое приложение.

1. На панели навигации слева откройте список компонентов и выберите пункт **создать компонент**.

    ![Список компонентов](./media/create-component/component-list.png)

1. При наведении указателя мыши на новый компонент нажмите кнопку с многоточием (...), выберите **Переименовать**, а затем введите или вставьте **менукомпонент**.

1. На правой панели установите ширину компонента **150** , а его высоту — **250**, а затем выберите **новое настраиваемое свойство**.

    ![Создать свойство](./media/create-component/new-property.png)

1. В полях **Отображаемое имя**, **имя свойства**и **Описание** введите или вставьте **элементы**.

    ![Отображаемое имя, имя свойства, поля описания](./media/create-component/property-names.png)

    При указании имени свойства не включайте пробелы, так как при написании формулы вы будете обращаться к компоненту по этому имени (например, **ComponentName. PropertyName**).

    Отображаемое имя отображается на вкладке **Свойства** правой панели, если выбран компонент. Описательное отображаемое имя помогает и другим руководителям понять назначение этого свойства. **Описание** отображается в подсказке при наведении указателя мыши на отображаемое имя этого свойства на вкладке **свойства** .

1. В списке **тип данных** выберите **Таблица**, а затем щелкните **создать**.

    ![Тип данных свойства](./media/create-component/property-data-type.png)

    Свойству **Items** присваивается значение по умолчанию, основанное на указанном типе данных, но можно задать значение, соответствующее вашим потребностям. Если указан тип данных **Таблица** или **запись**, может потребоваться изменить значение свойства **Items** в соответствии со схемой данных, которую необходимо ввести в компонент. В этом случае вы измените его на список строк.

    Значение свойства можно задать в строке формул, если выбрать имя свойства на вкладке **Свойства** на правой панели.

    ![Пользовательское свойство ввода на вкладке "Свойства"](./media/create-component/properties-tab.png)

    Как показано на следующем рисунке, можно также изменить значение свойства на вкладке **Дополнительно** панели справа.

1. Задайте для свойства Components ( **элементы** ) значение этой формулы:

    ```powerapps-dot
    Table({Item:"SampleText"})
    ```

    ![Формула](./media/create-component/set-component-items.png)

1. В компоненте Вставьте пустой вертикальный элемент управления " **коллекция** ".

1. Убедитесь, что в списке свойств отображается свойство **Items** (как оно выполняется по умолчанию), а затем установите значение этого свойства в это выражение:

    ```powerapps-dot
    MenuComponent.Items
    ```

    Таким образом, свойство **Items** элемента управления " **коллекция** " считывает и зависит от свойства "входные **элементы** " компонента.

1. Присвойте свойству **BorderThickness** элемента **коллекции** значение **1** , а свойству **темплатесизе** — значение **50**.

1. В шаблоне элемента управления " **коллекция** " добавьте элемент управления " **Метка** ".

    ![Добавить метку и задать границу коллекции](./media/create-component/add-label.png)

Далее предстоит добавить компонент на экран и указать таблицу строк для отображения компонента.

1. На панели навигации слева выберите список экранов, а затем щелкните экран по умолчанию.

    ![Экран по умолчанию](./media/create-component/default-screen.png)

1. На вкладке **Вставка** откройте меню **компоненты** и выберите **менукомпонент**.

    ![Вставляет](./media/create-component/insert.png)

    Новый компонент называется **MenuComponent_1** по умолчанию.

1. Задайте для свойства **Items** **MenuComponent_1** следующую формулу:

    ```powerapps-dot
    Table({Item:"Home"}, {Item:"Admin"}, {Item:"About"}, {Item:"Help"})
    ```

    Этот экземпляр напоминает этот рисунок, но можно настроить текст и другие свойства каждого экземпляра.

    ![Окончательная версия коллекции](./media/create-component/menu-instance.png)

До сих пор вы создали компонент и добавили его в приложение. Далее предстоит создать выходное свойство, отражающее элемент, который пользователь выбирает в меню.

1. Откройте список компонентов и выберите **менукомпонент**.

1. На правой панели перейдите на вкладку **Свойства** и выберите **новое настраиваемое свойство**.

1. В полях **Отображаемое имя**, **имя свойства**и **Описание** введите или вставьте **Выбранные**.

1. В разделе **тип свойства**выберите **выходные данные**, а затем щелкните **создать**.

1. На вкладке **Дополнительно** задайте этому выражению значение **выбранного** свойства, при необходимости изменяя цифру в имени коллекции:

    ```powerapps-dot
    Gallery1.Selected.Item
    ```

    ![Панель "Дополнительно"](./media/create-component/advance.png)

1. На экране приложения по умолчанию добавьте метку и присвойте этому выражению свойство **Text** , при необходимости настроив цифру в имени компонента:

    ```powerapps-dot
    MenuComponent_1.Selected
    ```

    Обратите внимание, что **MenuComponent_1** является именем экземпляра по умолчанию, а не именем определения компонента. Любой экземпляр можно переименовать.

1. Удерживая нажатой клавишу Alt, выберите каждый элемент в меню.

    Элемент управления " **Метка** " отражает пункт меню, который вы выбрали в последнее время.

## <a name="known-limitations"></a>Известные ограничения

- На момент написания этой статьи источники данных не сохраняются вместе с компонентами, поэтому формы и таблицы данных отключаются.
- Power Apps не поддерживает коллекции в компонентах.
- Нельзя вставить компонент в галерею, форму или карточку данных.
- Главный экземпляр компонента — это локальная Главная реплика и область действия приложения. При изменении экземпляра главного класса изменения будут отражены только в копиях компонента в приложении. Копии в других приложениях останутся прежними, если библиотека компонентов не будет импортирована повторно. Все экземпляры Master в этих приложениях будут автоматически обнаружены и обновлены.
- При импорте компонента невозможно упаковать файлы мультимедиа.

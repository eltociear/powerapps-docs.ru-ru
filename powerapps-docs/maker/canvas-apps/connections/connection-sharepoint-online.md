---
title: Общие сведения о подключении к SharePoint | Документация Майкрософт
description: Доступные функции SharePoint, ответы и примеры
author: NickWaggoner
manager: kvivek
ms.service: powerapps
ms.topic: reference
ms.custom: canvas
ms.reviewer: anneta
ms.date: 07/12/2017
ms.author: niwaggon
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 0fbc97e6c2663210bea79cc7236ce784110a4950
ms.sourcegitcommit: c6ad6ba7814c5e7b12c3b7b76bf2e7718bf41b8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2019
ms.locfileid: "58198620"
---
# <a name="connect-to-sharepoint-from-a-canvas-app"></a>Подключение к SharePoint из приложения на основе холста

![SharePoint](./media/connection-sharepoint-online/sharepointicon.png)

Подключение к сайту SharePoint, чтобы автоматически создать приложение из пользовательского списка или создайте подключение, прежде чем добавить данные в существующее приложение или создать приложение с нуля.

- Отображает данные из пользовательского списка на сайте группы SharePoint Online или на локальном сайте.
- Отображение изображений и воспроизведения видео или аудио файлов в библиотеку (SharePoint Online только).

## <a name="generate-an-app"></a>Создание приложения

Если вы хотите управлять данными в пользовательский список, PowerApps можно [автоматически создайте приложение с тремя экранами для вас](../app-from-sharepoint.md). Пользователи могут просмотреть список на первом экране, Показать сведения об элементе на втором экране и создавать или обновлять элементы в третьем экране.

> [!NOTE]
> Если список SharePoint содержит **Выбор**, **подстановки**, или **пользователя или группы,** столбца, см. в разделе [отображение данных в коллекции](connection-sharepoint-online.md#show-data-in-a-gallery) далее в этом разделе.

## <a name="create-a-connection"></a>Создание подключения

1. [Войдите в PowerApps](http://web.powerapps.com?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc)выберите **данных** > **подключений** на левой навигационной панели, а затем выберите **новое подключение** рядом верхнего левого угла.

    > [!div class="mx-imgBorder"]
    > ![Выберите данные > подключения на панели навигации слева и выберите новое соединение в левом верхнем углу.](./media/connection-sharepoint-online/new-connection.png)

1. В поле поиска в правом верхнем углу введите или вставьте **SharePoint**, а затем выберите **SharePoint**.

    > [!div class="mx-imgBorder"]
    > ![В поле поиска в правом верхнем углу введите или вставьте SharePoint и нажмите кнопку SharePoint.](./media/connection-sharepoint-online/select-sharepoint.png)

1. Выполните одно из этих действий.

    - Чтобы подключиться к SharePoint Online, выберите **прямое подключение (облачные службы)** выберите **создать**и затем укажите учетные данные (при появлении соответствующего запроса).

        > [!div class="mx-imgBorder"]
        > ![Чтобы подключиться к SharePoint Online, выберите прямое подключение (облачные службы)](./media/connection-sharepoint-online/select-online.png)

        Подключение было создано, и добавление данных в существующее приложение также можно создать приложение с нуля.

    - Чтобы подключиться к локальным сайтом, выберите **подключиться с помощью локального шлюза данных**.

        > [!div class="mx-imgBorder"]
        > ![Чтобы подключиться к локальным сайтом, выберите ** подключаться с помощью локального шлюза данных)](./media/connection-sharepoint-online/select-onprem.png)

        Выберите параметр **Windows** в качестве типа проверки подлинности, а затем введите учетные данные. (Если учетные данные содержат имя домена, укажите его в формате *домен\псевдоним*.)

        > [!div class="mx-imgBorder"]
        > ![Укажите учетные данные](./media/connection-sharepoint-online/specify-creds.png)

        В разделе **выберите шлюз**, выберите шлюз, который вы хотите использовать, а затем выберите **создать**.

        > [!NOTE]
        > Если у вас нет локального шлюза данных, [установить один](../gateway-reference.md), а затем выберите значок, чтобы обновить список шлюзов.

        > [!div class="mx-imgBorder"]
        > ![Выбор шлюза](./media/connection-sharepoint-online/choose-gateway.png)

        Подключение было создано, и добавление данных в существующее приложение также можно создать приложение с нуля.

## <a name="add-data-to-an-existing-app"></a>Добавление данных в существующее приложение

1. В PowerApps Studio, откройте приложение, которое вы хотите обновить, выберите **представление** , а затем выберите **источников данных**.

    > [!div class="mx-imgBorder"]
    > ![На вкладке "Вид" и затем выберите источники данных](./media/connection-sharepoint-online/view-data-sources.png)

1. В **данных** области выберите **добавить источник данных** > **SharePoint**.

1. В разделе **подключиться к сайту SharePoint**, выберите запись в **последние сайты** списке (или введите или вставьте URL-адрес сайта, который вы хотите использовать), а затем выберите **Connect**.

    > [!div class="mx-imgBorder"]
    > ![Выберите сайт](./media/connection-sharepoint-online/select-sp-site.png)

1. В разделе **выберите список**, установите флажок для **документов** или один или несколько списков, которые вы хотите использовать, а затем выберите **Connect**:

    > [!div class="mx-imgBorder"]
    > ![В списке выберите список установите флажок для документов или один или несколько списков, которые вы хотите использовать, а затем выберите подключение](./media/connection-sharepoint-online/select-sp-tables.png)

    По умолчанию отображаются не все типы списков. PowerApps поддерживает пользовательские списки не на основе шаблона.  Если имя списка, который вы хотите использовать, отсутствует, прокрутите окно вниз, а затем введите имя списка в поле, содержащее текст **Введите название пользовательского списка**.

    > [!div class="mx-imgBorder"]
    > ![Введите имя списка в поле с текстом введите название пользовательского списка.](./media/connection-sharepoint-online/custom-list.png)

    Источником или источниками данных добавляются к приложению.

## <a name="build-your-own-app-from-scratch"></a>Создать свое собственное приложение с нуля

Применить основные понятия в [Создание приложения с нуля](../get-started-create-from-blank.md) в SharePoint, а не к Excel.

## <a name="show-list-columns-in-a-gallery"></a>Отображение списка столбцов в коллекции

Если пользовательский список содержит любой из этих типов столбцов, для демонстрации этих данных в **коллекции** элемента управления с помощью строки формул для установки **текст** свойство из одного или нескольких **метка** элементы управления в этой коллекции.

- Чтобы отобразить данные в столбце **Выбор** и **Подстановка**, укажите значение **ThisItem.[Имя_столбца].Value**.

    Например, если вы используете столбец **Выбор** с именем **Location**, укажите значение **ThisItem.Location.Value**. Если же вы используете столбец **Подстановка** с именем **PostalCode**, укажите значение **ThisItem.PostalCode.Value**.

- Чтобы отобразить имя пользователя или группы, укажите значение **ThisItem.[Имя_столбца].DisplayName** для столбца **Пользователь или группа**.

    Например, укажите значение **ThisItem.Manager.DisplayName**, чтобы отобразить имя из столбца **Пользователь или группа** с именем **Manager**.

    Вы также можете отобразить другие сведения о пользователях, например адрес электронной почты или должность. Чтобы отобразить полный список вариантов, укажите **ThisItem.[Имя_столбца].** (включая точку в конце).

    > [!NOTE]
    > Для **CreatedBy** столбец, укажите **ThisItem.Author.DisplayName** чтобы отобразить имена пользователей, создавших элементы в списке. Для столбца **ModifiedBy** укажите значение **ThisItem.Editor.DisplayName**, чтобы отобразить имена пользователей, изменивших элементы в списке.

- Чтобы отобразить данные в столбце **Управляемые метаданные**, укажите значение **ThisItem.[Имя_столбца].Label**.

    Например, при наличии столбца **Управляемые метаданные** с именем **Languages** укажите значение **ThisItem.Languages.Label**.

## <a name="show-data-from-a-library"></a>Показать данные из библиотеки

Если имеется несколько образов в библиотеке SharePoint, можно добавить **раскрывающийся список** управления в приложение, чтобы пользователи могут указать изображение для отображения. Те же принципы можно также применить к другим элементам управления, такие как **коллекции** элементов управления и других типов данных, таких как видео.

1. Если у вас ее еще [создать подключение](#create-a-connection), а затем [Добавление данных в существующее приложение](#add-data-to-an-existing-app).

1. Добавить **раскрывающийся список** управления и назовите его **ImageList**.

1. Задайте **элементы** свойство **ImageList** для **документов**.

1. На **свойства** вкладке панели справа откройте **значение** , а затем выберите **имя**.

    Имена файлов изображений в библиотеке появятся в **ImageList**.

    > [!div class="mx-imgBorder"]
    > ![Список образов](./media/connection-sharepoint-online/dropdown-items.png)

1. Добавить **изображение** и задать его **изображение** свойство следующее выражение:

    `ImageList.Selected.'Link to item'`

1. Нажмите клавишу F5, а затем выберите другое значение в **ImageList**.

    Появится изображение, которое вы указали.

    > [!div class="mx-imgBorder"]
    > ![Пример изображения](./media/connection-sharepoint-online/golden-honey.png)

Вы можете [скачайте пример приложения](https://pwrappssamples.blob.core.windows.net/samples/spdoclib_blogapp.msapp) для отображения данных из библиотеки SharePoint, который показывает более сложный подход.

1. После загрузки этого приложения, откройте [PowerApps Studio](https://us.create.powerapps.com/studio/#)выберите **откройте** на левой навигационной панели, а затем выберите **Обзор**.
1. В **откройте** » диалогового окна «Найти откройте загруженный файл и затем добавьте библиотеку SharePoint в качестве источника данных с помощью первых двух процедур, описанных в этом разделе.

> [!NOTE]
> По умолчанию это приложение отображает [предупреждения делегирования](../delegation-overview.md), однако их можно игнорировать, если библиотека содержит менее 500 элементов.

В этом приложении одного экрана в левом нижнем углу отобразятся все файлы в библиотеке.

- Файл можно найти, введя или вставив один или несколько символов в поле поиска в верхней.
- Если библиотека содержит папки, можно отфильтровать список файлов, выбрав значок фильтра в списке папок только под строкой заголовка.

Когда вы найдете файл, который требуется, выберите его, чтобы отобразить его в **видео**, **изображение**, или **аудио** управления вдоль правой стороны.

> [!div class="mx-imgBorder"]
> ![Пример изображения](./media/connection-sharepoint-online/library-app.png)

## <a name="known-issues"></a>Известные проблемы

### <a name="lists"></a>Списки

PowerApps могут считывать имена столбцов, содержащие пробелы, но пробелы заменяются шестнадцатеричным escape-код **"\_x0020\_"**. Например, столбец **Имя столбца** из SharePoint будет отображаться как **Имя_x0020_столбца** в PowerApps при отображении в структуре данных или использовании в формуле.

Поддерживаются не все типы столбцов, а не все типы столбцов поддерживают все типы карт.

| Тип столбца | Поддержка | Карточки по умолчанию |
| --- | --- | --- |
| Однострочный текст |Да |Просмотреть текст |
| Многострочный текст |Да |Просмотр текста |
| Выбор |Да |Просмотреть подстановку<br>Изменить подстановку<br>Просмотр полей с множественным выбором<br>Редактирование полей с множественным выбором |
| Номер |Да |Просмотреть процентное значение<br>Просмотреть оценку<br>Просмотр текста |
| Валюта |Да |Просмотреть процентное значение<br>Просмотреть оценку<br>Просмотр текста |
| Дата и время |Да |Просмотр текста |
| "Поиск"; |Да |Просмотреть подстановку<br>Изменить подстановку<br>Просмотр полей с множественным выбором<br>Редактирование полей с множественным выбором |
| Логическое значение (да или нет) |Да |Просмотр текста<br>Просмотреть переключатель |
| "Пользователь" или "Группа"; |Да |Просмотреть подстановку<br>Изменить подстановку<br>Просмотр полей с множественным выбором<br>Редактирование полей с множественным выбором |
| Гиперссылка |Да |Просмотреть URL-адрес<br>Просмотр текста |
| Изображение |Да (только для чтения) |Просмотреть изображение<br>Просмотр текста |
| Вложение |Да (только для чтения) |Просмотр вложений|
| Вычисляемое |Да (только для чтения) | |
| Результат задачи |Нет | |
| Внешние данные |Нет | |
| "Управляемые метаданные". |Да (только для чтения) | |
| Оценка |Нет | |

### <a name="libraries"></a>Библиотеки

- Невозможно отправить файлы из PowerApps в библиотеку.
- Не удается отобразить PDF-файлов из библиотеки в элементе управления средства просмотра PDF.
- PowerApps Mobile не поддерживает **загрузить** функции.
- Если пользователи запустит приложение в PowerApps Mobile или в приложении Windows 10, используйте **запуска** функцию для отображения содержимого библиотеки в коллекции.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [отобразить данные из источника данных](../add-gallery.md).
- Узнайте, как [создать, обновить записи и просмотреть сведения о них](../add-form.md).
- См. другие типы [источников данных](../connections-list.md), к которым можно подключаться.

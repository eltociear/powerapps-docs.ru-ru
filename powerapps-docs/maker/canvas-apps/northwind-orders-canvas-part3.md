---
title: Создание коллекции сведений в приложении Canvas | Документация Майкрософт
description: Создание коллекции сведений в приложении Canvas для управления данными для компании Northwind Traders
author: gregli-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 04/25/2019
ms.author: gregli
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 7a975669d1e22289b7152b830808631992389a1f
ms.sourcegitcommit: 7c1e70e94d75140955518349e6f9130ce3fd094e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "71991610"
---
# <a name="create-a-detail-gallery-in-a-canvas-app"></a>Создание коллекции сведений в приложении Canvas

Выполните пошаговые инструкции, чтобы создать коллекцию сведений в приложении Canvas для управления фиктивными данными в базе данных Northwind Traders. Эта статья является частью серии, в которой объясняется, как создать бизнес-приложение на реляционных данных в Common Data Service. Для получения наилучших результатов изучите следующие разделы в этой последовательности:

1. [Создайте коллекцию заказов](northwind-orders-canvas-part1.md).
1. [Создайте сводную форму](northwind-orders-canvas-part2.md).
1. Создание коллекции сведений (**Этот раздел**).

> [!div class="mx-imgBorder"]
> ![определения областей экрана](media/northwind-orders-canvas-part1/orders-parts.png)

## <a name="prerequisites"></a>Технические условия

Перед началом работы с этим разделом необходимо установить базу данных, как описано выше в этом разделе. Затем необходимо создать коллекцию заказов и форму сводки или открыть приложение **Orders (Canvas) (начало части 3)** , которое уже содержит эту галерею и эту форму.

## <a name="create-another-title-bar"></a>Создать еще одну строку заголовка

1. В верхней части экрана выберите элемент управления [**Label**](controls/control-text-box.md) , который выступает в качестве строки заголовка, скопируйте его, нажав клавиши CTRL + C, а затем вставьте его, нажав клавиши CTRL + V:

    > [!div class="mx-imgBorder"]
    > ![заголовок окна копирования и вставки](media/northwind-orders-canvas-part3/details-01.png)

1. Измените размер копии и переместите ее, чтобы она появилась сразу под формой сводки.

1. Удалите текст из копии одним из следующих способов:

    - Дважды щелкните текст, чтобы выделить его, а затем нажмите клавишу DELETE.
    - Присвойте свойству **Text** метки пустую строку (" **"** ).

    > [!div class="mx-imgBorder"]
    > ![удалить текст из копии строки заголовка](media/northwind-orders-canvas-part3/details-02.png)

## <a name="add-a-gallery"></a>Добавление коллекции

1. Вставить элемент управления " [**Галерея**](controls/control-gallery.md) " с **пустой вертикальной** компоновкой:

    > [!div class="mx-imgBorder"]
    > ![добавить пустую вертикальную коллекцию](media/northwind-orders-canvas-part3/details-03.png)

    Новая коллекция, в которой отображаются сведения о заказах, отображается в левом верхнем углу:

    > [!div class="mx-imgBorder"]
    > ![расположение по умолчанию коллекции "Order-Details"](media/northwind-orders-canvas-part3/details-04.png)

1. Закройте панель **данных** , а затем измените размер и переместите коллекцию сведений в правый нижний угол под новой строкой заголовка:

    > [!div class="mx-imgBorder"]
    > ![конечное расположение коллекции «Order-Details»](media/northwind-orders-canvas-part3/details-05.png)

1. Задайте для свойства **Items** коллекции Details следующую формулу:

    ```powerapps-dot
    Gallery1.Selected.'Order Details'
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство Items коллекции Details](media/northwind-orders-canvas-part3/details-06.png)

    При появлении ошибки убедитесь, что коллекция заказов имеет имя **Gallery1** (на панели **древовидного представления** рядом с левой границей). Если у этой коллекции другое имя, переименуйте ее в **Gallery1**.

    Вы только что связали две галереи. Когда пользователь выбирает заказ в коллекции заказов, этот выбор определяет запись в сущности **Orders** . Если этот заказ содержит один или несколько элементов строк, запись в сущности **Orders** связывается с одной или несколькими записями в сущности « **сведения о заказе** », а данные из этих записей отображаются в коллекции сведений. Это поведение отражает связь «один ко многим», которая была создана между сущностями **Orders** и **Order Details** . Формула, которую вы указали, просматривает это отношение с помощью точечной нотации:

    > [!div class="mx-imgBorder"]
    > ![связь «один ко многим» между сущностью «Заказы» и сущностью «Order Details»](media/northwind-orders-canvas-part3/schema-orders-rel.png)

## <a name="show-product-names"></a>Показывать названия продуктов

1. В коллекции сведений выберите **Добавить элемент на вкладке Вставка** , чтобы выбрать шаблон коллекции:

    > [!div class="mx-imgBorder"]
    > ![выбрать шаблон для коллекции сведений](media/northwind-orders-canvas-part3/details-07.png)

    Убедитесь, что вы выбрали шаблон коллекции, а не саму галерею. Ограничивающий прямоугольник должен быть немного внутри границы коллекции и, скорее всего, короче высоты галереи. При вставке элементов управления в этот шаблон они повторяются для каждого элемента в коллекции.

1. На вкладке **Вставка** вставьте метку в коллекцию сведений.

    Метка должна отображаться в коллекции. Если этого не сделать, повторите попытку, но обязательно выберите шаблон коллекции перед вставкой метки.

    > [!div class="mx-imgBorder"]
    > ![добавить метку в коллекцию сведений](media/northwind-orders-canvas-part3/details-08.png)

1. Задайте для свойства **Text** новой метки следующую формулу:

    ```powerapps-dot
    ThisItem.Product.'Product Name'
    ```

    Если текст не отображается, щелкните стрелку в **заказе 0901** рядом с нижней частью коллекции заказов.

1. Измените размер метки, чтобы появилась полная надпись:

    > [!div class="mx-imgBorder"]
    > ![показывать название продукта в подробных сведениях о заказе](media/northwind-orders-canvas-part3/details-09.png)

    Это выражение проходит из записи в сущности **Order Details** . Запись удерживается в **сиситем** с сущностью **Order Products** через связь «многие к одному»:

    > [!div class="mx-imgBorder"]
    > ![связь «многие к одному» между сущностью «сведения о заказе» и сущностью «заказ продуктов»](media/northwind-orders-canvas-part3/schema-orderdetails-rel.png)

    Извлекаются поля " **Название продукта** " (и другие поля, которые вы будете использовать):

    > [!div class="mx-imgBorder"]
    > ![поля в сущности Order Products](media/northwind-orders-canvas-part3/schema-products-fields.png)

## <a name="show-product-images"></a>Отображение образов продуктов

1. На вкладке **Вставка** вставьте элемент управления [**изображение**](controls/control-image.md) в коллекцию сведений:

    > [!div class="mx-imgBorder"]
    > ![вставить элемент управления изображения](media/northwind-orders-canvas-part3/details-10.png)

1. Измените размер и переместите изображение и метку рядом друг с другом.

    > [!TIP]
    > Чтобы точно контролировать размер и положение элемента управления, Начните изменять его размер или переместить без нажатия клавиши ALT, а затем продолжайте изменять размер или перемещение элемента управления, удерживая нажатой клавишу Alt:

    > [!div class="mx-imgBorder"]
    > ![](media/northwind-orders-canvas-part3/details-11.png) элемента управления "Перемещение изображения"

1. Задайте **для свойства Image образа следующую** формулу:

    ```powerapps-dot
    ThisItem.Product.Picture
    ```

    Опять же, выражение ссылается на продукт, связанный с данным заказом, и извлекает поле **изображения** для отображения.

    > [!div class="mx-imgBorder"]
    > ![отобразить изображение продукта](media/northwind-orders-canvas-part3/details-12.png)

1. Уменьшите высоту шаблона коллекции, чтобы в каждый момент времени появлялось более одной записи **детализации заказа** :

    > [!div class="mx-imgBorder"]
    > ![Сократите шаблон коллекции](media/northwind-orders-canvas-part3/details-13.png)

## <a name="show-product-quantity-and-cost"></a>Показывать количество и стоимость продукта

1. На вкладке **Вставка** Вставьте еще одну метку в коллекцию сведений, а затем измените размер и переместите новую метку справа от сведений о продукте.

1. Задайте для свойства **Text** новой метки следующее выражение:

    ```powerapps-dot
    ThisItem.Quantity
    ```

    Эта формула извлекает сведения непосредственно из сущности **Order Details** (связь не требуется).

    > [!div class="mx-imgBorder"]
    > ![показывать количество продуктов](media/northwind-orders-canvas-part3/details-13b.png) 

1. На вкладке **Главная** измените выравнивание этого элемента управления на **верно**:

    > [!div class="mx-imgBorder"]
    > ![изменить выравнивание](media/northwind-orders-canvas-part3/details-14.png)

1. На вкладке **Вставка** Вставьте еще одну метку в коллекцию сведений, а затем измените размер и переместите метку справа от метки Quantity.

1. Задайте для свойства **Text** новой метки следующую формулу:

    ```powerapps-dot
    Text( ThisItem.'Unit Price', "[$-en-US]$ #,###.00" )
    ```

    Если вы не включили тег Language ( **[$-en-US]** ), он будет добавлен в соответствии с языком и регионом. Если используется другой тег языка, необходимо удалить **$** сразу после закрывающей квадратной скобки ( **]** ), а затем добавить в эту точку собственный символ валюты.

    > [!div class="mx-imgBorder"]
    > ![показывать цену за единицу](media/northwind-orders-canvas-part3/details-15.png)

1. На вкладке **Главная** измените выравнивание этого элемента управления на **верно**:

    > [!div class="mx-imgBorder"]
    > ![изменить выравнивание](media/northwind-orders-canvas-part3/details-16.png)

1. На вкладке **Вставка** Вставьте еще один элемент управления Label в коллекцию сведений, а затем измените размер и переместите новую метку справа от цены за единицу.

1. Задайте для свойства **Text** новой метки следующую формулу:

    ```powerapps-dot
    Text( ThisItem.Quantity * ThisItem.'Unit Price', "[$-en-US]$ #,###.00" )
    ```

    Опять же, если вы не включили тег Language ( **[$-en-US]** ), он будет добавлен в соответствии с языком и регионом. Если тег отличается, вместо **$** сразу после закрывающей квадратной скобки необходимо использовать собственный символ валюты.

    > [!div class="mx-imgBorder"]
    > ![показывать](media/northwind-orders-canvas-part3/details-17.png) расширенной цены

1. На вкладке **Главная** измените выравнивание этого элемента управления на **верно**:

    > [!div class="mx-imgBorder"]
    > ![изменить выравнивание](media/northwind-orders-canvas-part3/details-18.png)

    Добавление элементов управления в галерею сведений теперь завершено.

1. В области **представление в виде дерева** выберите **Screen1** , чтобы не выбирать коллекцию сведений.

## <a name="add-text-to-the-new-title-bar"></a>Добавить текст в новую строку заголовка

1. На вкладке **Вставка** вставьте на экран еще одну метку:

    > [!div class="mx-imgBorder"]
    > ![вставить метку](media/northwind-orders-canvas-part3/details-19.png)

1. Измените размер и переместите новую метку над рисунками продуктов во второй строке заголовка, а затем замените цвет текста на белый на вкладке **Главная** .

1. Дважды щелкните текст метки и введите **Product**:

    > [!div class="mx-imgBorder"]
    > ![изменить текст метки на](media/northwind-orders-canvas-part3/details-20.png) продукта

1. Скопируйте и вставьте метку продукта, а затем измените размер и переместите копию над столбцом количество.

1. Дважды щелкните текст новой метки и введите **Quantity**:

    > [!div class="mx-imgBorder"]
    > ![изменить текст метки на количество](media/northwind-orders-canvas-part3/details-21.png)

1. Скопируйте и вставьте метку Quantity, а затем измените размер и переместите копию над столбцом Unit-Price.

1. Дважды щелкните текст новой метки и введите **Цена за единицу**:

    > [!div class="mx-imgBorder"]
    > ![изменить текст метки на цену единицы](media/northwind-orders-canvas-part3/details-22.png)

1. Скопируйте и вставьте метку единицы измерения, а затем измените размер и переместите копию над столбцом Расширенная цена.

1. Дважды щелкните текст новой метки, а затем введите **Extended**:

    > [!div class="mx-imgBorder"]
    > ![изменить текст метки на расширенный](media/northwind-orders-canvas-part3/details-23.png)

## <a name="display-order-totals"></a>Показать итоги в заказах

1. Уменьшите высоту коллекции сведений, чтобы освободить место для итогов заказа в нижней части экрана:

    > [!div class="mx-imgBorder"]
    > ![укороченная коллекция сведений о заказах](media/northwind-orders-canvas-part3/sum-01.png)

1. Скопируйте и вставьте заголовок окна в середину экрана, а затем переместите копию в нижнюю часть экрана:

    > [!div class="mx-imgBorder"]
    > ![заголовок окна копирования и переместить копию на нижнюю границу](media/northwind-orders-canvas-part3/sum-02.png)

1. Скопируйте и вставьте метку продукта из средней строки заголовка, а затем переместите копию в нижнюю строку заголовка, расположенную слева от столбца **Quantity (количество** ).

1. Дважды щелкните текст новой метки и введите следующий текст:<br>**Итоги заказов:**

    > [!div class="mx-imgBorder"]
    > ![добавить метку для итогов заказа](media/northwind-orders-canvas-part3/sum-03.png)

1. Скопируйте и вставьте метку Order-сумм, а затем измените размер и переместите копию справа от метки Order-сумм.

1. Задайте для свойства **Text** новой метки следующую формулу:

    ```powerapps-dot
    Sum( Gallery1.Selected.'Order Details', Quantity )
    ```

    В этой формуле отображается предупреждение о делегировании, но его можно игнорировать, так как ни один заказ не будет содержать более 500 продуктов.

1. На вкладке **Главная** задайте для параметра выравнивание текста новой метки значение по **правому**краю:

    > [!div class="mx-imgBorder"]
    > ![изменить выравнивание](media/northwind-orders-canvas-part3/sum-04.png)

1. Скопируйте и вставьте этот элемент управления Label, а затем измените размер и переместите копию в **расширенном** столбце.

1. Задайте для свойства **Text** копии следующую формулу:

    ```powerapps-dot
    Text( Sum( Gallery1.Selected.'Order Details', Quantity * 'Unit Price' ), "[$-en-US]$ #,###.00" )
    ```

    В этой формуле отображается предупреждение о делегировании, но его можно игнорировать, так как ни один заказ не будет содержать более 500 продуктов.

    > [!div class="mx-imgBorder"]
    > ![показывать общую стоимость](media/northwind-orders-canvas-part3/sum-05.png) заказов

## <a name="add-space-for-new-details"></a>Добавить пространство для новых сведений

В любой коллекции можно отображать данные, но нельзя обновлять их или добавлять записи. В коллекции сведений вы добавите область, в которой пользователь может настроить запись в сущности **Order Details** , и вставить эту запись в заказ.

1. Уменьшите высоту коллекции сведений, чтобы освободить пространство для редактирования одного элемента в этой коллекции.

    В этом пространстве вы добавите элементы управления, чтобы пользователь мог добавить сведения о заказе:

    > [!div class="mx-imgBorder"]
    > ![сократить коллекцию сведений](media/northwind-orders-canvas-part3/add-details-01.png)

1. На вкладке **Вставка** вставьте метку, а затем измените ее размер и переместите ее в коллекции сведений.

    > [!div class="mx-imgBorder"]
    > ![вставить метку](media/northwind-orders-canvas-part3/add-details-02.png)

1. Дважды щелкните текст новой метки и нажмите клавишу DELETE.

1. На вкладке **Главная** задайте для параметра цвет **заливки** новой метки значение **LightBlue**:

    > [!div class="mx-imgBorder"]
    > ![изменить заливку метки на светло-синий](media/northwind-orders-canvas-part3/add-details-03.png)

## <a name="add-the-order-details-data-source"></a>Добавление источника данных «Order Details»

1. На вкладке **вид** выберите **Источники данных**, а затем в области **данные** выберите **Добавить источник данных** :

    > [!div class="mx-imgBorder"]
    > ![добавить](media/northwind-orders-canvas-part3/add-details-04.png) источника данных

1. Выберите **Common Data Service**:

    > [!div class="mx-imgBorder"]
    > ![выберите Common Data Service](media/northwind-orders-canvas-part3/add-details-05.png)

1. В верхней части панели **данных** введите **Order** в поле поиска, установите флажок **Order Details (сведения о заказе** ), а затем выберите **подключить** в нижней части панели:

    > [!div class="mx-imgBorder"]
    > ![указать сущность «сведения о заказе»](media/northwind-orders-canvas-part3/add-details-06.png)

    Вы только что добавили в приложение еще один источник данных:

    > [!div class="mx-imgBorder"]
    > ![список источников данных](media/northwind-orders-canvas-part3/add-details-07.png)

    Необходимо добавить этот источник данных, так как приложение может выполнять чтение через связь "один ко многим". это приложение еще не может записать изменения обратно. Приложение должно вносить изменения непосредственно в связанную сущность.

1. Закройте панель « **данные** ».

## <a name="select-a-product"></a>Выберите продукт

1. На вкладке **Вставка** выберите **элементы управления** > **поле со списком**:

    > [!div class="mx-imgBorder"]
    > ![вставить поле со списком](media/northwind-orders-canvas-part3/add-details-08.png)

    Элемент управления [ **"поле со списком"** ](controls/control-combo-box.md) отображается в левом верхнем углу.

1. Задайте для свойства **Items** поля со списком следующую формулу:

    ```powerapps-dot
    Choices( 'Order Details'.Product )
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство Items поля со списком](media/northwind-orders-canvas-part3/add-details-09.png)

    Функция [**choice**](functions/function-choices.md) возвращает таблицу со всеми возможными значениями поля **Product** в сущности **Order Details** . Это поле является уточняющим запросом в связи «многие к одному», поэтому **выборка** возвращает все записи в сущности « **заказ товаров** ».

    > [!NOTE]
    > Можно также использовать **варианты** с наборами параметров, чтобы получить таблицу со всеми параметрами. Эти шаги не упоминали этот подход, но вы уже использовали его при добавлении поля со списком, которое показывает **состояние заказа** в форме сводки.

1. На панели **данных** откройте список **основной текст** и выберите **nwind_productname**. 

1. Откройте список **сеарчфиелд** , а затем выберите **nwind_productname**.

    Логическое имя указывается, так как панель **данных** пока не поддерживает отображаемые имена в этом случае:

    > [!div class="mx-imgBorder"]
    > ![задать основной текст для поля со списком](media/northwind-orders-canvas-part3/add-details-10.png)

1. Закройте панель « **данные** ».

1. На вкладке **Свойства** , расположенной рядом с правой границей, прокрутите вниз, отключите **параметр Разрешить множественный выбор**и убедитесь, что включен режим **поиска разрешить** .

    > [!div class="mx-imgBorder"]
    > ![отключить множественный выбор и включить поиск](media/northwind-orders-canvas-part3/add-details-12.png)

1. Измените размер поля со списком и переместите его в область светло-синий, непосредственно под столбцом имя продукта в коллекции сведений:

    > [!div class="mx-imgBorder"]
    > поле со списком ![перемещения](media/northwind-orders-canvas-part3/add-details-13.png)

    В этом поле со списком пользователь будет указывать запись в сущности **Product** для записи **сведений о заказе** , которую будет создавать приложение.

1. Удерживая нажатой клавишу Alt, выберите стрелку вниз в поле со списком.

    > [!TIP]
    > Удерживая нажатой клавишу Alt, можно взаимодействовать с элементами управления в PowerApps Studio без открытия режима предварительного просмотра.

1. В появившемся списке продуктов выберите продукт:

    > [!div class="mx-imgBorder"]
    > ![выберите продукт в поле со списком](media/northwind-orders-canvas-part3/add-details-14.png)

## <a name="add-a-product-image"></a>Добавление образа продукта

1. На вкладке **Вставка** выберите **носитель**  > **изображение**:

    > [!div class="mx-imgBorder"]
    > ![вставить элемент управления изображения](media/northwind-orders-canvas-part3/add-details-15.png)

    Элемент управления " [**изображение**](controls/control-image.md) " отображается в левом верхнем углу:

    > [!div class="mx-imgBorder"]
    > ![расположение по умолчанию для элемента управления Image](media/northwind-orders-canvas-part3/add-details-16.png)

1. Изменить размер и переместить изображение в область светло-синий под другими образами продукта и рядом с полем со списком.

1. Задайте для свойства **Image** образа значение:

    ```powerapps-dot
    ComboBox1.Selected.Picture
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство Image](media/northwind-orders-canvas-part3/add-details-17.png)

    Вы используете тот же прием, что и для отображения изображения сотрудника в форме сводки. **Выбранное** свойство поля со списком возвращает всю запись выбранного пользователем продукта, включая поле **рисунка** .

## <a name="add-a-quantity-box"></a>Добавить поле "количество"

1. На вкладке **Вставка** выберите **текст** > **Ввод текста**:

    > [!div class="mx-imgBorder"]
    > ![добавить поле ввода текста](media/northwind-orders-canvas-part3/add-details-18.png)

    Элемент управления [**Ввод текста**](controls/control-text-input.md) отображается в левом верхнем углу:

    > [!div class="mx-imgBorder"]
    > ![расположение по умолчанию текстового поля ввода](media/northwind-orders-canvas-part3/add-details-19.png)

1. Изменить размер и переместить текстовое поле ввода справа от поля со списком в столбце Количество в коллекции сведений:

    > [!div class="mx-imgBorder"]
    > ![изменить размер и переместить поле ввода текста](media/northwind-orders-canvas-part3/add-details-20.png)

    Используя это поле ввода текста, пользователь укажет поле **Quantity** в записи **сведения о заказе** .

1. Задайте для свойства этого элемента управления **по умолчанию** значение **""** :

    > [!div class="mx-imgBorder"]
    > ![задать свойство * * Default * * текстового поля ввода](media/northwind-orders-canvas-part3/add-details-21.png)

1. На вкладке **Главная** задайте для параметра выравнивание текста этого элемента управления значение **верно**:

    > [!div class="mx-imgBorder"]
    > ![изменить выравнивание](media/northwind-orders-canvas-part3/add-details-22.png)

## <a name="show-the-unit-and-extended-prices"></a>Отображение единиц измерения и расширенных цен

1. На вкладке **Вставка** вставьте элемент управления **Метка** .

    Метка отображается в левом верхнем углу экрана:

    > [!div class="mx-imgBorder"]
    > ![вставить метку](media/northwind-orders-canvas-part3/add-details-23.png)

1. Измените размер и переместите метку справа от элемента управления вводом текста и задайте в качестве значения свойства **Text** метки следующую формулу:

    ```powerapps-dot
    Text( ComboBox1.Selected.'List Price', "[$-en-US]$ #,###.00" )
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство Text метки](media/northwind-orders-canvas-part3/add-details-24.png)

    Этот элемент управления показывает **цену по прейскуранту** из сущности **Order Products** . Это значение определит поле **Цена за единицу** в записи **сведений о заказе** .

    > [!NOTE]
    > В этом сценарии значение доступно только для чтения, но в других сценариях пользователь приложения может изменить его. В этом случае используйте элемент управления **Text input** и задайте для его свойства **по умолчанию** значение **List Price**.

1. На вкладке **Главная** Установите выравнивание текста в метке List-Price по **правому**краю:

    > [!div class="mx-imgBorder"]
    > ![изменить выравнивание](media/northwind-orders-canvas-part3/add-details-25.png)

1. Скопируйте и вставьте метку List-Price, а затем измените размер и переместите копию справа от метки List-Price.

1. Задайте для свойства **Text** новой метки следующую формулу:

    ```powerapps-dot
    Text( Value(TextInput1.Text) * ComboBox1.Selected.'List Price', "[$-en-US]$ #,###.00" )
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство Text новой метки](media/northwind-orders-canvas-part3/add-details-27.png)

    В этом элементе управления отображается расширенная цена на основе количества, указанного пользователем приложения, и прейскурантной стоимости продукта, выбранного пользователем приложения. Это исключительно информационный характер для пользователя приложения.

1. Дважды щелкните элемент управления вводом текста для поля Количество, а затем введите число.

    Метка **Расширенная** Цена пересчитывается для отображения нового значения:

    > [!div class="mx-imgBorder"]
    > ![указать количество и отобразить расширенную цену](media/northwind-orders-canvas-part3/add-details-28.png)

## <a name="add-an-add-icon"></a>Добавить значок добавления

1. На вкладке **Вставка** выберите **значки** > **добавить**:

    > [!div class="mx-imgBorder"]
    > ![добавить значок](media/northwind-orders-canvas-part3/add-details-29.png)

    Значок отображается в левом верхнем углу экрана.

    > [!div class="mx-imgBorder"]
    > ![расположение по умолчанию для значка добавления](media/northwind-orders-canvas-part3/add-details-30.png)

1. Измените размер и переместите этот значок на правой границе светло-синей области, а затем присвойте свойству **OnSelect** значка следующую формулу:

    ```powerapps-dot
    Patch( 'Order Details',
        Defaults('Order Details'),
        {
            Order: Gallery1.Selected,
            Product: ComboBox1.Selected,
            Quantity: Value(TextInput1.Text),
            'Unit Price': ComboBox1.Selected.'List Price'
        }
    );
    Refresh( Orders );
    Reset( ComboBox1 );
    Reset( TextInput1 )
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство "Свойства" для значка](media/northwind-orders-canvas-part3/add-details-31.png)

    В общем случае функция [**Patch**](functions/function-patch.md) обновляет и создает записи, а конкретные аргументы в этой формуле определяют точные изменения, которые будут внесены функцией.

    - Первый аргумент указывает источник данных (в данном случае сущность **Order Details** ), в котором функция будет обновляться, или создать запись.
    - Второй аргумент указывает, что функция будет создавать запись со значениями по умолчанию для сущности « **Order Details** », если иное не указано в третьем аргументе.
    - Третий аргумент указывает, что четыре столбца в новой записи будут содержать значения от пользователя.

      - В столбце **порядок** будет содержаться номер заказа, выбранного пользователем в коллекции заказов.
      - Столбец **Product (продукт** ) будет содержать имя продукта, выбранного пользователем в поле со списком, в котором отображаются продукты.
      - Столбец **Quantity** будет содержать значение, указанное пользователем в поле ввода текста.
      - В столбце **Цена единицы** будет содержаться прейскурантная цена продукта, выбранная пользователем для сведений о заказе.

    > [!NOTE]
    > Можно создавать формулы, использующие данные из любого столбца (в сущности « **заказ товаров** ») для любого продукта, выбранного пользователем в поле со списком, в котором отображаются продукты. Когда пользователь выбирает запись в сущности « **заказ продуктов** », не только название продукта отображается в этом поле со списком, но и в метке отображается цена за единицу продукта. Каждое значение поиска в приложении Canvas ссылается на всю запись, а не только на первичный ключ.

    Функция **Refresh** гарантирует, что сущность **Orders** будет соответствовать записи, только что добавленной в сущность **Order Details** . Функция **Reset** очищает данные о продуктах, объеме и единицах измерения, чтобы пользователь мог легко создавать другие сведения о заказе для того же заказа.

1. Нажмите клавишу F5, а затем щелкните значок **Добавить** .

    Порядок отражает указанные сведения.

    > [!div class="mx-imgBorder"]
    > ![анимации добавления сведений о заказе](media/northwind-orders-canvas-part3/add-details.gif)

1. используемых Добавьте в заказ еще один элемент.

1. Нажмите клавишу ESC, чтобы закрыть режим просмотра.

## <a name="remove-an-order-detail"></a>Удаление сведений о заказе

1. В центре экрана выберите шаблон коллекции сведений:

    > [!div class="mx-imgBorder"]
    > ![выбрать шаблон коллекции](media/northwind-orders-canvas-part3/remove-details-01.png)

1. На вкладке **Вставка** выберите **значки** > **Корзина**:

    > [!div class="mx-imgBorder"]
    > ![вставить значок корзины](media/northwind-orders-canvas-part3/remove-details-02.png)

    Значок корзины отображается в левом верхнем углу шаблона коллекции.

    > [!div class="mx-imgBorder"]
    > ![расположение по умолчанию](media/northwind-orders-canvas-part3/remove-details-03.png) значка

1. Измените размер и переместите значок корзины на правую сторону шаблона коллекции подробных сведений и задайте в качестве значения свойства " **OnSelect** " этой формулы:

    ```powerapps-dot
    Remove( 'Order Details', ThisItem ); Refresh( Orders )
    ```

    > [!div class="mx-imgBorder"]
    > ![задать свойство "Свойства" для значка](media/northwind-orders-canvas-part3/remove-details-04.png)

    На момент написания этой статьи нельзя удалить запись непосредственно из связи, поэтому функция [**Remove**](functions/function-remove-removeif.md) удаляет запись непосредственно из связанной сущности. **Сиситем** указывает удаляемую запись, взятую из той же записи в коллекции сведений, где отображается значок корзины.

    Опять же, операция использует кэшированные данные, поэтому функция **Refresh** информирует сущность **Orders** о том, что приложение изменило одну из связанных сущностей.

1. Нажмите клавишу F5, чтобы открыть режим предварительного просмотра, а затем щелкните значок корзины рядом с каждой записью **о заказе** , которую необходимо удалить из заказа.

1. Попробуйте добавить и удалить различные сведения о заказе из заказов:

    > [!div class="mx-imgBorder"]
    > ![анимации добавления и удаления сведений о заказе](media/northwind-orders-canvas-part3/remove-details.gif)

## <a name="in-conclusion"></a>В заключение

Итак, вы добавили еще одну галерею для отображения сведений о заказе и элементы управления, добавляя и удаляющие сведения о заказе в приложении. Вы использовали следующие элементы:

- Второй элемент управления "Коллекция", связанный с коллекцией заказов через связь "один ко многим": **Gallery2. Items** = `Gallery1.Selected.'Order Details'`
- Связь «многие к одному» из сущности « **сведения о заказе** » в сущность « **заказ товаров** »: `ThisItem.Product.'Product Name'` и `ThisItem.Product.Picture`
- Функция **выбора** для получения списка продуктов: `Choices( 'Order Details'.Product' )`
- **Выбранное** свойство поля со списком в качестве полной связанной записи "многие к одному": `ComboBox1.Selected.Picture` и `ComboBox1.Selected.'List Price'`
- Функция **Patch** для создания записи **сведений о заказе** : `Patch( 'Order Details', Defaults( 'Order Details' ), ... )`
- Функция **Remove** для удаления записи **сведений о заказе** : `Remove( 'Order Details', ThisItem )`

В этой серии разделов было кратко пошаговое руководство по использованию отношений Common Data Service и наборов параметров в приложении Canvas в целях обучения. Перед выпуском любого приложения в рабочей среде следует учитывать проверку полей, обработку ошибок и многие другие факторы.

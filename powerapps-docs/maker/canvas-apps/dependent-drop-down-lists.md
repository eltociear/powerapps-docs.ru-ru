---
title: Создание зависимого раскрывающегося списка в приложении Canvas | Документация Майкрософт
description: В Power Apps создайте раскрывающийся список, который фильтрует другой раскрывающийся список в приложении Canvas.
author: emcoope-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 04/04/2019
ms.author: emcoope
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 233fd99eeba86151f616a22955cf28c2114de43e
ms.sourcegitcommit: dd2a8a0362a8e1b64a1dac7b9f98d43da8d0bd87
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2019
ms.locfileid: "74679622"
---
# <a name="create-dependent-drop-down-lists-in-a-canvas-app"></a>Создание зависимых раскрывающихся списков в приложении Canvas

При создании зависимых раскрывающихся списков (или каскадных) пользователи могут выбрать параметр в списке, чтобы отфильтровать параметры в другом списке. Многие организации создают зависимые списки, чтобы помочь пользователям более эффективно заполнять формы. Например, пользователи могут выбрать страну или регион для фильтрации списка городов, или пользователи могут выбрать категорию для отображения только кодов в этой категории.

Рекомендуется создать источник данных для значений в списках "родительский объект" и "дочерний" (например, в странах или регионах и городах), которые отделены от источника данных, который пользователи обновляют с помощью приложения. При таком подходе можно использовать одни и те же родительские и дочерние данные в нескольких приложениях. Эти данные можно обновить без повторной публикации приложения или приложений, которые их используют. Тот же результат можно выполнить с помощью коллекции или статических данных, но не рекомендуется для корпоративных сценариев.

В этом разделе сотрудники хранят проблемы в списке **инцидентов** с помощью формы. Сотрудники указывают не только расположение магазина, в котором был создан инцидент, но и отдел в этом месте. Не все расположения имеют одни и те же отделы, поэтому список **расположений** гарантирует, что сотрудники не смогут указать отдел для местоположения, у которого нет этого отдела.

В этом разделе используются списки Microsoft SharePoint в качестве источников данных, но все табличные источники данных работают одинаково.

## <a name="create-data-sources"></a>Создание источников данных

В списке **расположений** представлены подразделения в каждом расположении.

| Location | Department |
|----------------|------------------|
| еганвилле      | Кондитерской           |
| еганвилле      | Гастронома             |
| еганвилле      | Производить          |
| ренфрев        | Кондитерской           |
| ренфрев        | Гастронома             |
| ренфрев        | Производить          |
| ренфрев        | Фармацевтической         |
| ренфрев        | Цветочно-           |
| пемброке       | Кондитерской           |
| пемброке       | Гастронома             |
| пемброке       | Производить          |
| пемброке       | Цветочно-           |

В списке **инцидентов** отображаются контактные данные и сведения о каждом инциденте. Создайте столбец Date в качестве столбца **дат** , но создайте другие столбцы в виде **одной строки текстовых** столбцов, чтобы упростить настройку и избежать предупреждений о [делегировании](./delegation-overview.md) в Microsoft PowerApps.

| Имя | Фамилия | Номер телефона     | Location | Department | Description       | Date      |
|------------|-----------|------------------|----------------|------------|-------------------------|-----------|
| тоня       | Cortez   | (206) 555-1022 | еганвилле      | Производить    | У меня возникла проблема...   | 2/12/2019 |
| мосес     | лафламме     | (425) 555-1044 | ренфрев        | Цветочно-     | Возникла ошибка... | 2/13/2019 |

По умолчанию настраиваемые списки SharePoint содержат столбец **Title** , который нельзя переименовать или удалить, и он должен содержать данные, прежде чем можно будет сохранить элемент в списке. Чтобы настроить столбец так, чтобы он не требовал данных:

1. В правом верхнем углу щелкните значок шестеренки, а затем выберите **Параметры списка**.
1. На странице **Параметры** в списке столбцов выберите **заголовок** .
1. В разделе **требовать, чтобы в этом столбце содержатся сведения**, выберите **нет**.

После этого изменения можно проигнорировать столбец **Title** или [удалить его](https://support.office.com/article/edit-a-list-column-in-sharepoint-online-77130c2e-76d1-4f80-af8b-4c6f47b264b8) из представления по умолчанию, если отображается хотя бы один другой столбец.

## <a name="open-the-form"></a>Откройте форму

1. Откройте список **инциденты** и выберите **PowerApps** > **настроить формы**.

    > [!div class="mx-imgBorder"]
    > ![Откройте список инциденты и выберите Power Apps > настроить формы.](./media/dependent-drop-down-lists/open-form.png "Откройте список инциденты и выберите Power Apps > настроить формы.")

    Откроется вкладка браузер с формой по умолчанию в Power Apps Studio.

1. используемых В области **поля** наведите указатель мыши на поле **Title (заголовок** ), выберите отображаемое многоточие (...) и нажмите кнопку **Удалить**.

    Если панель **поля** была закрыта, можно открыть ее снова, выбрав **SharePointForm1** на левой панели навигации, а затем выбрав **изменить поля** на вкладке **Свойства** на правой панели.

1. используемых Повторите предыдущий шаг, чтобы удалить поле **вложения** из формы.

    Откроется форма с только что добавленными полями.

    > [!div class="mx-imgBorder"]
    > ![форма без полей "заголовок" и "вложения"](./media/dependent-drop-down-lists/default-form.png)

## <a name="replace-the-controls"></a>Замена элементов управления

1. В области **поля** щелкните стрелку рядом с пунктом **Расположение**.

    Если панель **поля** была закрыта, можно открыть ее снова, выбрав **SharePointForm1** на левой панели навигации, а затем выбрав **изменить поля** на вкладке **Свойства** на правой панели.

1. Откройте список **тип элемента управления** и выберите **Допустимые значения**.

    > [!div class="mx-imgBorder"]
    > ![допустимые значения](./media/dependent-drop-down-lists/change-control.png)

    Механизм ввода меняется на **раскрывающийся** элемент управления.

1. Повторите эти действия для карточки **отдела** .

## <a name="add-the-locations-list"></a>Добавление списка расположений

1. Выберите **просмотреть** > **Источники данных** > **Добавить источник данных**.

1. Выберите или создайте подключение SharePoint, а затем укажите сайт, содержащий список **расположений** .

1. Установите флажок для этого списка и нажмите кнопку **подключить**.

    > [!div class="mx-imgBorder"]
    > ![область данных](./media/dependent-drop-down-lists/select-list.png)

    В списке подключений отображается список **инцидентов** , на котором основана форма, и список **расположения** , который определяет расположения и отделы в форме.

    > [!div class="mx-imgBorder"]
    > ![источники данных SharePoint](./media/dependent-drop-down-lists/data-sources.png)

## <a name="unlock-the-cards"></a>Разблокируйте карты

1. Выберите карточку **Расположение** , выберите вкладку **Дополнительно** на правой панели, а затем нажмите кнопку **разблокировать, чтобы изменить свойства**.

1. Повторите предыдущий шаг для карточки **отдела** .

## <a name="rename-the-controls"></a>Переименование элементов управления

При переименовании элементов управления их можно легко обозначить, а примеры проще отслеживать. Чтобы узнать о других рекомендациях, ознакомьтесь с документацией по [стандартам и правилам кодирования](https://aka.ms/powerappscanvasguidelines).

1. В карточке **Расположение** выберите **раскрывающийся список** .

1. В верхней части правой панели переименуйте выбранный элемент управления, введя или вставляя **ддлокатион**.

    > [!div class="mx-imgBorder"]
    > ![переименования элемента управления](./media/dependent-drop-down-lists/rename-control.png)

1. Повторите предыдущие два шага в карточке **отдела** , чтобы переименовать элемент управления **раскрывающегося** списка на **дддепартмент**.

## <a name="configure-the-locations"></a>Настройка расположений

1. Задайте для свойства **Items** элемента **ддлокатион** следующую формулу:

    `Distinct(Locations, Location)`

1. используемых Удерживая нажатой клавишу Alt, откройте **ддлокатион**и убедитесь, что в списке показаны три расположения.

## <a name="configure-the-departments"></a>Настройка отделов

1. Выберите **дддепартмент**, а затем на вкладке **Свойства** правой панели выберите **зависит от.**

1. В разделе **родительский элемент управления**убедитесь, что **ддлокатион** отображается в верхнем списке, и **результат** появится в нижнем списке.

    > [!NOTE]
    > Если вы не хотите сопоставлять строку, а фактически идентификатор строки данных, выберите **идентификатор** , а не **результат**.

1. В разделе **сопоставление поля**выберите **расположения** в верхнем списке, выберите **Расположение** в нижнем списке и нажмите кнопку **Применить**.

    > [!div class="mx-imgBorder"]
    > ![зависит от](./media/dependent-drop-down-lists/depends-on.png) ссылок

    Для свойства **Items** объекта **дддепартмент** задана следующая формула:

    `Filter(Locations, Location = ddLocation.Selected.Result)`

    Эта формула фильтрует элементы в **дддепартмент** в зависимости от того, что пользователь выбирает в **ддлокатион**. Такая конфигурация гарантирует, что "дочерний" список отделов будет отражать данные для своего "родительского" расположения, так как в списке **расположений** в SharePoint указано.

1. На вкладке **Свойства** правой панели откройте список рядом с пунктом **значение**и выберите **Отдел**.

    Этот шаг задает отображаемый текст для параметров из столбца **Department** в списке **Locations (расположения** ) в SharePoint.

    > [!div class="mx-imgBorder"]
    > ![](./media/dependent-drop-down-lists/dept-value.png) значение отдела

## <a name="test-the-form"></a>Тестирование формы

Удерживая нажатой клавишу Alt, откройте список расположений, выберите один из них, откройте список отделов, а затем выберите один из них.

Списки расположений и отделов отражают информацию в списке **расположений** в SharePoint.

> [!div class="mx-imgBorder"]
> ![открыть список расположений, измените выбор с Ренфрев на Пемброке, а затем откройте список отделов](./media/dependent-drop-down-lists/dropdowns.gif)

## <a name="save-and-open-the-form-optional"></a>Сохранение и открытие формы (необязательно)

1. Откройте меню **файл** и выберите **сохранить** > **опубликовать в SharePoint** > **опубликовать в SharePoint**.

1. В левом верхнем углу нажмите на стрелку "Назад" и выберите **Вернуться в SharePoint**.

1. На панели команд выберите **Создать**, чтобы открыть настроенную форму.

## <a name="faq"></a>Вопросы и ответы

**Данные не отображаются: все источники пусты или имеют неверные данные.**
Проверьте, отображается ли нужное поле для элемента управления одним из следующих способов:

- Выберите раскрывающийся список, а затем выберите свойство **значение** на вкладке **свойства** правой панели.

    > [!div class="mx-imgBorder"]
    > раскрывающийся список ![изменить](./media/dependent-drop-down-lists/drop-down-display-field.png)

- Выберите поле со списком и убедитесь, что основной текст является полем, которое необходимо отобразить.

    > [!div class="mx-imgBorder"]
    > ![изменить поле со списком](./media/dependent-drop-down-lists/combo-box-display-field.png)

**В раскрывающемся списке "мой ребенок" содержатся дублирующиеся элементы.**
Вероятно, эта проблема связана с использованием столбца **подстановки** в SharePoint или функции **выбора** в Power Apps. Чтобы удалить дублирование, заключите **функцию, которая будет правильно** возвращать данные. Дополнительные сведения: [DISTINCT Function](functions/function-distinct.md).

## <a name="known-limitations"></a>Известные ограничения

Эта конфигурация доступна в **раскрывающихся** элементах управления, а также в **поле со списком** и элементах управления **"список"** , которые позволяют выбрать один из них за раз. Нельзя использовать **зависимость от** конфигурации для любого из этих элементов управления, если они позволяют выбрать несколько вариантов. Этот подход не рекомендуется для работы с наборами параметров в Common Data Service.

**Зависимость от** конфигурации не поддерживает статические данные или коллекции. Чтобы настроить зависимые раскрывающиеся списки с этими источниками, измените выражение непосредственно в строке формул. Кроме того, Power Apps не поддерживает использование двух полей выбора в SharePoint без соответствующей таблицы данных, и вы не можете определить **соответствующее поле** в этом пользовательском интерфейсе.

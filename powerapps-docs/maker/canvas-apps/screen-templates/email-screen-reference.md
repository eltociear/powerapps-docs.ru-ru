---
title: Справочник по шаблону экрана электронной почты для приложений Canvas | Документация Майкрософт
description: Сведения о том, как шаблон экрана электронной почты для приложений Canvas работает в PowerApps
author: emcoope-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 12/31/2018
ms.author: emcoope
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 7226433c5e95537346841f2e2f9474ea68e42dda
ms.sourcegitcommit: dd2a8a0362a8e1b64a1dac7b9f98d43da8d0bd87
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2019
ms.locfileid: "74675091"
ms.PowerAppsDecimalTransform: true
---
# <a name="reference-information-about-the-email-screen-template-for-canvas-apps"></a>Справочные сведения о шаблоне экрана электронной почты для приложений Canvas

Для приложений Canvas в Power Apps необходимо понять, как каждый важный элемент управления в шаблоне на экране электронной почты влияет на общую функциональность экрана по умолчанию. Этот подробный обзор содержит формулы поведения и значения других свойств, определяющих реакцию элементов управления на вводимые пользователем данные. Подробное описание функциональных возможностей этого экрана по умолчанию см. в [обзоре электронной почты](email-screen-overview.md).

В этом разделе описываются некоторые важные элементы управления и объясняются выражения или формулы, в которых задаются различные свойства (например, **элементы** и **OnSelect**) этих элементов управления.

* [Поле поиска текста](#text-search-box)
* [Добавить значок](#add-icon)
* [Галерея просмотра людей](#people-browse-gallery)
* [Коллекция людей по электронной почте](#email-people-gallery) (+ дочерние элементы управления)
* [Значок почты](#mail-icon)

## <a name="prerequisite"></a>Необходимое условие

Знакомство с добавлением и настройкой экранов и других элементов управления при [создании приложения в PowerApps](../data-platform-create-app-scratch.md).

## <a name="text-search-box"></a>Текстовое поле поиска

   ![Элемент управления Текстсеарчбокс](media/email-screen/email-search-box.png)

Некоторые другие элементы управления на экране имеют зависимость от элемента управления **"текстовое поле поиска"** :

* Если пользователь начинает вводить текст, появляется **пеоплебровсегаллери** .
* Если пользователь вводит допустимый адрес электронной почты, **аддикон** отображается.
* Когда пользователь выбирает пользователя в **пеоплебровсегаллери**, содержимое поиска сбрасывается.

## <a name="add-icon"></a>Значок добавления

   ![Элемент управления Аддикон](media/email-screen/email-add-icon.png)

Элемент управления " **Добавление значка** " позволяет пользователям приложений добавлять пользователей, которые не существуют в Организации, в список получателей создаваемого сообщения электронной почты.

* Свойство: **Visible**<br>
    Значение: логика для отображения элемента управления, только если пользователь вводит в поле поиска допустимый адрес электронной почты:

    ```powerapps-comma
    !IsBlank( TextSearchBox.Text ) &&
        IsMatch( TextSearchBox.Text; Match.Email ) &&
        Not( Trim( TextSearchBox.Text ) in MyPeople.UserPrincipalName )
    ```
  Построчно, приведенный выше блок кода говорит о том, что элемент управления " **Добавление значка** " будет виден только в том случае, если:

    * **Текстсеарчбокс** содержит текст.
    * Текст в **текстсеарчбокс** является допустимым адресом электронной почты.
    * Текст в **текстсеарчбокс** еще не существует в коллекции **мипеопле** .

* Свойство: **OnSelect**<br>
    Значение: при выборе этого параметра в коллекцию **мипеопле** добавляется допустимый адрес электронной почты. Эта коллекция используется на экране в качестве списка получателей:

    ```powerapps-comma
    Collect( MyPeople;
        { 
            DisplayName: TextSearchBox.Text; 
            UserPrincipalName: TextSearchBox.Text; 
            Mail: TextSearchBox.Text
        }
    );;
    Reset( TextSearchBox )
    ```
  
  Этот блок кода добавляет строку в коллекцию **мипеопле** и заполняет три поля текстом в **текстсеарчбокс**. Эти три поля — **DisplayName**, **userPrincipalName**и **mail**. Затем он сбрасывает содержимое **текстсеарчбокс**.

## <a name="people-browse-gallery"></a>Галерея просмотра людей

   ![Элемент управления Пеоплебровсегаллери](media/email-screen/email-browse-gall.png)

* Свойство: **элементы**<br>
    Значение: 15 лучших результатов поиска искомого текста, введенного в элемент управления **текстсеарчбокс** :
    
    ```powerapps-comma
    If( !IsBlank( Trim(TextSearchBox.Text ) ); 
        'Office365Users'.SearchUser( {searchTerm: Trim( TextSearchBox.Text ); top: 15} )
    )
    ```

  Элементы этой коллекции заполняются результатами поиска из операции [Office 365. сеарчусер](https://docs.microsoft.com/connectors/office365users/#searchuser) . Операция принимает текст в `Trim(TextSearchBox)` в качестве условия поиска и возвращает 15 лучших результатов, основанных на этом поиске.
  
  **Текстсеарчбокс** заключен в функцию `Trim()`, так как поиск пользователя в пробелах является недопустимым. Операция `Office365Users.SearchUser` упаковывается в функцию `If(!IsBlank(Trim(TextSearchBox.Text)) ... )`, что означает, что операция выполняется только в том случае, если поле поиска содержит текст, указанный пользователем. Это повышает производительность. 

### <a name="people-browse-gallery-title-control"></a>Элемент управления заголовка коллекции людей

   ![Элемент управления "заголовок Пеоплебровсегаллери"](media/email-screen/email-browse-gall-title.png)

* Свойство: **текст**<br>
    Значение: `ThisItem.DisplayName`

  Отображает отображаемое имя пользователя из профиля Office 365.

* Свойство: **OnSelect**<br>
    Значение: код для добавления пользователя в коллекцию уровня приложения, а затем выберите пользователя:

    ```powerapps-comma
    Concurrent(
        Set( _selectedUser; ThisItem );
        Reset( TextSearchBox );
        If( Not( ThisItem.UserPrincipalName in MyPeople.UserPrincipalName ); 
            Collect( MyPeople; ThisItem )
        )
    )
    ```
Выбор этого элемента управления делает три вещи одновременно:

   * Задает **_selectedUserую** переменную для выбранного элемента.
   * Сбрасывает условие поиска в **текстсеарчбокс**.
   * Добавляет выбранный элемент в коллекцию **мипеопле** , коллекцию всех выбранных пользователей, которые экран электронной почты использует в качестве набора получателей.

## <a name="email-people-gallery"></a>Коллекция людей электронной почты

   ![Элемент управления Емаилпеоплегаллери](media/email-screen/email-people-gall.png)

* Свойство: **элементы**<br>
    Значение: `MyPeople`

  Это коллекция пользователей, инициализированных или добавленных в, путем выбора элемента управления **заголовка пеоплебровсегаллери** .

* Свойство: **Высота**<br>
    Значение: логика для задания высоты в зависимости от числа элементов в коллекции.

    ```powerapps-comma
    Min( 
        ( EmailPeopleGallery.TemplateHeight + EmailPeopleGallery.TemplatePadding * 2) *
            RoundUp(CountRows(EmailPeopleGallery.AllItems) / 2; 0 );
        304
    )
    ```

  Высота этой коллекции корректируется на число элементов в коллекции с максимальной высотой 304.
  
  Она занимает `TemplateHeight + TemplatePadding * 2` как общая высота одной строки **емаилпеоплегаллери**, а затем умножает ее на число строк. С момента `WrapCount = 2`число истинных строк равно `RoundUp(CountRows(EmailPeopleGallery.AllItems) / 2; 0)`.

* Свойство: **шовскроллбар**<br>
    Значение: `EmailPeopleGallery.Height >= 304`
  
  Когда высота коллекции достигает 304, отображается полоса прокрутки.

### <a name="email-people-gallery-title-control"></a>Элемент управления "заголовок коллекции лиц электронной почты"

   ![Элемент управления "заголовок Емаилпеоплегаллери"](media/email-screen/email-people-gall-text.png)

* Свойство: **OnSelect**<br>
    Значение: `Set(_selectedUser; ThisItem)`

  Задает **_selectedUser** переменную для элемента, выбранного в **емаилпеоплегаллери**.

### <a name="email-people-gallery-iconremove-control"></a>Элемент управления Иконремове коллекции пользователей электронной почты

   ![Элемент управления "заголовок Монсдайгаллери"](media/email-screen/email-people-gall-delete.png)

* Свойство: **OnSelect**<br>
    Значение: `Remove( MyPeople; LookUp( MyPeople; UserPrincipalName = ThisItem.UserPrincipalName ) )`

  Выполняет поиск записи в коллекции **мипеопле** , где **userPrincipalName** соответствует **userPrincipalName** выбранного элемента, и удаляет эту запись из коллекции.

## <a name="mail-icon"></a>Значок почты

* Свойство: **OnSelect**<br>
    Значение: логика для отправки сообщения электронной почты пользователя:

    ```powerapps-comma
    Set( _emailRecipientString; Concat( MyPeople; Mail & ";" ) );;
    'Office365'.SendEmail( _emailRecipientString; 
        TextEmailSubject.Text;  
        TextEmailMessage.Text; 
        { Importance:"Normal" }
    );;
    Reset( TextEmailSubject );;
    Reset( TextEmailMessage );;
    Clear( MyPeople )
    ```

  Для отправки сообщения электронной почты требуется строка адресов электронной почты, разделенная точкой с запятой. В приведенном выше коде:
  1. Первая строка кода принимает поле « **почта** » из всех строк в коллекции **мипеопле** , объединяет их в одну строку адресов электронной почты, разделенных точкой с запятой, и присваивает переменной **_emailRecipientString** значение этого строкового значения.

  1. Затем он использует операцию [Office 365. SendEmail](https://docs.microsoft.com/connectors/office365/#sendemail) , чтобы отправить сообщение получателям по электронной почте.
    Операция имеет три обязательных **параметра:,** , **subject**и **Body**, а также один необязательный параметр —**важность**. В приведенном выше коде это **_emailRecipientString**, **текстемаилсубжект**. Текст, **текстемаилмессаже**. Текст и **обычные**соответственно.
  1. Наконец, он сбрасывает элементы управления **текстемаилсубжект** и **текстемаилмессаже** и очищает коллекцию **мипеопле** .

* Свойство: **DisplayMode**<br>
    Значение: `If( Len( Trim( TextEmailSubject.Text ) ) > 0 && !IsEmpty( MyPeople ); DisplayMode.Edit; DisplayMode.Disabled )` для отправки сообщения электронной почты строка темы электронной почты должна содержать текст, а коллекция получателей (**мипеопле**) не должна быть пустой.

## <a name="next-steps"></a>Дальнейшие действия

* [Дополнительные сведения об этом экране](./email-screen-overview.md)
* [Дополнительные сведения о соединителе Office 365 Outlook в PowerApps](../connections/connection-office365-outlook.md)
* [Дополнительные сведения о соединителе пользователей Office 365 в PowerApps](../connections/connection-office365-users.md)

---
title: Шаблон экрана электронной почты | Документация Майкрософт
description: Узнайте, как работает шаблон экрана электронной почты для приложений Canvas, и расширьте экран на предмет собственных вариантов использования.
author: emcoope-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 12/29/2018
ms.author: emcoope
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 861d343e653a78af685a1e0cb82deb5b2ad59591
ms.sourcegitcommit: 6b27eae6dd8a53f224a8dc7d0aa00e334d6fed15
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2019
ms.locfileid: "74732571"
---
# <a name="overview-of-the-email-screen-template-for-canvas-apps"></a>Обзор шаблона экрана электронной почты для приложений Canvas

В приложении Canvas добавьте экран электронной почты, позволяющий пользователям отправлять сообщения электронной почты из своей учетной записи Office 365 Outlook. Пользователи могут искать получателей в Организации и добавлять внешние адреса электронной почты. Можно добавить поддержку вложения изображений, изменить данные пользователя, отображаемые в коллекции поиска, и внести другие изменения.

Можно также добавить другие экраны на основе шаблонов, которые показывают различные данные из Office 365, такие как [Календарь](calendar-screen-overview.md)пользователя, [Пользователи](people-screen-overview.md) в Организации, а также [доступность](meeting-screen-overview.md) пользователей, которым пользователи могут пригласить на встречу.

В этом обзоре описывается:
> [!div class="checklist"]
> * Использование экрана электронной почты по умолчанию.
> * Как изменить его.
> * Как интегрировать его в приложение.

Более подробные сведения о функциональных возможностях этого экрана по умолчанию см. в [справочнике по электронной почте](email-screen-reference.md).

## <a name="prerequisite"></a>Необходимое условие

Знакомство с добавлением и настройкой экранов и других элементов управления при [создании приложения в Power Apps](../data-platform-create-app-scratch.md).

## <a name="default-functionality"></a>Функциональные возможности по умолчанию

Чтобы добавить экран электронной почты из шаблона, выполните следующие действия.

1. [Войдите](https://make.powerapps.com?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc) в Power Apps, а затем создайте приложение или откройте существующее приложение в Power Apps Studio.

    В этом разделе показано приложение для телефона, но те же принципы применимы к планшетному приложению.

1. На вкладке ленты **Главная** выберите **создать экран** > **электронной почте**.

    По умолчанию экран выглядит примерно так:

    ![Экран электронной почты](media/email-screen/email-screen-full.png)

Некоторые полезные Примечания:

* Чтобы найти пользователей в Организации, начните вводить свое имя в поле ввода текста ниже "до".
* При поиске людей будут возвращены только первые 15 результатов.
* Чтобы добавить адреса электронной почты для получателей электронной почты за пределами Организации, введите полный, допустимый адрес электронной почты и щелкните значок "+", расположенный справа от него.
* Необходимо добавить хотя бы одного пользователя в качестве получателя и предоставить тему для отправки сообщения электронной почты.
* После отправки сообщения электронной почты содержимое строки темы и текста сообщения, а также список получателей будут удалены.

## <a name="modify-the-screen"></a>Изменение экрана

Функциональные возможности по умолчанию этого экрана можно изменить несколькими распространенными способами.

* [Добавление поддержки вложения изображений](email-screen-overview.md#add-image-attachment-support)
* [Отображение различных данных для людей](email-screen-overview.md#show-different-data-for-people)

Если вы хотите изменить экран еще дальше, используйте ссылку на [экран электронной почты](./email-screen-reference.md) в качестве рекомендации.

> [!IMPORTANT]
> В следующих шагах предполагается, что вы добавили в приложение только один экран электронной почты. Если добавлено более одного имени элемента управления (например, **iconMail1**), оно будет заканчиваться другим числом, и необходимо соответствующим образом скорректировать формулы.

### <a name="add-image-attachment-support"></a>Добавление поддержки вложения изображений

Это позволяет пользователям отправлять один образ со своим сообщением электронной почты в качестве вложения.

1. На вкладке **Вставка** выберите **носитель**, а затем щелкните **Добавить рисунок**.
1. Задайте для свойства **Y** нового элемента управления следующее выражение:

    `TextEmailMessage1.Y + TextEmailMessage1.Height + 20`
    
1. После вставки элемента управления **аддмедиависимаже** установите его высоту меньше 210.
1. В представлении дерева элементов управления выберите **аддмедиависимаже** >  **...**  > **изменить порядок** > **отправить на задний план**.
   Это предотвращает появление элемента управления перед элементом управления **пеоплебровсегаллери** .
1. Измените свойство **Height** объекта **емаилпеоплегаллери** на следующую формулу:

    ```powerapps-dot
    Min( 
        ( EmailPeopleGallery1.TemplateHeight + EmailPeopleGallery1.TemplatePadding * 2 ) *
            RoundUp( CountRows( EmailPeopleGallery1.AllItems ) / 2, 0 ), 
        304
    )
    ```

1. Задайте для свойства **шовскроллбар** объекта **емаилпеоплегаллери** следующее выражение:

    ```EmailPeopleGallery1.Height >= 304```
    
    Это не даст максимальной высоты от принудительной отправки элемента управления **аддмедиависимаже** за пределы страницы.
    
1. Измените свойство **OnSelect** элемента управления **иконмаил** на следующую формулу:

    ```powerapps-dot
    Set( _emailRecipientString, Concat(MyPeople, Mail & ";") );
    If( IsBlank( UploadedImage1 ),
        'Office365'.SendEmail( _emailRecipientString, 
            TextEmailSubject1.Text, 
            TextEmailMessage1.Text, 
            { Importance: "Normal" }
        ),
        'Office365'.SendEmail( _emailRecipientString, 
            TextEmailSubject1.Text, 
            TextEmailMessage1.Text, 
            {
                Importance: "Normal",
                Attachments: Table(
                    {
                        Name: "Image.jpg", 
                        ContentBytes: UploadedImage1.Image
                    }
                )
            }
        )
    );
    Reset( TextEmailSubject1 );
    Reset( TextEmailMessage1 );
    Reset( AddMediaButton1 );
    Clear( MyPeople )
    ```
    
    Эта формула проверяет наличие отправленного изображения. Если нет, то используется та же операция `Office365.SendEmail`, что и раньше. Если имеется изображение, оно добавляется в качестве вложения в таблицу вложений.
    После отправки электронного сообщения в **аддмедиабуттон** выполняется дополнительная операция **сброса** для удаления отправленного изображения.
> [!NOTE]
> Чтобы добавить в сообщение несколько вложений, добавьте записи в таблицу вложений.

### <a name="show-different-data-for-people"></a>Отображение различных данных для людей

На этом экране для поиска пользователей в организации используется операция [Office365Users. сеарчусер](https://docs.microsoft.com/connectors/office365users/#searchuser) . Он предоставляет дополнительные поля для каждого события, помимо того, что отображается в элементе управления **пеоплебровсегаллери** . Добавление или изменение полей в коллекции выполняется просто:

1. В элементе управления **пеоплебровсегаллери** выберите изменяемую метку (или добавьте ее и не заключайте).

1. Выбрав свойство **Text** , в строке формул замените содержимое на `ThisItem.`

    IntelliSense отображает список полей, которые можно выбрать.

1. Выберите нужное поле.

    Свойство **Text** обновляется на `ThisItem.{FieldSelection}`.

## <a name="integrate-the-screen-into-an-app"></a>Интеграция экрана в приложение

Экран электронной почты — это мощный набор элементов управления, который обычно работает как часть более крупного, более универсального приложения. Этот экран можно интегрировать в крупное приложение несколькими способами, включая [ссылку на экран календаря](email-screen-overview.md#linking-to-the-calendar-screen).

### <a name="linking-to-the-calendar-screen"></a>Связывание с экраном календаря

Выполните действия, описанные в разделе "показывать участников события" окна " [Обзор" календаря](./calendar-screen-overview.md#show-event-attendees) , но на последнем шаге Задайте функцию **навигации** , чтобы открыть экран электронной почты. После выполнения этих действий коллекция **мипеопле** заполняется, что позволяет пользователям отправлять электронную почту пользователям, получившим выбранное событие.

> [!NOTE]
> При отправке этого электронного письма будет отправлено отдельное сообщение электронной почты от фактического события в Outlook.

## <a name="next-steps"></a>Дальнейшие действия

* [Просмотрите справочную документацию по этому экрану](./email-screen-reference.md).
* Дополнительные [сведения о соединителе пользователей Office 365 в Power Apps](../connections/connection-office365-users.md).
* [Просмотрите все доступные подключения в Power Apps](../connections-list.md).
---
title: Функции AddColumns, DropColumns, RenameColumns и ShowColumns | Документация Майкрософт
description: Справочные сведения о функциях AddColumns, DropColumns, RenameColumns и ShowColumns в PowerApps с описанием синтаксиса и примерами
author: gregli-msft
manager: kvivek
ms.service: powerapps
ms.topic: reference
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 04/04/2019
ms.author: gregli
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 55e38d2be5f43e1b13fc1894f88aac26a26bd57e
ms.sourcegitcommit: dd2a8a0362a8e1b64a1dac7b9f98d43da8d0bd87
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2019
ms.locfileid: "74678219"
---
# <a name="addcolumns-dropcolumns-renamecolumns-and-showcolumns-functions-in-powerapps"></a>Функции AddColumns, DropColumns, RenameColumns и ShowColumns в Microsoft PowerApps
Изменение формата [таблицы](../working-with-tables.md) путем добавления, удаления, переименования и выбора ее [столбцов](../working-with-tables.md#columns).

## <a name="overview"></a>Обзор
С помощью этих функций вы можете изменить таблицу и настройки ее столбцов.

* Сократите до одного столбца таблицу, состоящую из нескольких столбцов, чтобы использовать ее в функции, принимающей один столбец, например **[Lower](function-lower-upper-proper.md)** или **[Abs](function-numericals.md)** .  
* Добавьте в таблицу вычисляемый столбец (например, столбец **Общая цена** с результатами умножения значений из столбцов **Количество** и **Цена за единицу**).
* Переименуйте столбец, чтобы его имя было более понятным в представлениях для пользователей или в формулах.

Таблица — это значение в Power Apps, как строка или число.  Таблицы можно использовать в качестве аргумента формулы, и функции могут возвращать таблицу.

> [!NOTE]
> Функции, описанные в этом разделе, не изменяют исходную таблицу. Вместо этого они принимают эту таблицу в качестве аргумента и возвращают новую таблицу с примененным преобразованием. Подробнее это описано [здесь](../working-with-tables.md).  

Вы не можете с помощью этих функций изменять столбцы [источника данных](../working-with-data-sources.md). Такие данные следует изменять прямо в источнике данных. Вы можете добавить столбцы к [коллекции](../working-with-data-sources.md#collections) с помощью функции **[Collect](function-clear-collect-clearcollect.md)** . Подробнее это описано [здесь](../working-with-data-sources.md).  

## <a name="description"></a>Description
Функция **AddColumns** добавляет столбец к таблице и с помощью формулы определяет значения для этого столбца. Существующие столбцы сохраняются без изменений.

Формула вычисляется отдельно для каждой записи этой таблицы.
[!INCLUDE [record-scope](../../../includes/record-scope.md)]

Функция **DropColumns** исключает столбцы из таблицы.  Все остальные столбцы сохраняются без изменений. **DropColumns** исключает столбцы, а **ShowColumns** включает новые столбцы.

С помощью функции **RenameColumns** можно переименовать один или несколько столбцов таблицы. Для этого необходимо предоставить хотя бы одну пару аргументов, которая определяет имя столбца, содержащегося в таблице (старое имя столбца, которое требуется заменить), и имя столбца, отсутствующего в таблице (новое имя столбца, которое требуется использовать). Столбец со старым именем должен присутствовать в таблице, а столбца с новым именем в ней не должно быть. Имя каждого столбца может использоваться в списке аргументов только один раз в качестве либо старого, либо нового имени столбца. Если необходимо присвоить столбцу имя существующего столбца, сначала необходимо удалить существующий столбец с помощью команды **DropColumns** или переименовать его с использованием функции **RenameColumns**, вложенной в другую.

Функция **ShowColumns** включает в результат указанные столбцы таблицы и удаляет все остальные. Функцию **ShowColumns** можно использовать для выделения одного столбца из таблицы с несколькими столбцами.  **ShowColumns** включает столбцы, а **DropColumns** исключает столбцы.  

Все эти функции возвращают новую таблицу, к которой применено соответствующее преобразование. Исходная таблица сохраняется без изменений. Невозможно изменить существующую таблицу с помощью формулы. SharePoint, Common Data Service, SQL Server и другие источники данных предоставляют средства для изменения столбцов списков, сущностей и таблиц, которые часто называются схемами. Функции в этом разделе преобразуют входную таблицу, не изменяя ее оригинал, в выходную таблицу для дальнейшего использования.

Аргументы этих функций поддерживают делегирование. Например, функция **фильтра** , используемая в качестве аргумента для получения связанных записей, выполняет поиск по всем вхождениям, даже если **"[dbo]. [ Алллистингс] "** источник данных содержит миллион строк:

```powerapps-dot
AddColumns( RealEstateAgents, 
    "Listings",  
    Filter(  '[dbo].[AllListings]', ListingAgentName = AgentName ) 
)
```

Однако выходные данные этих функций подвергаются [ограничению записи без делегирования](../delegation-overview.md#non-delegable-limits).  В этом примере возвращаются только 500 записей, даже если источник данных **реалестатеажентс** имеет 501 или более записей.

При использовании **AddColumns** таким образом **Фильтр** должен выполнять отдельные вызовы к источнику данных для каждой из первых записей в **реалестатеажентс**, что приводит к большому числу сетевых chatter. If **[dbo]. [ Алллистингс]** достаточно мал и не изменяется часто, можно вызвать функцию " **получить** " в [**OnStart**](signals.md#app) для кэширования источника данных в приложении при запуске. В качестве альтернативы можно изменить структуру приложения, чтобы извлечь связанные записи, только когда пользователь запросит их.  

## <a name="syntax"></a>Синтаксис
**AddColumns**( *Table*, *ColumnName1*, *Formula1* [, *ColumnName2*, *Formula2*, ... ] )

* *Table* — обязательный аргумент.  Таблица, с которой выполняются операции.
* *ColumnName* — обязательный аргумент. Имена столбцов для добавления.  Этот аргумент принимает строку (например, **"Name"** в двойных кавычках).
* *Formula(s)* — обязательный параметр.  Формула или формулы, вычисляемые для каждой записи таблицы. Результат добавляется в итоговую таблицу как значение соответствующего нового столбца. Вы можете использовать в этой формуле ссылки на другие столбцы таблицы.

**DropColumns**( *Table*, *ColumnName1* [, *ColumnName2*, ... ] )

* *Table* — обязательный аргумент.  Таблица, с которой выполняются операции.
* *ColumnName* — обязательный аргумент. Имена столбцов для исключения. Этот аргумент принимает строку (например, **"Name"** в двойных кавычках).

**RenameColumns**( *Table*, *OldColumnName1*, *NewColumnName1* [, *OldColumnName2*, *NewColumnName2*,...])

* *Table* — обязательный аргумент.  Таблица, с которой выполняются операции.
* *OldColumnName* — обязательный аргумент. Имя столбца исходной таблицы, который требуется переименовать. Этот элемент отображается первым в паре аргументов (или первым в каждой из пар, если формула содержит несколько пар). Этот аргумент принимает строку (например, **"Name"** в двойных кавычках).
* *NewColumnName* — обязательный аргумент. Имя, которое нужно использовать вместо старого. Этот элемент отображается последним в паре аргументов (или последним в каждой из пар, если формула содержит несколько пар). Этот аргумент принимает строку (например, **"Customer Name"** в двойных кавычках).

**ShowColumns**( *Table*, *ColumnName1* [, *ColumnName2*, ... ] )

* *Table* — обязательный аргумент.  Таблица, с которой выполняются операции.
* *ColumnName* — обязательный аргумент. Имена столбцов для включения. Этот аргумент принимает строку (например, **"Name"** в двойных кавычках).

## <a name="examples"></a>Примеры
В следующих примерах мы будем использовать источник данных **IceCreamSales**, который содержит данные в такой таблице:

![](media/function-table-shaping/icecream.png)

Ни один из этих примеров не изменяет исходную таблицу источника данных **IceCreamSales**. Каждая функция преобразует ее в новую таблицу и возвращает полученную таблицу в результате.

| Формула | Description | Возвращаемый результат |
| --- | --- | --- |
| **AddColumns( IceCreamSales, "Revenue", UnitPrice * QuantitySold )** |Добавляет к результату столбец **Revenue**.  Для каждой записи вычисляется выражение **UnitPrice * QuantitySold**. Результат вычисления помещается в новый столбец. |<style> img { max-width: none; } </style> ![](media/function-table-shaping/icecream-add-revenue.png) |
| **DropColumns( IceCreamSales, "UnitPrice" )** |Исключает из результата столбец **UnitPrice**. Эта функция позволяет исключить столбцы, а **ShowColumns** включает их. |![](media/function-table-shaping/icecream-drop-price.png) |
| **ShowColumns( IceCreamSales, "Flavor" )** |Включает в результат только столбец **Flavor**. Эта функция позволяет включить столбцы, а **DropColumns** исключает их. |![](media/function-table-shaping/icecream-select-flavor.png) |
| **RenameColumns( IceCreamSales, "UnitPrice", "Price")** |Переименовывает столбец **UnitPrice** в результате. |![](media/function-table-shaping/icecream-rename-price.png) |
| **RenameColumns( IceCreamSales, "UnitPrice", "Price", "QuantitySold", "Number")** |Переименовывает столбцы **UnitPrice** и **QuantitySold**. |![](media/function-table-shaping/icecream-rename-price-quant.png) |
| **DropColumns(<br>RenameColumns(<br>AddColumns( IceCreamSales, "Revenue",<br>UnitPrice * QuantitySold ),<br>"UnitPrice", "Price" ),<br>"Quantity" )** |Поочередно выполняет следующие преобразования, начиная с "внутренней стороны" формулы. <ol><li>Добавляет столбец **Revenue** заполняемый данными по формуле **UnitPrice * Quantity**.<li>Переименовывает столбец **UnitPrice** в **Price**.<li>Исключает столбец **Quantity**.</ol>  Обратите внимание, что порядок выполнения имеет значение. Например, мы не сможем вычислить **UnitPrice** после того, как переименуем его. |![](media/function-table-shaping/icecream-all-transforms.png) |

### <a name="step-by-step"></a>Шаг за шагом

Давайте попробуем некоторые из примеров, приведенных ранее в этом разделе.  

1. Создайте коллекцию, добавив элемент управления **[Button](../controls/control-button.md)** и задав для его свойства **OnSelect** следующую формулу:

    ```powerapps-dot
    ClearCollect( IceCreamSales, 
        Table(
            { Flavor: "Strawberry", UnitPrice: 1.99, QuantitySold: 20 }, 
            { Flavor: "Chocolate", UnitPrice: 2.99, QuantitySold: 45 },
            { Flavor: "Vanilla", UnitPrice: 1.50, QuantitySold: 35 }
        )
    )
    ```

1. Запустите формулу, нажав кнопку, удерживая клавишу ALT.

1. Добавьте второй элемент управления **Button** , установите для этой формулы свойство **OnSelect** , а затем выполните его:

    ```powerapps-dot
    ClearCollect( FirstExample, 
        AddColumns( IceCreamSales, "Revenue", UnitPrice * QuantitySold )
    ) 
    ```
1. В меню **файл** выберите **коллекции**, а затем выберите **ицекреамсалес** , чтобы отобразить эту коллекцию.
 
    Как показано на рисунке, вторая формула не изменила эту коллекцию. Функция **AddColumns** , используемая **ицекреамсалес** в качестве аргумента только для чтения; функция не изменила таблицу, к которой относится этот аргумент.
    
    ![Средство просмотра коллекций, отображающее три записи сбора данных о продажах, которые не включают столбец доходов](media/function-table-shaping/ice-cream-sales-collection.png)

1. Выберите **фирстексампле**.

    Как показано на рисунке, вторая формула возвращает новую таблицу с добавленным столбцом. Функция **клеарколлект** записала новую таблицу в коллекции **фирстексампле** , добавляя что-то в исходную таблицу в том виде, в котором она передается через функцию, без изменения источника:

    ![Средство просмотра коллекций, отображающее три записи первой коллекции примеров, включающие новый столбец доходов](media/function-table-shaping/first-example-collection.png)

---
title: Просмотр журналов ошибок портала и их сохранение в хранилище BLOB-объектов Azure | MicrosoftDocs
description: Узнайте, как просматривать журналы ошибок портала и сохранять их в учетной записи хранилища BLOB-объектов Azure.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 10/07/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: 0b8482108be50c07c229d2c283391d96624e6884
ms.sourcegitcommit: 5338e01d2591f76d71f09b1fb229d405657a0c1c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2019
ms.locfileid: "72977273"
---
# <a name="view-portal-error-logs"></a>Просмотр журналов ошибок портала

Администратор или разработчик портала может использовать порталы PowerApps для создания веб-сайта для клиентов. Одной из распространенных задач для разработчиков является Отладка проблем при разработке портала. Чтобы упростить отладку, можно получить доступ к подробным журналам ошибок для любых проблем на портале. Существует несколько способов получения журналов ошибок для порталов.

## <a name="custom-error"></a>Настраиваемая ошибка

Если на портале возникает исключение на стороне сервера, по умолчанию отображается настроенная страница ошибки с понятным пользователем сообщением об ошибке. Сведения о настройке сообщения об ошибке см. в разделе [Отображение настраиваемого сообщения об ошибке](#display-a-custom-error-message).

Однако лучше увидеть страницу подробных ошибок ASP.NET, также известную как желтый экран смерти (ИСОД), для целей отладки. Страница подробных сведений об ошибках позволяет получить полный стек ошибок сервера.

> [!div class=mx-imgBorder]
> ![Желтый экран с](../media/ysod.png "желтым экраном") смерти

Чтобы включить ИСОД, необходимо [Отключить настраиваемые ошибки](#disable-custom-error) на портале.

> [!NOTE]
> Рекомендуется отключать пользовательские ошибки только на этапе разработки и включать пользовательские ошибки, когда вы переходите в активное окно.

Дополнительные сведения о пользовательской ошибке: [Отображение настраиваемой страницы ошибки](https://docs.microsoft.com/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/displaying-a-custom-error-page-cs)

### <a name="disable-custom-error"></a>Отключить настраиваемую ошибку

Вы можете отключить настраиваемые ошибки на порталах, чтобы отобразить подробное сообщение об исключении, если на портале возникло исключение на стороне сервера.

1. Откройте [центр администрирования порталов PowerApps](admin-overview.md).

2. Перейдите к **действиям портала** > **Отключить пользовательские ошибки**.

   > [!div class=mx-imgBorder]
   > ![Отключить настраиваемую ошибку](../media/disable-custom-errors.png "отключить настраиваемую ошибку")

3. В сообщении с подтверждением выберите **Отключить** . В то время как пользовательские ошибки отключены, портал перезапускается и будет недоступен. При отключении пользовательских ошибок появляется сообщение.

### <a name="enable-custom-error"></a>Включить настраиваемую ошибку

Можно включить настраиваемые ошибки на порталах, чтобы отображалась профессионально оформленная страница, а не ИСОД. Эта страница предоставляет осмысленные сведения, если в приложении возникает какое-либо исключение.

1. Откройте [центр администрирования порталов PowerApps](admin-overview.md).

2. Перейдите к **действиям портала** > **включить пользовательские ошибки**.

   > [!div class=mx-imgBorder]
   > ![Включить пользовательское сообщение об ошибке](../media/enable-custom-errors.png "включить пользовательскую ошибку")

3. Выберите **включить** в сообщении с подтверждением. При включении пользовательских ошибок портал перезапускается и будет недоступен. При включении пользовательских ошибок появляется сообщение.

> [!NOTE]
> - При изменении экземпляра, к которому подключен портал, параметр настраиваемые ошибки имеет значение Enabled (включено). При необходимости необходимо снова отключить пользовательские ошибки.
> - При изменении экземпляра, к которому подключен портал, не следует включать и отключать пользовательские ошибки; в противном случае появляется сообщение об ошибке.

### <a name="display-a-custom-error-message"></a>Отображение настраиваемого сообщения об ошибке

На портале можно настроить отображение специальной настраиваемой ошибки вместо универсальной ошибки.

Чтобы определить пользовательскую ошибку, используйте фрагмент содержимого `Portal Generic Error`. Содержимое, определенное в этом фрагменте кода, отображается на странице ошибки. Этот фрагмент содержимого недоступен в готовых ящиках, и его необходимо создать. **Типом** фрагмента содержимого может быть **Text** или **HTML**. Чтобы создать или изменить фрагмент содержимого, см. раздел [Настройка содержимого с помощью фрагментов содержимого](https://docs.microsoft.com/dynamics365/customer-engagement/portals/customize-content-snippets).

> [!NOTE]
> Если код ликвидности записан в фрагменте содержимого, он будет пропущен и не отобразится.

При включении настраиваемых ошибок сообщение отображается в следующей структуре на странице ошибки:

<Content Snippet> 
<Error ID >
<Date and time>
<Portal ID>

Ниже приведен пример настраиваемого сообщения об ошибке с помощью фрагмента содержимого типа HTML:

Это пользовательская ошибка. Отправьте запрос в службу поддержки с помощью снимка экрана ошибки, щелкнув здесь

> [!div class=mx-imgBorder]
> ![](../media/custom-error-message.png "Настраиваемое") сообщение об ошибке

> [!NOTE]
> Если порталу не удается получить фрагмент содержимого, так как он не может подключиться к Common Data Service или если фрагмент недоступен в Common Data Service, появится сообщение об ошибке.

## <a name="access-portal-error-logs"></a>Журналы ошибок на портале доступа

После разработки и публикации портала необходимо иметь возможность доступа к журналам портала для отладки проблем, о которых сообщили ваши клиенты. Чтобы получить доступ к журналам, можно настроить портал для отправки всех ошибок приложений в учетную запись хранилища BLOB-объектов Azure, которой вы владеете. Доступ к журналам ошибок портала позволяет эффективно реагировать на запросы клиентов, так как у вас есть подробные сведения о ней. Чтобы получить журналы ошибок портала в хранилище BLOB-объектов Azure, необходимо включить ведение журнала диагностики из центра администрирования порталов PowerApps.

> [!NOTE]
> При изменении экземпляра Common Data Service, к которому подключен портал, ведение журнала диагностики отключено. Необходимо снова включить ведение журнала диагностики.

### <a name="enable-diagnostic-logging"></a>Включить ведение журнала диагностики

1. Откройте [центр администрирования порталов PowerApps](admin-overview.md).

2. Перейдите к **действиям портала** > **включить ведение журнала диагностики**.

   > [!div class=mx-imgBorder]
   > ![Включение ведения журнала диагностики](../media/enable-diagnostic-logging.png "Включение ведения журнала диагностики")

3. В окне **включить ведение журнала диагностики** введите следующие значения:

   - **Строка подключения службы хранилища больших двоичных объектов Azure**: URL-адрес службы хранилища больших двоичных объектов Azure для хранения журналов ошибок портала. Максимальная длина URL-адреса составляет 2048 символов. Если длина URL-адреса превышает 2048 символов, выводится сообщение об ошибке. Дополнительные сведения о строке подключения: [Настройка строк подключения службы хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-configure-connection-string)
   - **Выберите срок хранения**: длительность для хранения журналов ошибок портала в хранилище BLOB-объектов. Журналы ошибок удаляются по истечении выбранного времени. Можно выбрать одно из следующих значений:
     - 1 день
     - 7 дней
     - 30 дней
     - 60 дней
     - 90 дней
     - 180 дней
     - Постоянно

   По умолчанию срок хранения составляет 30 дней.
  
   > [!div class=mx-imgBorder]
   > ![Включить окно ведения журнала диагностики](../media/enable-diagnostic-logging-window.png "включить окно ведения журнала диагностики")

4. Нажмите кнопку **настроить**.

После настройки ведения журнала диагностики в учетной записи хранения Azure создается новый контейнер больших двоичных объектов **журналов телеметрии** , и журналы записываются в файлы больших двоичных объектов, хранящиеся в контейнере. На следующем снимке экрана показан контейнер больших двоичных объектов **журналов телеметрии** в обозревателе службы хранилища Azure.

> [!div class=mx-imgBorder]
> Учетная запись хранения блога ![Azure]учетной записи(../media/azure-blob-storage.png "хранения блога Azure")

Если ведение журнала диагностики включено успешно, то становится доступным следующее действие:
- **Обновление конфигурации ведения журнала диагностики**: позволяет обновить или удалить конфигурацию ведения журнала диагностики для портала.
- **Отключить ведение журнала диагностики**. позволяет отключить конфигурацию ведения журнала диагностики для портала.
 
### <a name="update-diagnostic-logging"></a>Обновление журнала диагностики

1. Откройте [центр администрирования порталов PowerApps](admin-overview.md).

2. Перейдите к **действиям портала** > **Обновить конфигурацию ведения журнала диагностики**.

   > [!div class=mx-imgBorder]
   > ![Обновите]конфигурацию ведения журнала диагностики(../media/update-diagnostic-logging.png "Обновление конфигурации ведения журнала диагностики")

3. В окне Конфигурация обновления ведения журнала диагностики введите следующие значения:
   - Вы **хотите обновить строку подключения службы хранилища BLOB-объектов Azure?** : позволяет указать, следует ли обновлять строку подключения службы хранилища BLOB-объектов Azure. По умолчанию он выбран.
   - **Строка подключения службы хранилища больших двоичных объектов Azure**: URL-адрес службы хранилища больших двоичных объектов Azure для хранения журналов ошибок портала. Максимальная длина URL-адреса может составлять 2048 символов. Если длина URL-адреса превышает 2048 символов, выводится сообщение об ошибке. Это поле отображается, только если **вы хотите обновить строку подключения для службы хранилища BLOB-объектов Azure?** флажок установлен. Дополнительные сведения о строке подключения: [Настройка строк подключения службы хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-configure-connection-string)
   - **Выберите срок хранения**: длительность для хранения журналов ошибок портала в хранилище BLOB-объектов. Журналы ошибок удаляются по истечении выбранного времени. Можно выбрать одно из следующих значений:
     - 1 день
     - 7 дней
     - 30 дней
     - 60 дней
     - 90 дней
     - 180 дней
     - Постоянно

   По умолчанию срок хранения составляет 30 дней.

   > [!div class=mx-imgBorder]
   > ![Обновить]окно конфигурации ведения журнала диагностики(../media/update-diagnostic-logging-window.png "обновить окно конфигурации ведения журнала диагностики")

4. Нажмите кнопку **Обновить**.

### <a name="disable-diagnostic-logging"></a>Отключить ведение журнала диагностики

1. Откройте [центр администрирования порталов PowerApps](admin-overview.md).

2. Перейдите к **действиям портала** > **отключить ведение журнала диагностики**.

   > [!div class=mx-imgBorder]
   > ![Отключить ведение журнала диагностики](../media/disable-diagnostic-logging.png "отключить ведение журнала диагностики")

3. В сообщении с подтверждением нажмите кнопку **Отключить** .

## <a name="display-plugin-error"></a>Ошибка при отображении подключаемого модуля

Другой сценарий, часто возникающий при разработке портала, — это ошибка, формируемая пользовательскими подключаемыми модулями и бизнес-логикой, написанной в среде Common Data Service. Эти ошибки обычно можно получить, [отключив пользовательские ошибки](#disable-custom-error) или [включив ведение журнала диагностики](#enable-diagnostic-logging). Однако в некоторых случаях эти ошибки быстрее отображаются непосредственно на портале, чтобы быстрее диагностировать проблему. Для этого можно настроить портал для отображения ошибок пользовательского подключаемого модуля из Common Data Service на экране портала.

Чтобы отобразить ошибки пользовательского подключаемого модуля, создайте параметр сайта `Site/EnableCustomPluginError` и присвойте ему значение true. Пользовательские ошибки подключаемого модуля будут отображаться на экране вместо универсальной ошибки. В этой ошибке будет отображаться только часть сообщения об ошибке подключаемого модуля, а не полная трассировка стека.

Ниже перечислены экраны, в которых отображаются пользовательские ошибки подключаемого модуля. 
- Список сущностей 
    - Получение записей 
- Форма сущности 
    - Выбор 
    - Создание, обновление и т. д. 
- Веб-формы 
    - Выбор 
    - Создание, обновление и т. д.

Если параметр сайта отсутствует, он будет считаться ложным по умолчанию, а ошибки подключаемого модуля не будут отображаться.

---
title: Просмотр журналов ошибок портала и их сохранение в хранилище больших двоичных объектов Azure | MicrosoftDocs
description: Узнайте, как просматривать журналы ошибок портала и сохранять их в учетной записи хранилища больших двоичных объектов Azure.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 10/07/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: 7989c15b0c5c4cf50d4b55f518244758afc067e1
ms.sourcegitcommit: d9cecdd5a35279d78aa1b6c9fc642e36a4e4612c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "2756667"
---
# <a name="view-portal-error-logs"></a>Просмотр журналов ошибок портала

Как администратор портала или разработчик, вы можете использовать порталы PowerApps для создания веб-сайта для клиентов. Одна обычная задача для разработчика — это отладка проблем при разработке портала. Чтобы помочь в отладке, можно получить доступ к подробным журналам ошибок для любых проблем на портале. Существует несколько способов получения журналов ошибок для порталов.

## <a name="custom-error"></a>Настраиваемая ошибка

Если на портале возникло любое исключение на стороне сервера, по умолчанию отображается настроенная страница ошибки с понятным сообщением об ошибке. Чтобы настроить сообщение об ошибке, см. раздел [Отображение настраиваемого сообщения об ошибке](#display-a-custom-error-message).

Однако для целей отладки лучше просматривать подробную страницу ошибки ASP.NET, которая также известна как "желтый экран смерти" (YSOD). Подробная страница ошибки помогает получить полный стек ошибки сервера.

> [!div class=mx-imgBorder]
> ![Желтый экран смерти](../media/ysod.png "Желтый экран смерти")

Чтобы включить YSOD, необходимо [отключить настраиваемые ошибки](#disable-custom-error) на вашем портале.

> [!NOTE]
> Рекомендуется отключать настраиваемые ошибки только на этапе разработки, и включать настраиваемые ошибки при переходе к эксплуатации.

Дополнительные сведения о настраиваемой ошибке: [Отображение страницы настраиваемой ошибки](https://docs.microsoft.com/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/displaying-a-custom-error-page-cs)

### <a name="disable-custom-error"></a>Отключение настраиваемой ошибки

Можно отключить настраиваемые ошибки для отображения детального сообщения исключения, если на портале возникло любое исключение на стороне сервера.

1. Открытие [Центра администрирования портала PowerApps](admin-overview.md).

2. Выберите **Действия портала** > **Отключить настраиваемые ошибки**.

   > [!div class=mx-imgBorder]
   > ![Отключение настраиваемой ошибки](../media/disable-custom-errors.png "Отключение настраиваемой ошибки")

3. Выберите **Отключить** в сообщении подтверждения. В процессе отключения настраиваемых ошибок портал перезапускается и будет недоступен. Сообщение отображается, когда настраиваемые ошибки отключены.

### <a name="enable-custom-error"></a>Включение настраиваемой ошибки

Можно включить настраиваемые ошибки на порталах для отображения профессионального выглядящей страницы вместо страницы YSOD. На этой странице приведены содержательные сведения, если возникло любое исключение в приложении.

1. Открытие [Центра администрирования портала PowerApps](admin-overview.md).

2. Выберите **Действия портала** > **Включить настраиваемые ошибки**.

   > [!div class=mx-imgBorder]
   > ![Включение настраиваемой ошибки](../media/enable-custom-errors.png "Включение настраиваемой ошибки")

3. Выберите **Включить** в сообщении подтверждения. В процессе включения настраиваемых ошибок портал перезапускается и будет недоступен. Сообщение отображается, когда настраиваемые ошибки включены.

> [!NOTE]
> - Если изменить экземпляр, к которому подключен портал, настраиваемые ошибки включаются. Необходимо снова отключить настраиваемые ошибки, если это требуется.
> - Не следует включать или отключать настраиваемые ошибки во время изменения экземпляра, к которому подключен портал; в противном случае отображается сообщение об ошибке.

### <a name="display-a-custom-error-message"></a>Отображение сообщения о настраиваемой ошибке

Можно настроить портал для отображения настраиваемой ошибки профессионального вида вместо общей ошибки.

Для определения настраиваемой ошибки используйте фрагмент содержимого `Portal Generic Error`. Содержимое, определенное в этом фрагменте, отображается на странице ошибки. Этот фрагмент содержимого не доступен в готовом виде, и пользователь должен создать его. Для параметра **Тип** фрагмента содержимого может быть задано значение **Текст** или **HTML**. Для создания или редактирования фрагмента содержимого см. раздел [Настройка содержимого с помощью фрагментов содержимого](../configure/customize-content-snippets.md).

> [!NOTE]
> Если во фрагмент содержимого включен код Liquid, он пропускается и не отображается.

Если настраиваемые ошибки включены, это сообщение отображается в следующей структуре на странице ошибки:

<Content Snippet> 
<Error ID >
<Date and time>
<Portal ID>

Ниже приведен пример настраиваемого сообщения об ошибке с использованием фрагмента содержимого с типом HTML:

Это настраиваемая ошибка, создайте билет службы поддержки с примером экрана ошибки, нажав здесь

> [!div class=mx-imgBorder]
> ![Настраиваемое сообщение об ошибке](../media/custom-error-message.png "Настраиваемое сообщение об ошибке")

> [!NOTE]
> Если порталу не удается извлечь фрагмент содержимого, поскольку он не может установить соединение с Common Data Service или если фрагмент содержимого недоступен в Common Data Service, появляется сообщение об ошибке.

## <a name="access-portal-error-logs"></a>Доступ к журналам ошибок портала

После того как портал разработан и опубликован, все еще требуется иметь возможность получить доступ к журналам портала для устранения проблем, о которых сообщают клиенты. Для получения доступа к этим журналам можно настроить портал таким образом, чтобы он отправлял все ошибки приложений на принадлежащую вам учетную запись хранилища больших двоичных объектов Azure. Обращаясь к журналам ошибок портала, можно эффективно реагировать на запросы клиентов, так как у вас имеются сведения о проблеме. Чтобы получать журналы ошибок портала в свое хранилище больших двоичных объектов Azure, необходимо разрешить ведение журнала диагностики из центра администрирования порталов PowerApps.

> [!NOTE]
> Если изменить экземпляр Common Data Service, к которому подключен портал, ведение журналов диагностики отключается. Необходимо снова включить ведение журнала диагностики.

### <a name="enable-diagnostic-logging"></a>Включить ведение журнала диагностики

1. Открытие [Центра администрирования портала PowerApps](admin-overview.md).

2. Выберите **Действия портала** > **Включить ведение журнала диагностики**.

   > [!div class=mx-imgBorder]
   > ![Включить ведение журнала диагностики](../media/enable-diagnostic-logging.png "Включить ведение журнала диагностики")

3. В окне **Включить ведение журнала диагностики** введите следующие значения:

   - **Строка подключения к службе хранилища BLOB-объектов Azure**. URL-адрес службы хранилища больших двоичных объектов Azure для хранения журналов ошибок портала. Длина этого URL-адреса не должна превышать 2048 символов. Если URL-адрес длиннее 2048 символов, появляется сообщение об ошибке. Дополнительные сведения о строке подключения: [Настройка строк подключения службы хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-configure-connection-string)
   - **Выбор периода удержания**. Длительность хранения журналов ошибок портала в хранилище больших двоичных объектов. Журналы ошибок удаляются после выбранной длительности. Можно выбрать одно из следующих значений:
     - 1 день
     - 7 дней
     - 30 дня
     - 60 дня
     - 90 дня
     - 180 дня
     - Всегда

   Период хранения по умолчанию: 30 дней.
  
   > [!div class=mx-imgBorder]
   > ![Окно включения ведения журнала диагностики](../media/enable-diagnostic-logging-window.png "Окно включения ведения журнала диагностики")

4. Щелкните **Настроить**.

После настройки ведения журналов диагностики в учетной записи хранилища Azure создается новый контейнер больших двоичных объектов **telemetry-logs**, и журналы записываются в файлы больших двоичных объектов, хранящиеся в этом контейнере. На следующем снимке экрана показан контейнер больших двоичных объектов **telemetry-logs** в проводнике хранилища Azure.

> [!div class=mx-imgBorder]
> ![Учетная запись хранилища больших двоичных объектов Azure](../media/azure-blob-storage.png "Учетная запись хранилища больших двоичных объектов Azure")

Если функция ведения журнала диагностики включена успешно, следующее действие становится доступным:
- **Обновить конфигурацию ведения журнала диагностики**. Позволяет обновить или удалить конфигурацию ведения журнала диагностики для портала.
- **Отключить ведение журнала диагностики**. Позволяет отключить конфигурацию ведения журнала диагностики для портала.
 
### <a name="update-diagnostic-logging"></a>Обновление ведения журнала диагностики

1. Открытие [Центра администрирования портала PowerApps](admin-overview.md).

2. Выберите **Действия портала** > **Обновить конфигурацию ведения журнала диагностики**.

   > [!div class=mx-imgBorder]
   > ![Обновить конфигурацию ведения журнала диагностики](../media/update-diagnostic-logging.png "Обновить конфигурацию ведения журнала диагностики")

3. В окне "Обновить конфигурацию ведения журнала диагностики" введите следующие значения:
   - **Обновить строку подключения к службе хранилища BLOB-объектов Azure?**. Позволяет указать, требуется ли обновить строку подключения службы хранилища больших двоичных объектов Azure. По умолчанию, он выбран.
   - **Строка подключения к службе хранилища BLOB-объектов Azure**. URL-адрес службы хранилища больших двоичных объектов Azure для хранения журналов ошибок портала. Длина этого URL-адреса может быть не более 2048 символов. Если URL-адрес длиннее 2048 символов, появляется сообщение об ошибке. Это поле отображается только в том случае, если установлен флажок **Обновить строку подключения к службе хранилища BLOB-объектов Azure?**. Дополнительные сведения о строке подключения: [Настройка строк подключения службы хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-configure-connection-string)
   - **Выбор периода удержания**. Длительность хранения журналов ошибок портала в хранилище больших двоичных объектов. Журналы ошибок удаляются после выбранной длительности. Можно выбрать одно из следующих значений:
     - 1 день
     - 7 дней
     - 30 дня
     - 60 дня
     - 90 дня
     - 180 дня
     - Всегда

   Период хранения по умолчанию: 30 дней.

   > [!div class=mx-imgBorder]
   > ![Окно обновления конфигурации ведения журнала диагностики](../media/update-diagnostic-logging-window.png "Окно обновления конфигурации ведения журнала диагностики")

4. Нажмите **Обновить**.

### <a name="disable-diagnostic-logging"></a>Отключить ведение журнала диагностики

1. Открытие [Центра администрирования портала PowerApps](admin-overview.md).

2. Выберите **Действия портала** > **Отключить ведение журнала диагностики**.

   > [!div class=mx-imgBorder]
   > ![Отключить ведение журнала диагностики](../media/disable-diagnostic-logging.png "Отключить ведение журнала диагностики")

3. В сообщении подтверждения щелкните **Отключить**.

## <a name="display-plugin-error"></a>Ошибка отображения подключаемого модуля

Другой сценарий, который часто происходит при разработке портала, — это ошибка, вызываемая настраиваемыми подключаемыми модулями и бизнес-логикой, созданными в вашей среде Common Data Service. Доступ к этим ошибкам обычно возможен при [отключении настраиваемых ошибок](#disable-custom-error) или [включении ведения журнала диагностики](#enable-diagnostic-logging). Тем не менее в некоторых случаях быстрее отображать эти ошибки непосредственно на портале для более быстрой диагностики проблемы. Чтобы это сделать, можно настроить портал для отображения ошибок настраиваемых подключаемых модулей из Common Data Service на экране портала.

Для отображения ошибок настраиваемых подключаемых модулей создайте параметр сайта `Site/EnableCustomPluginError` и установите для него значение True. Ошибки настраиваемых подключаемых модулей будут отображаться на экране, а не в виде общей ошибки. Ошибка будет отображаться только сообщение ошибки подключаемого модуля, а не всю трассировку стека.

Ниже приведены экраны, на которых отображаются ошибки настраиваемых подключаемых модулей: 
- Список сущностей 
    - Извлечение записей 
- Форма сущности 
    - Извлечь 
    - Создание или обновление и т. п. 
- Веб-формы 
    - Извлечь 
    - Создание или обновление и т. п.

Если этот параметр сайта не существует, по умолчанию он обрабатывается как имеющий значение false, и ошибки подключаемых модулей не отображаются.

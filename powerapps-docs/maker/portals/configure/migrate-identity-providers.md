---
title: Перенос поставщиков удостоверений в B2C Azure AD | MicrosoftDocs
description: Сведения о переносе поставщиков удостоверений в B2C Azure AD.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 10/18/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: a57398d08e190140a3383aef29825f4c08e90363
ms.sourcegitcommit: 8185f87dddf05ee256491feab9873e9143535e02
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/01/2019
ms.locfileid: "2708894"
---
# <a name="migrate-identity-providers-to-azure-ad-b2c"></a>Перенос поставщиков удостоверений в B2C Azure AD

Портал поддерживает настраиваемую систему безопасности, которая позволяет нашим клиентам поддерживать несколько систем проверки подлинности. Портал включает свои собственные локальные учетные данные помимо федеративного объединения с внешними поставщиками удостоверений с использованием стандартных протоколов, таких как OIDC, SAML и WS-Federation. В будущем рекомендуется использовать для проверки подлинности только поставщика удостоверений B2C Azure AD, а остальных поставщиков удостоверений выводить из использования (помечать как устаревших). 

## <a name="marking-an-identity-provider-as-deprecate"></a>Пометка поставщика удостоверений как устаревшего

Можно настроить портал, чтобы пометить других поставщиков удостоверений как устаревших, и позволить пользователям перейти на поставщика удостоверений B2C Azure AD. 

Следующие параметры сайта используются для управления устареванием поставщиков удостоверений:

| Имя  | Описание  |
|--------|--------|
| Authentication/Registration/LocalLoginDeprecated | Значение true или false. Если задано значение true, локальная учетная запись будет помечена как устаревшая. Пользователю портала будет необходимо перейти на учетную запись, которая не является устаревшей. По умолчанию установлено значение false. |
| Authentication/[protocol]/[provider]/Deprecated  | Значение true или false. Если задано значение true, эта конкретная учетная запись будет помечена как устаревшая. Пользователю портала будет необходимо перейти на учетную запись, которая не является устаревшей. По умолчанию установлено значение false. |
|||

Если пользователь портала производит попытку войти в систему, и хотя бы один поставщик удостоверений отмечен как устаревший, на странице отображается устаревшая учетная запись. В следующем примере учетная запись Майкрософт отмечена как устаревшая.

![Пример устаревшей учетной записи](../media/gdpr-deprecate-account.png "Пример устаревшей учетной записи")

Текст на экране для устаревшего поставщика проверки подлинности можно изменить с помощью следующего фрагмента содержимого:

| Имя                                               | Тип | Значение                         |
|----------------------------------------------------|------|-------------------------------|
| Account/Signin/SignInExternalDeprecatedFormHeading | Текст | Войти с использованием старой учетной записи |
|||

> [!NOTE]
> Устаревшие поставщики удостоверений не отображаются, когда пользователь регистрируется на портале или использует приглашение на портал.

## <a name="migrating-a-deprecated-identity-provider-to-a-new-identity-provider"></a>Переход с устаревшего поставщика удостоверений на нового поставщика удостоверений

Если пользователь портала входит в систему с использованием устаревшего поставщика удостоверений, на экране переноса учетной записи отображается сообщение для входа с поставщиком удостоверений, который не является устаревшим. Когда пользователь выполняет вход с использованием поставщика удостоверений, который не является устаревшим, учетная запись пользователя связывается с новым поставщиком.

![Пример переноса учетной записи](../media/gdpr-account-migration.png "Пример переноса учетной записи")

Сообщение на экране переноса учетной записи можно изменить с помощью следующих фрагментов содержимого:

| Имя                                         | Тип | Значение                                                                                                                                                                                                                |
|----------------------------------------------|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Account/Conversion/PageTitle                 | Текст | Перенос учетных записей                                                                                                                                                                                                    |
| Account/Conversion/PageCopy                  | HTML | Вы выполнили вход с учетной записью, которая больше не поддерживается. Чтобы продолжить использование портала, необходимо перейти на другую учетную запись. Выберите кнопку ниже, чтобы выполнить вход с помощью новой или существующей поддерживаемой учетной записи. |
| Account/Conversion/SignInExternalFormHeading | Текст | Выполните вход с использованием поддерживаемой учетной записи.                                                                                                                                                                                     |
|||

Портал позволяет сопоставить с одной записью контакта несколько удостоверений. Если несколько поставщиков объявлены устаревшими, пользователь портала должен дать согласие на условия несколько раз. Когда пользователь выполняет вход в систему с использованием устаревшего поставщика удостоверений, процесс переноса учетной записи запускается для каждого устаревшего поставщика и запись контакта связывается с неустаревшим поставщиком после миграции учетной записи.

Пример. Портал поддерживает учетную запись Майкрософт (MSA), Google и Facebook в качестве поставщиков удостоверений для проверки подлинности. Если вы отметите Google и Facebook как устаревших поставщиков и пользователь портала имеет только Google и Facebook в качестве поставщиков удостоверения для проверки подлинности, пользователь получит сообщение о переносе учетной записи, когда он попробует выполнить вход с помощью любого из двух своих поставщиков. Когда пользователь выполняет вход в систему с помощью MSA, MSA добавляется к записи контакта пользователя. Теперь пользователь имеет только MSA в качестве поддерживаемого поставщика удостоверений проверки подлинности.

Если пользователь портала выбирает нового поставщика удостоверений, и это удостоверение уже связано с другой записью контакта, отображается сообщение об ошибке. Можно настроить сообщение об ошибке с помощью следующих фрагментов содержимого:

| Имя                                                     | Тип | Значение                                                                                                                               |
|----------------------------------------------------------|------|-------------------------------------------------------------------------------------------------------------------------------------|
| Account/Signin/AccountConversionIdentityUsedErrorHeading | Текст | Ошибка преобразования учетной записи                                                                                                            |
| Account/Signin/AccountConversionIdentityUsedErrorText    | HTML | Эта учетная запись уже существует. Закройте браузер, перезапустите процесс и на странице "Перенос учетных записей" выберите другую учетную запись. |
|||

## <a name="disabling-local-login"></a>Отключение локального входа

Можно настроить портал, чтобы выключить локальный вход с помощью параметра сайта `Authentication/Registration/LocalLoginDeprecated`. Если кто-то попытается выполнить вход с помощью локальных учетных данных, отображается экран переноса учетной записи с инструкциями по выполнению входа с помощью поставщика удостоверений, который не является устаревшим. После переноса учетной записи пользователя локальные учетные данные этого пользователя отключаются.

> [!NOTE]
> Если вы отметите локальный вход как устаревший, пользователь не сможет зарегистрироваться для новой учетной записи.

Следующее поле добавлено в запись контакта на портале для указания, отключен ли локальный вход для этого пользователя:
- **Локальный вход отключен**. Указывает, что контакт больше не может входить на портал с использованием локальной учетной записи. По умолчанию установлено значение **Нет**. Для этого поля задано значение **Да**, если учетная запись пользователя перенесена в неустаревшего поставщика удостоверений и локальный вход отключен.

    ![Локальный вход отключен](../media/local-login-disabled.png "Локальный вход отключен")

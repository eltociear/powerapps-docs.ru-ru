---
title: Определение форм сущностей | MicrosoftDocs
description: Инструкции по созданию форм сущностей на портале.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 11/04/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: 79e6f02f9a13f1c828efe5c472d267e707b09576
ms.sourcegitcommit: d9cecdd5a35279d78aa1b6c9fc642e36a4e4612c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73552711"
---
# <a name="about-entity-forms"></a>О формах сущностей

Управляемая данными конфигурация, позволяющая конечным пользователям добавлять форму для получения данных на портале, не требуя от разработчика отображения формы на портале, формы сущностей создаются в Common Data Service и затем помещаются в веб-страницы на портале или используются совместно с i. вложенные сетки и списки сущностей для создания готовых веб-приложений. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [о списках сущностей](entity-lists.md) 

![Форма связи с нами](../media/contact-us-form.png "Форма связи с нами")  

## <a name="add-a-form-to-your-portal"></a>Добавление формы на портал

Форма сущность содержит связи с веб-страницами и дополнительные свойства для управления инициализацией формы на портале. Связь с веб-страницами позволяет выполнять динамическое извлечение определения формы для данного узла страницы на веб-сайте. 

Чтобы просмотреть существующие формы сущностей или создать новые формы сущностей, откройте [приложение управления портала](configure-portal.md) и перейдите на **порталы** &gt; **Entity Forms**.

При создании новой формы сущностей сначала необходимо решить, в дополнение к режиму отображения **сущности** и **формы** , которые будут отображены, а также **: вставка, изменение или только чтение**. Выбранный режим определяет, создается ли новая запись на портале, редактируется существующая запись или просто отображаются сведения о записи на портале.

> [!Note]
> - **Форма сущностей** должна быть связана с веб-страницей для данного сайта, чтобы форма была доступна для просмотра в пределах сайта.
> - Вложенные сетки сущностей соединения не поддерживаются в формах сущностей. Если добавить в форму подсетку сущности подключения с помощью конструктора форм, сообщения об ошибках выводятся при отображении формы на портале и использовании сущности Connection.
> - В формах сущностей не поддерживаются дублированные поля, набор параметров с множественным выбором, пользовательские элементы управления и бизнес-правила.
> - Бизнес-правила и клиентский API могут включать заблокированные поля в форме только для чтения.
> - При создании формы сущности в режиме вставки нельзя изменить выравнивание кнопки или поместить кнопку действия над формой сущности.
> - Если элемент управления Уточняющий запрос отображается как раскрывающийся список в форме, то фильтр связанных записей не работает.

Веб-страницы, связанные с формой сущностей, можно просмотреть, выбрав ссылку **Web Pages** , которая указана в **соответствующих** ссылках навигации в крайнем левом меню.

При создании или редактировании веб-страницы **форма сущности** может быть указана в поле подстановки, предоставленном в форме Web Page.

Различные главные страницы, используемые порталом, содержат объявления серверного элемента управления **ентитиформ** . При отрисовке веб-страницы, содержащей шаблон страницы (~/Пажес/Паже.аспкс) Page или полную страницу (~/Пажес/фуллпаже.аспкс), элементы управления определяют, содержит ли подстановка формы сущности значение, в этом случае форма будет подготовлена к просмотру.

## <a name="secure-your-forms"></a>Защита форм

Для защиты форм необходимо создать разрешения сущности, определяющие доступ и владение записями в соответствии с веб-ролями. Если пользователь пойдет на форму сущности и не имеет разрешений, он получит сообщение об ошибке. Чтобы включить разрешения для формы сущности, установите для параметра **Включить разрешения сущности** значение true. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [создать веб-роли для порталов](create-web-roles.md).  

## <a name="entity-form-attributes-and-relationships"></a>Атрибуты и связи формы сущности

|Имя|Description|
|-----|----------|
|Имя|Описательное имя записи. Это обязательное поле.|
|Имя сущности|Имя сущности, из которой будет загружена форма. Это обязательное поле.|
|Имя формы| Имя формы в целевой сущности, подготове к просмотру. Это обязательное поле.|
|Имя вкладки|  Необязательное имя вкладки в форме для указанной сущности, которая должна быть подготовлена к просмотру.|
|Режим|Одно из следующих значений:<ul><li>Вставляет</li><li>Редактор</li><li>Доступно</li></ul>Выбор _вставки_ означает, что форма должна вставить новую запись после отправки. Указание _Edit_ указывает, что форма должна изменять существующую запись. При выборе параметра _ReadOnly_ в форме должна отображаться нередактируемая форма существующей записи. Для _Edit_ и _ReadOnly_ требуется наличие исходной записи и параметров, указанных в полях "тип источника записи" и "имя параметра строки запроса идентификатора записи", чтобы выбрать соответствующую запись при загрузке формы на портале.|
|Тип источника записи|Одно из следующих значений:<ul><li>Строка запроса</li><li>Текущий пользователь портала</li><li>Запись, связанная с текущим пользователем портала</li></ul>Для выбора _строки запроса_ требуется имя параметра, которое должно быть указано в строке запроса URL-адреса к форме. Его можно указать в поле "имя параметра строки запроса идентификатора записи".<br>Выбор _текущего пользователя портала_ повлечет за собой получение записи пользователя портала для текущего пользователя, прошедшего проверку подлинности.<br>При выборе _записи, связанной с текущим пользователем портала_ , загружается запись пользователя портала для текущего пользователя, прошедшего проверку подлинности, а затем извлекается запись для данной связи, как указано в поле "имя связи".|
|Идентификатор записи имя параметра строки запроса| Имя параметра, указанное в строке запроса URL-адреса к веб странице, содержащей эту форму сущности.|
|Имя связи| Обязательный, если тип источника записи — запись, связанная с текущим пользователем портала. Логическое имя связи между текущей записью пользователя портала и целевой записью. Он должен возвращать тот же тип сущности, который указан в поле имени сущности.|
|Разрешить Create, если значение равно null|  Необязательное логическое значение, доступное, если тип источника записи — запись, связанная с текущим пользователем портала. Указывает, что если связанная запись не существует, разрешите пользователю создать ее в первый раз. в противном случае будет создано исключение, если запись не существует, так как для формы не требуется запись для привязки данных.|
|Включить разрешения для сущности| Приведет к тому, что форма будет учитывать разрешения сущности. По умолчанию используется значение false для обеспечения обратной совместимости. Если задано значение true, для любого пользователя, желающего получить доступ к форме, требуются явные разрешения.|
|||

### <a name="form-options"></a>Параметры формы

|Имя|Description|
|----|---------|
|Добавить CAPTCHA|   Отображает CAPTCHA.|
|Показывать CAPTCHA для пользователей, прошедших проверку подлинности|  Отображает CAPTCHA для пользователей, прошедших проверку подлинности.|
|Группа проверки|  Имя группы, назначенное элементам управления вводом для оценки допустимых входных данных именованных групп.|
|Автоматическое создание шагов на вкладках| Указывает, что несколько вкладок в форме сущности будут отображаться на каждой вкладке в виде последовательного шага, начиная с первой вкладки, и продолжайте до тех пор, пока не будут перемещены все вкладки в и после завершения отправки записи. По умолчанию он не выбран. Значение по умолчанию указывает, что для текущего шага отображается только одна вкладка или форма. Если имя вкладки не указано, отображается первая вкладка.|
|Встроенная визуализация веб-ресурсов|   Исключает IFRAME, охватывающий веб-ресурс в форме сущности.|
|Всплывающие подсказки включены|  Подсказка задается с помощью описания атрибута в целевой сущности.|
|Показывать неподдерживаемые поля|   Все поля в настоящее время поддерживаются. Это зарезервировано для потенциальных изменений, Common Data Service может быть внесено в типы полей.|
|При необходимости задайте Рекомендуемые поля|    Делает обязательным все атрибуты, для которых в поле уровень требований задано значение "рекомендуемый бизнес".|
|Сделать все поля обязательными|  Делает все поля обязательными независимо от уровня требований поля.|
|Класс CSS сводки проверки|  Имя класса CSS, назначенное для сводки проверки. По умолчанию — "Проверка-сводка оповещений-ошибка-блок"|
|Включить Сводные ссылки проверки|   Логическое значение true или false, указывающее, должны ли отображаться ссылки привязки в сводке проверки для прокрутки до поля, содержащего ошибку. Значение по умолчанию — true.|
|Текст ссылки для сводки проверки|  Метка, назначенная сводным ссылкам проверки. Значение по умолчанию — "щелкните здесь".|
|Текст заголовка сводки проверки|    Метка, назначенная заголовку сводки проверки.|
|Водим|  Инструкции для работы с формой.|
|Сообщение "запись не найдена"|  Сообщение, отображаемое, если запись не найдена.|
|||

### <a name="on-success-settings"></a>В параметрах успешного выполнения

|Имя|Description|
|----|----------|
|При успешном выполнении|    Одно из следующих значений:<ul><li>Отобразить сообщение об успешном выполнении (по умолчанию)</li><li>Перенаправления</li></ul>|
|Скрыть форму при успешном выполнении|  Для вывода сообщения об успешном выполнении требуется параметр on Success. Если этот флажок установлен, форма будет скрыта после успешной отправки формы.|
|Сообщение об успешном выполнении|   Для вывода сообщения об успешном выполнении требуется параметр on Success. Сообщение, отображаемое пользователю после успешной отправки. Если не указано сообщение по умолчанию (отправка успешно завершена), будет отображен. Для каждого установленного и включенного языкового пакета в Организации поле будет доступно для ввода сообщения на соответствующем языке.|
|Внешний URL-адрес|Для перенаправления требуется параметр on Success. Укажите URL-адрес для внешнего ресурса в Интернете.
|или веб-страницу|Для перенаправления требуется параметр on Success. Выберите веб-страницу с текущего веб-сайта.|
|Добавить существующую строку запроса|  Для перенаправления требуется параметр on Success. Если этот флажок установлен, существующие параметры строки запроса будут добавлены к целевому URL-адресу перед перенаправлением.|
|Добавление идентификатора записи в строку запроса|  Для перенаправления требуется параметр on Success. Если этот флажок установлен, идентификатор созданной записи добавляется в строку запроса URL-адреса, на который выполняется перенаправление.|
|Идентификатор записи имя параметра строки запроса|     Для перенаправления требуется параметр on Success. Имя параметра ID в строке запроса URL-адреса, на который выполняется перенаправление.|
|Добавить строку настраиваемого запроса|    Для перенаправления требуется параметр on Success. Пользовательская строка, которая может быть добавлена к существующей строке запроса URL-адреса перенаправления.|
|Добавление значения атрибута в строку запроса — имя параметра|   Для перенаправления требуется параметр on Success. Имя, присваиваемое параметру, который соответствует значению атрибута в целевой сущности, добавляемому к строке запроса URL-адреса перенаправления.|
|Добавление значения атрибута в строку запроса — логическое имя атрибута|Для перенаправления требуется параметр on Success. Логическое имя атрибута в целевой сущности для получения значения, добавляемого в строку запроса URL-адреса перенаправления.|
|||

### <a name="additional-settings"></a>Дополнительные параметры

|Имя|Description|
|----|----------|
|Связать текущего пользователя портала| Указывает, что запись текущего пользователя, вошедшего в систему, должна быть связана с записью целевой сущности.|
|Атрибут поиска пользователя портала целевого объекта|    Логическое имя атрибута в целевой сущности, в которой хранится пользователь портала.|
|Является стороной активности| Логическое значение, указывающее, является ли атрибут поиска пользователя портала целевого объекта типом субъекта действия.|
|Вложить файл|   Установите флажок, чтобы форма включала элемент управления отправка файла в нижнюю часть формы, чтобы разрешить вложение файла в запись.|
|Присоединить место хранения файлов|  Параметры: Примечание. вложение, хранилище BLOB-объектов Azure. Если ваша организация настроена для использования службы хранилища Azure, вы можете выбрать в ней файлы для хранения, загруженные в эту сущностную форму. В противном случае файлы будут храниться как вложения примечаний.|
|Разрешить несколько файлов|Логическое значение, указывающее, может ли пользователь передать более одного файла.|
|гласит|    Атрибут Accept задает типы MIME файлов, принимаемых сервером при передаче файлов. Чтобы указать несколько значений, разделяйте их запятыми (например, Audio/ *, Video/* , Image/*).|
|Метка| Текст, отображаемый рядом с элементом управления отправкой файла. Для каждого установленного и включенного языкового пакета в Организации поле будет доступно для ввода сообщения на соответствующем языке.|
|Требуется вложить файл| Создает вложение файла, необходимого для продолжения.|
|Обязательное сообщение об ошибке|Сообщение, отображаемое во время проверки формы, если требуется значение true, и пользователь не присоединил файл. Для каждого установленного и включенного языкового пакета в Организации поле будет доступно для ввода сообщения на соответствующем языке.|
|Ограничить файлы допустимыми типами|  Принудительно выполняет проверку в поле Accept. Если этот параметр не выбран, атрибут Accept будет использоваться только в качестве предложения для диалогового окна отправки файла.|
|Сообщение об ошибке типа файла|Сообщение, отображаемое во время проверки формы, если параметр ограничить файлы допустимыми типами имеет значение true и пользователь попытался передать недопустимый тип файла. Для каждого установленного и включенного языкового пакета в Организации поле будет доступно для ввода сообщения на соответствующем языке.|
|Максимальный размер файла (в килобайтах)|  Принудительная проверка на максимально допустимом размере переданного файла.|
|Сообщение об ошибке размера файла|   Сообщение, отображаемое во время проверки формы, если максимальный размер файла (в килобайтах) равен true, а пользователь попытался отправить слишком большой файл. Для каждого установленного и включенного языкового пакета в Организации поле будет доступно для ввода сообщения на соответствующем языке.|
|Пользовательский JavaScript| Пользовательский блок JavaScript, который будет добавлен в нижнюю часть страницы непосредственно перед закрывающим элементом тега формы. Идентификатору входа HTML поля сущности присваивается логическое имя атрибута. Это позволяет легко выбрать поле, задать значения или другую манипуляцию на стороне клиента с jQuery.<br>`$(document).ready(function() {   $(“#address1_stateorprovince”).val(“Saskatchewan”);});`|
|||

### <a name="entity-reference"></a>Ссылка на сущность

Следующие параметры относятся к заданию ссылки на сущность при сохранении формы.

Это позволяет связать текущую запись, создаваемую или обновленную формой, с другой целевой записью. Это полезно, если имеется несколько шагов с несколькими типами сущностей и необходимо связать итоговые записи или если страница передала строку запроса с идентификатором записи, который вы хотите связать. Например, у нас есть страница "курсоры", в которой перечисляются записи о заданиях, в каждой из которых имеется ссылка на приложение для задания, содержащее идентификатор задания, в котором размещается задание, так что при создании приложения его публикация связывается с записью. 

|Имя|Description|
|-----|---------|
|Задать ссылку на сущность при сохранении|Да или нет. Значение "Да" указывает, что при сохранении формы должна быть назначена ссылка на сущность, в противном случае она не будет задана.|
|Имя связи|Имя определения связи для данной связи между двумя типами сущностей.|
|Логическое имя сущности|Логическое имя ссылочной сущности.|
|Логическое имя целевого атрибута уточняющего запроса|Логическое имя атрибута подстановки для создаваемой или обновляемой целевой сущности.|
|Заполнить поле подстановки| Если поиск по ссылочной сущности находится в форме, то при установке этого значения поле в форме заполнится значением, полученным с помощью параметра ниже.|
|Тип источника ссылочной сущности|  Одно из следующих значений:<ul><li>Строка запроса</li><li>Текущий пользователь портала</li><li>Результат на предыдущем шаге</li></ul> Для выбора _строки запроса_ требуется имя параметра, которое должно быть указано в строке запроса URL-адреса к форме. Его можно указать в поле **имя строки запроса** . Если этот параметр является первичным ключом, выберите значение Да, чтобы **строка запроса была первичным ключом**, в противном случае выберите Нет и укажите логическое имя атрибута в целевой сущности для запроса, указанный в поле **логическое имя атрибута запроса** .  Выбор текущего пользователя портала получит контактную запись для текущего пользователя, прошедшего проверку подлинности. Выбор результата на предыдущем шаге приведет к получению записи, созданной в результате выполнения шага до текущего этапа, или от конкретного шага на основе шага, связанного с шагом источника сущности.|
|Шаг ссылочной сущности| Запись шага веб-формы на предыдущем шаге для получения сущности, созданной или измененной на этом шаге, чтобы связать ее с записью для этого текущего шага.|
|Имя строки запроса| Имя параметра, указанное в строке запроса URL-адреса к веб странице, содержащей веб-форму.|
|Строка запроса является первичным ключом|   Да указывает, что значение строки запроса является значением первичного ключа. Нет указывает, что значение строки запроса является типом атрибута, отличным от первичного ключа.|
|Логическое имя атрибута запроса|  Логическое имя атрибута для запроса записи.|
|Показывать сведения только для чтения| Указывает, что форма должна быть отображена в верхней части страницы, в которой отображаются сведения только для чтения, относящиеся к записи ссылки. Требуется имя формы.|
|Имя формы| Имя формы в ссылочной сущности, которое должно использоваться для вывода сведений, предназначенных только для чтения.|
|||


## <a name="entity-form-action-configuration"></a>Настройка действия формы сущности

По умолчанию форма сущности разрешает чтение или обновление существующей записи или вставку новой записи.  Однако можно легко включить и настроить дополнительные действия для записей в форме сущности (удаление, активация, деактивация и т. д.). Можно также переопределить метки по умолчанию, размеры и другие атрибуты, которые будут отображаться, если включены какие-либо действия.

Эти параметры находятся в разделе **Дополнительные параметры** формы сущности. По умолчанию отображаются только **Основные параметры** . Можно выбрать **Дополнительные параметры** , чтобы отобразить дополнительные параметры.

Можно добавить кнопки действий, применимые к отдельной записи, и будут отображаться для каждой строки в сетке, если предоставлены соответствующие права доступа [сущностей](assign-entity-permissions.md). Доступны следующие действия.

- Удален
- Процессов
- Создать связанную запись
- Вызова
- Активизаци

Если щелкнуть один из этих параметров, откроется область конфигурации для этого действия. Более того, некоторые сущности имеют специальные действия, доступные для отдельных сущностей:

- Вычислить значение возможности (возможная сделка)
- Отменить действие варианта (инцидент)
- Закрытие (разрешение) действия Case (инцидент)
- Преобразовать кавычки в заказ (цитата)
- Преобразовать заказ в счет (SalesOrder)
- Создать цитату из возможной сделки (возможная сделка)
- Действие "потерять возможную сделку" (возможная сделка)
- Действие Win сделка (возможная сделка)
- Повторно открыть действие сценария (инцидент)
- Задать возможность удержания (возможная сделка)

> [!NOTE]
> Рекомендуется создать рабочий процесс вместо добавления кнопки **активировать** или **деактивировать** для всех сущностей Box, для которых определены определенные значения **состояния** и **кода состояния** , необходимые для своих бизнес-процессов. Например, инцидент ([Параметры состояния](https://docs.microsoft.com/dynamics365/customerengagement/on-premises/developer/entities/incident#statuscode-options)), возможность ([Параметры состояния](https://docs.microsoft.com/dynamics365/customerengagement/on-premises/developer/entities/opportunity#statuscode-options)), права ([Параметры состояния](https://docs.microsoft.com/dynamics365/customerengagement/on-premises/developer/entities/entitlement#statuscode-options)). 


## <a name="geolocation-configuration-for-entity-forms"></a>Конфигурация географического расположения для форм сущностей

Управляемую форму можно настроить для отображения элемента управления картой, чтобы отобразить существующее расположение в виде ПИН-кода на карте или предоставить пользователю возможность указать расположение. См. раздел [Добавление географического расположения](add-geolocation.md).

Элемент управления картой формы требует дополнительной настройки, чтобы сообщить ей, что такое идентификаторы полей расположения, чтобы присвоить им значения или извлечь из них значения. Запись формы сущности содержит раздел конфигурации, определяющий эти сопоставления полей, которые необходимо указать. Имена полей будут зависеть от созданной схемы.

![Данные географического расположения в форме сущности](../media/geolocation-managed-form.png "Данные географического расположения в форме сущности") 

> [!Note]
> - Поле адреса в форме сущности только для чтения заменяется на карту при включении географического положения.
> - Раздел «географическое положение» не отображается в облачной среде Германии независимых. Если пользователь включил географическое расположение с другой формой, он не будет отображаться во время отрисовки на портале.

### <a name="see-also"></a>См. также

[Настройка портала](configure-portal.md)  
[Свойства веб-формы для порталов](web-form-properties.md)  
[Шаги веб-форм для порталов](web-form-steps.md)  
[Метаданные веб-форм для порталов](configure-web-form-metadata.md)  
[Конфигурация вложенной сетки веб-формы для порталов](configure-web-form-subgrid.md)  
[Настройка заметок для форм сущностей и веб-форм для порталов](../configure-notes.md)

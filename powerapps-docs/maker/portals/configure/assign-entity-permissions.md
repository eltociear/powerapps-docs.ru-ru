---
title: Добавление безопасности на основе записей с помощью разрешений сущности для портала | MicrosoftDocs
description: Инструкции по добавлению разрешения сущности и назначению ей веб-ролей.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 11/04/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: 47730a2ba169b89534fa93221290c5598a95a8e8
ms.sourcegitcommit: d9cecdd5a35279d78aa1b6c9fc642e36a4e4612c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73553401"
---
# <a name="add-record-based-security-by-using-entity-permissions-for-portals"></a>Добавление безопасности на основе записей с помощью разрешений сущностей для порталов

Для применения средств обеспечения безопасности на основе записей на порталах к отдельным записям используйте разрешения сущности. Разрешения сущности добавляются в веб-роли, что позволяет определять в Организации роли, которые логически соответствуют привилегиям и концепциям владения записями и доступу, представленным с помощью разрешений сущности. Помните, что данный контакт может принадлежать любому количеству ролей, и данная роль может содержать любое количество разрешений на сущность. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [Создание веб-ролей для порталов](create-web-roles.md) 

Хотя разрешения на изменение и доступ к URL-адресам в карте узла портала предоставляются через авторизацию содержимого, руководители сайтов также хотят защищать свои собственные веб-приложения, созданные с помощью сущностных форм и списков сущностей. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [определения сущностных форм](entity-forms.md) и [определения списков сущностей](entity-lists.md)  

Для защиты этих функций разрешения сущности позволяют предоставлять детализированные права для произвольных сущностей, а безопасность на уровне записи должна быть включена через определения связей.

## <a name="add-entity-permissions-to-a-web-role"></a>Добавление разрешений сущности в веб-роль

1.  Откройте [приложение управления портала](configure-portal.md).

2. Перейдите на **порталы** &gt; **веб-роли** и откройте веб-роль, к которой необходимо добавить разрешения. 

3. Выберите **Добавить** , чтобы добавить имеющееся разрешение на сущность для веб-роли. 

4. Выберите **создать, чтобы** создать новую запись разрешения сущности.

    ![Добавление разрешений сущности в веб-роль](../media/add-entity-permission-web-role.png "Добавление разрешений сущности в веб-роль")  

При создании записи разрешения сущности первым шагом является определение сущности, которая будет защищена. Следующим шагом является определение области, как описано ниже, и&mdash;для любой области, отличной от глобальной&mdash;связей, определяющих эту область. Наконец, определите права, которые предоставляются роли с помощью этого разрешения. Обратите внимание, что права являются кумулятивными, поэтому, если пользователь находится в роли, которая предоставляет право на чтение, а другая — чтение и обновление, пользователь будет иметь права на чтение и обновление для всех записей, перекрывающихся между этими двумя ролями.

> [!Note]
> Выбор сущностей CMS, таких как веб-страница и Web-файлы, является недопустимым и может иметь другие непредвиденные последствия. Портал будет утверждать безопасность сущностей CMS на основе элементов управления доступом к содержимому, а не разрешений сущности.

### <a name="global-scope"></a>Глобальная область

Если роли с глобальной областью предоставлена запись разрешения сущности с разрешением на чтение, любой контакт в этой роли будет иметь доступ ко всем записям определенной сущности. Например, они смогут видеть всех интересов, все учетные записи и т. д. Это разрешение будет автоматически соблюдаться в любых списках сущностей, по сути отображающих все записи в соответствии с представлениями приложений на основе модели, которые были определены для этого списка. Кроме того, если пользователь пытается получить доступ к записи через форму сущности, к которой у него нет доступа, они получат ошибку разрешения.

### <a name="contact-scope"></a>Область контакта

С областью контакта пользователь, выполнивший вход в роль, для которой определена запись разрешения, будет иметь права, предоставленные этим разрешением, только для записей, связанных с записью контакта этого пользователя через определенную связь.

В списке сущностей это означает, что фильтр будет добавлен в любые представления приложений, управляемые моделями, на основе этого списка, который извлекает только записи, непосредственно связанные с текущим пользователем. (В зависимости от сценария эта связь может рассматриваться как права владения или управления.)

Формы сущностей разрешают только соответствующее разрешение на чтение, создание, запись и т. д., если эта связь существует при загрузке записи. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [определить формы сущностей и пользовательскую логику на портале](entity-forms.md).  

### <a name="account-scope"></a>Область учетной записи

В области учетной записи пользователь, выполнивший вход в роль, для которой определена запись разрешения, будет иметь права, предоставленные этим разрешением, только для записей, связанных с записью родительской учетной записи этого пользователя через определенную связь.

### <a name="self-scope"></a>Самостоятельная область

Область Self позволяет определить права, которые пользователь имеет в своей записи контакта (Identity). Это позволяет пользователям использовать формы сущностей или веб-формы для внесения изменений в свои записи контактов, связанные с их профилем. Обратите внимание, что на странице профиля по умолчанию есть специальная встроенная форма, позволяющая любому пользователю изменять свои основные контактные данные, а также участвовать в маркетинговых списках. Если эта форма включена на портал (которая по умолчанию используется), пользователям не будет требоваться это разрешение для его использования. Однако им потребуется это разрешение для использования любых настраиваемых форм сущностей или веб-форм, предназначенных для записи контактов пользователя.

### <a name="parental-scope"></a>Родительский диапазон

В этом самом сложном случае разрешения предоставляются для сущности, которая является связью от сущности, для которой уже определена запись разрешения сущности. Это разрешение на самом деле является дочерней записью разрешения родительской сущности.

Родительская запись разрешения определяет разрешение и область для сущности (возможно, глобальной или контактной области, хотя также возможно наличие родительского элемента). Эта сущность может быть связана с контактом (в случае области контакта) или глобально определенными. При таком разрешении создается дочернее разрешение, которое определяет связь между другой сущностью и сущностью, определенной в родительской связи.

Таким образом, пользователи в веб-роли, у которых есть доступ к записям, определенным в разрешениях родительской сущности, также будут иметь права, определенные в записи дочернего разрешения, в записи, связанные с родительской записью.

### <a name="attributes-and-relationships"></a>Атрибуты и связи

В таблице ниже объясняются атрибуты разрешений сущности.

| Имя                     | Description                                                                                                                                                                                                                                                                                                               |
|--------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Имя                     | Описательное имя записи. Это обязательное поле.                                                                                                                                                                                                                                                               |
| Имя сущности              | Логическое имя защищаемой сущности или, определяющее связь контакта или родительскую связь для защиты связанной сущности в дочернем разрешении. Это обязательное поле.                                                                                                                        |
| Область (обязательная)                   | <ul><li>**Глобальный**: предоставление прав доступа к записи сущности без каких-либо требований для владельца (контакта).</li><li>**Contact**: предоставление привилегий записи сущности, которая имеет прямую связь с владельцем (контакт).</li><li>**Учетная запись**. Предоставьте привилегии для записи сущности, которая имеет связь с учетной записью, которая выступает в роли владельца, если учетная запись является родительским клиентом контакта.</li><li>**Родительский**: предоставление прав доступа к записи сущности через цепочку отношений родительских разрешений.</li></ul>|
| Контактная связь     | Требуется только в том случае, если область = контакт. Имя схемы связи между контактом и сущностью, указанной в поле Имя сущности.|
| Родительская связь      | Требуется, только если назначено разрешение родительской сущности. Имя схемы связи между сущностью, заданной полем "имя сущности", и сущностью, указанной в поле "имя сущности" в записи разрешения родительской сущности.                                                                                     |
| Разрешение родительской сущности | Требуется только в том случае, если область = родитель.                                                                                                                                                                                                                                                            |
| Просмотр                     | Привилегия, которая определяет, может ли пользователь читать запись.                                                                                                                                                                                                                                                               |
| Будет                    | Привилегия, которая определяет, может ли пользователь обновлять запись.                                                                                                                                                                                                                                                             |
| Создания                   | Привилегия, которая определяет, может ли пользователь создать новую запись. Право на создание записи для типа сущности не применяется к отдельной записи, а к классу сущностей.                                                                                                                             |
| Удален                   | Привилегия, которая определяет, может ли пользователь удалить запись.                                                                                                                                                                                                                                                             |
| Добавление                   | Привилегия, которая определяет, может ли пользователь присоединить другую запись к указанной записи. Операции добавления и добавления к правам доступа работают в сочетании. Каждый раз, когда пользователь присоединяет одну запись к другой, пользователь должен иметь оба права. Например, при присоединении примечания к варианту необходимо иметь право на добавление доступа к заметке и добавление к праву доступа в случае, если операция будет работать.  |
| Добавить к                | Привилегия, определяющая, может ли пользователь добавить запись в качестве вопроса к другой записи. Операции добавления и добавления к правам доступа работают в сочетании. Дополнительные сведения см. в описании для Append.|
| | |

## <a name="global-permissions-for-tasks-related-to-leads"></a>Глобальные разрешения для задач, связанных с интересами

В одном сценарии может потребоваться использование списка сущностей и форм сущностей для отображения всех ведущих на портале всем пользователям в настраиваемой веб-роли диспетчера интересов. В форме изменения интересов, которая запускается при выборе строки интереса в списке, вложенная сетка будет отображать связанные записи задач. Эти записи должны быть доступны всем сотрудникам роли руководителя. В качестве первого шага мы предоставим глобальные разрешения всем пользователям в нашей роли менеджера по интересам.

Эта роль имеет связанное разрешение сущности для сущности интереса с глобальной областью.

Пользователи с этой ролью могут получать доступ ко всем интересам через списки сущностей или формы на портале.

![Предоставление глобальных разрешений для интереса](../media/grant-global-permission-leads.png "Предоставление глобальных разрешений для интереса")  

Теперь мы добавим дочернее разрешение к глобальному разрешению интереса. Открыв родительскую запись разрешений, перейдите к подсетке **разрешения дочерней сущности** , выберите **создать** , чтобы открыть поиск разрешений сущности, выберите увеличительное стекло и нажмите кнопку **создать** , чтобы добавить новую запись.

![Добавление разрешений сущности в веб-роль](../media/add-entity-permission-web-role.png "Добавление разрешений сущности в веб-роль")  

Выберите сущность как задачи, а область — родительский. Обратите внимание, что затем можно выбрать родительскую связь (**задачи, ведущие\_** ). Это разрешение подразумевает, что контакт, который находится в веб-роли с родительским разрешением, будет иметь глобальное разрешение для всех задач, связанных с интересами.

Помните, что для получения списка этих разрешений необходимо включить разрешения сущностей в списке, и должны быть действия, позволяющие пользователям выполнять действия, для которых были предоставлены разрешения. Кроме того, разрешения также должны быть включены в записи [формы сущности](entity-forms.md) , и эта форма должна быть отображая страницей с вложенной сеткой для сущности, которую вы хотите включить с дочерними разрешениями, в этом случае это задачи. Кроме того, чтобы включить разрешения на чтение или создание для задач, необходимо также настроить эти формы и изменить формы, чтобы удалить поле в отношении подстановки.  

![Изменение формы веб-страницы](../media/edit-webpage-form.png "Изменение формы веб-страницы")  

Затем он предоставляет разрешения для всех задач, связанных с интересами. Если задачи отображаются в списке сущностей, фильтр по сути добавляется в список, чтобы в списке отображались только те задачи, которые связаны с интересом. В нашем примере они отображаются в виде вложенной сетки в форме сущности.

![Пример задачи](../media/tasks-example.png "Пример задачи")  

## <a name="contact-scoped-permissions-for-tasks"></a>Разрешения с областью действия контакта для задач

Еще один пример — если вы хотите разрешить доступ к задачам, для которых контакт связан с родительским руководителем для этой задачи. Этот сценарий практически идентичен предыдущему разделу, за исключением того, что в данном случае у родительского разрешения есть область контакта, а не глобальная. Связь должна быть указана в родительской связи между сущностью "интерес" и сущностью "контакт".

После этих разрешений пользователи с ролью Менеджер по интересу могут получить доступ к тем, которые связаны с ними напрямую, как указано в разрешении области контакта, и получить доступ к задачам, связанным с теми же интересами, которые указаны в записи дочернего разрешения.

### <a name="see-also"></a>См. также

[Создание веб-ролей для порталов](create-web-roles.md)  
[Управление доступом к веб-страницам для порталов](webpage-access-control.md)
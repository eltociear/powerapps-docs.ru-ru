---
title: Добавление безопасности на основе записей с помощью разрешений сущности для портала | MicrosoftDocs
description: Инструкции по добавлению разрешения сущности и назначению его веб-ролям.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 11/04/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: 47730a2ba169b89534fa93221290c5598a95a8e8
ms.sourcegitcommit: d9cecdd5a35279d78aa1b6c9fc642e36a4e4612c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "2760945"
---
# <a name="add-record-based-security-by-using-entity-permissions-for-portals"></a>Добавление безопасности на основе записей с помощью разрешений сущности для порталов

Чтобы применить безопасность на основе записей на порталах к отдельным записям, используйте разрешения сущностей. Разрешения сущностей добавляются к веб-ролям, позволяя определять роли в организации, которые логически соответствуют привилегиям и концепциям владения записью и доступа к записи, которые введены с помощью разрешений сущностей. Помните, что определенный контакт может принадлежать любому количеству ролей, а определенная роль может содержать неограниченное количество разрешений сущностей. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [Создание веб-ролей для порталов](create-web-roles.md) 

Хотя разрешения на изменение URL-адресов и доступ к ним на карте сайта портала предоставляются путем авторизации содержимого, диспетчеры сайта могут также захотеть защитить свои настраиваемые веб-приложения с помощью форм сущностей и списков сущностей. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [Определение форм сущности](entity-forms.md) и [Определение списков сущностей](entity-lists.md)  

Для защиты этих функций разрешения сущностей обеспечивают предоставление детальных прав для произвольных сущностей, а также позволяют включить безопасность на уровне записей с помощью определений отношений.

## <a name="add-entity-permissions-to-a-web-role"></a>Добавление разрешений сущностей к веб-роли

1.  Откройте [Приложение управления порталом](configure-portal.md).

2. Выберите **Порталы** &gt; **Веб-роли** и откройте веб-роль, к которой требуется добавить разрешения. 

3. Выберите **Добавить** для добавления существующего разрешения сущности к веб-роли. 

4. Выберите **Создать**, чтобы создать новую запись разрешений сущности.

    ![Добавление разрешений сущностей к веб-роли](../media/add-entity-permission-web-role.png "Добавление разрешений сущностей к веб-роли")  

При создании новой записи разрешения сущности сначала требуется определить сущность, которая будет защищаться. На следующем шаге определяются область, как обсуждается ниже, и &mdash; в случае любых областей, кроме глобальной, &mdash; отношения, определяющие эту область. В заключение укажите права, которые предоставляются этой роли через данное разрешение. Обратите внимание, что права являются накопительными, поэтому если пользователь в одной роли получил права чтения, а в другой роли получил права чтения и обновления, пользователь будет иметь права чтения и обновления для всех записей, которые перекрываются между двумя ролями.

> [!Note]
> Выбор сущностей CMS, таких как веб-страница и веб-файлы, недействителен и может иметь непредвиденные побочные последствия. Портал оценивает безопасность сущностей CMS на основе элементов управления доступом к содержимому, а не на основе разрешений сущностей.

### <a name="global-scope"></a>Глобальная область

Если запись разрешения сущности с разрешением чтения предоставлена роли, имеющей глобальную область применения, любой контакт в данной роли получит доступ ко всем записям определенной сущности. Например, они смогут просматривать все интересы, все организации и т. д. Это разрешение будет автоматически учитываться всеми списками сущностей, в целом будут отображаться все записи в точном соответствии с представлениями приложений на основе модели, определенными для этого списка. Более того, если пользователь попытается получить доступ к записи через форму сущности, к которой у него нет доступа, он получит ошибку разрешения.

### <a name="contact-scope"></a>Область контакта

С областью контакта выполнивший вход пользователь в роли, для которой определена запись разрешения, будет обладать правами, предоставляемыми этим разрешением только для записей, связанных с записью контакта пользователя через определенное отношение.

В списке сущностей это означает, что ко всем представлениям приложений на основе модели, доступ к которым предоставляется этим списком, будет добавлен фильтр, который извлекает только записи, напрямую связанные с текущим пользователем. (В зависимости от сценария, это отношение может представлять как "ответственность" или "права управления".)

Формы сущностей будут допускать только соответствующие разрешения для чтения, создания, записи и т. д., если это отношение существует при загрузке записи. [!INCLUDE[proc-more-information](../../../includes/proc-more-information.md)] [Определение форм сущности и настраиваемой логики на портале](entity-forms.md).  

### <a name="account-scope"></a>Область организации

С областью организации выполнивший вход пользователь в роли, для которой определена запись разрешения, будет обладать правами, предоставляемыми этим разрешением только для записей, связанных с записью родительской организации этого пользователя через определенное отношение.

### <a name="self-scope"></a>Область "Самостоятельно"

Область "Самостоятельно" позволяет указать права, которые пользователь имеет для свой собственной записи контакта (удостоверения). Это позволит пользователям использовать формы сущностей или веб-формы, чтобы вносить изменения в свою собственную запись контакта, связанную с их профилем. Обратите внимание, что страница профиля по умолчанию имеет особенную встроенную форму, которая позволяет любому пользователю изменить свою основную контактную информацию, а также принять участие или отказаться от участия в маркетинговых списках. Если эта форма включена в ваш портал (настройка по умолчанию), пользователям не требуется это разрешение для ее использования. Однако им потребуется это разрешение, чтобы использовать любую настраиваемую форму сущности или веб-форму, которая нацелена на их запись контакта пользователя.

### <a name="parental-scope"></a>Родительская область

В этом самом сложном случае разрешения предоставляются для сущности, которая отделена отношением от сущности, для которой запись разрешения сущности уже указана. Это разрешение фактически является дочерней записью родительского разрешения сущности.

Родительская запись разрешения определяет разрешение и область для сущности (вероятно, глобальной или в области контактов, но родительская область также возможна). Эта сущность может быть связана с контактом (в случае области контактов) или определена глобально. Если имеется это разрешение, создается дочернее разрешение, которая определяет отношение другой сущности с сущностью, определенной в родительском отношении.

Таким образом пользователи с веб-ролью, которые имеют доступ к записям, определенным разрешениями родительской сущности, также будут иметь права, как определено дочерней записью разрешения, связанной с родительской записью.

### <a name="attributes-and-relationships"></a>Атрибуты и отношения

Ниже в таблице поясняются атрибуты разрешения сущности.

| Имя                     | Описание                                                                                                                                                                                                                                                                                                               |
|--------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Имя                     | Описательное имя записи. Это поле является обязательным.                                                                                                                                                                                                                                                               |
| Имя сущности              | Логическое имя сущности, которую требуется защитить или которая будет определять отношение контакта или родительское отношение для защиты связанной сущности в дочернем разрешении. Это поле является необходимым.                                                                                                                        |
| Область (обязательное поле)                   | <ul><li>**Глобальный**: предоставление привилегий к записи сущности без каких-либо требований для владельца (контакта).</li><li>**Контакт**: предоставление привилегий к записи сущности, которая имеет непосредственное отношение к владельцу (контакту).</li><li>**Организация**: предоставление привилегий к записи сущности, связанный отношением с организацией, которая выполняет функции владельца, при условии, что эта организация является родительским клиентом контакта.</li><li>**Родитель**: предоставление привилегий к записи сущности с помощью цепочки отношений ее родительских разрешений.</li></ul>|
| Отношение контакта     | Требуется, только если область = контакт. Имя схемы отношения между контактом и сущностью, указанной в поле имени сущности.|
| Родительское отношение      | Требуется только в том случае, если назначено родительское разрешение сущности. Имя схемы отношения между сущностью, определенной в поле имени сущности, и сущностью, определенной в поле имени сущности в ее записи разрешений родительской сущности.                                                                                     |
| Родительское разрешение сущности | Требуется только в том случае, если область = родительский объект.                                                                                                                                                                                                                                                            |
| Прочесть                     | Привилегия, которая определяет, может ли пользователь читать запись.                                                                                                                                                                                                                                                               |
| Запись                    | Привилегия, которая определяет, может ли пользователь обновлять запись.                                                                                                                                                                                                                                                             |
| Создать                   | Привилегия, которая определяет, может ли пользователь создать новую запись. Право на создание записи для типа сущности не применяется к отдельной записи, оно применяется к классу сущностей.                                                                                                                             |
| DELETE                   | Привилегия, которая определяет, может ли пользователь удалять запись.                                                                                                                                                                                                                                                             |
| Добавить                   | Привилегия, определяющая, может ли пользователь вкладывать другую запись в указанную запись. Права доступа "Добавление" и "Добавление к" используются совместно. Каждый раз, когда пользователь добавляет одну запись к другой, пользователь должен иметь оба права. Например, при добавлении примечания к обращению необходимо иметь право доступа "Добавление" для примечания и право доступа "Добавление к" для обращения, чтобы операция была выполнена.  |
| Добавить к                | Привилегия, определяющая, может ли пользователь добавлять рассматриваемую запись в другую запись. Права доступа "Добавление" и "Добавление к" используются совместно. Для получения дополнительных сведений см. описание права "Дополнение".|
| | |

## <a name="global-permissions-for-tasks-related-to-leads"></a>Глобальные разрешения для задач, связанных с интересами

В одном сценарии может потребоваться использовать список сущностей и формы сущности для отображения всех интересов в портале любым пользователям с настраиваемой веб-ролью "Управление интересами". В форме редактирования интереса, которая открывается при выборе строки интереса в списке, будет вложенная сетка, показывающая связанные записи задач. Эти записи должны быть доступны для любого сотрудника с ролью "Управление интересами". На первом шаге мы предоставим глобальные разрешения для интересов всем сотрудникам с ролью "Управление интересами".

Эта роль содержит связанное разрешение сущности для сущности "Интерес", с глобальной областью.

Пользователи с этой ролью имеют доступ ко всем интересам через списки или формы сущностей на портале.

![Предоставление глобальных разрешений для интереса](../media/grant-global-permission-leads.png "Предоставление глобальных разрешений для интереса")  

Теперь мы добавим дочернее разрешение к глобальному разрешению интереса. При открытой записи родительского разрешения сначала перейдите в вложенной сетке **Дочерние разрешения сущности** и выберите **Создать** для открытия поиска разрешений сущности, затем выберите лупу и выберите **Создать** для добавления новой записи.

![Добавление разрешений сущностей к веб-роли](../media/add-entity-permission-web-role.png "Добавление разрешений сущностей к веб-роли")  

Выберите сущность как "Задачи" и область как "Родительская". Обратите внимание, что затем можно выбрать родительское отношение (**Lead\_Tasks**). Это разрешение подразумевает, что контакт, имеющий роль с родительским разрешением, будет иметь глобальное разрешение на все задачи, связанные с интересами.

Помните, что для того, чтобы ваш список учитывал эти разрешения, должны быть включены разрешения сущностей в списке И должны быть действия, которые фактически позволят пользователям выполнять действия, для которых были предоставлены эти разрешения. Более того, разрешения также необходимо включить в записи [формы сущности](entity-forms.md), и эта форма должна показывать страницу, у которой имеется вложенная сетка для сущности, которую требуется включить с дочерними разрешениями, в данном случае это "Задачи". Более того, чтобы включить разрешения чтения или создания для задач, необходимо настроить также и эти формы сущностей, а тоже отредактировать формы, чтобы удалить поле поиска "В отношении" из указанных форм.  

![Изменение формы веб-страницы](../media/edit-webpage-form.png "Изменение формы веб-страницы")  

Затем это предоставит разрешения для всех задач, связанных с интересами. Если задачи отображаются в списке сущностей, по существу в список добавляется фильтр, чтобы в списке отображались только задачи, связанные с интересом. В нашем примере они отображаются с помощью вложенной сетки в форме сущности.

![Пример задачи](../media/tasks-example.png "Пример задачи")  

## <a name="contact-scoped-permissions-for-tasks"></a>Разрешения с областью контакта для задач

Другим примером может быть случай, если требуется разрешить доступ в задачам, для которых контакт связан с родительским интересом для этой задачи. Этот сценарий почти идентичен приведенному в предыдущем разделе, но в этом случае родительское разрешение имеет область контакта, а не глобальную. Необходимо указать отношение в родительском отношении между сущностью интереса и сущностью контакта.

После того как эти разрешения заданы, пользователи с ролью могут получить доступ к интересам, связанным с ними напрямую, как указано в разрешении области контакта, и к задачам, связанным с этими же интересами, как указано в записи дочернего разрешения.

### <a name="see-also"></a>См. также

[Создание веб-ролей для порталов](create-web-roles.md)  
[Управление доступом к веб-страницам для порталов](webpage-access-control.md)
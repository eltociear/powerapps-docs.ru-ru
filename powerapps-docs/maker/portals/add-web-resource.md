---
title: Добавление веб-ресурса службы хранилища Azure в форму | MicrosoftDocs
description: Действия по добавлению веб-ресурса службы хранилища Azure в форму для отправки вложений в службу хранилища Azure.
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 10/07/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: c735513bc0a8f325aaf0debca2170131d45178dc
ms.sourcegitcommit: d9cecdd5a35279d78aa1b6c9fc642e36a4e4612c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73543129"
---
# <a name="add-the-azure-storage-web-resource-to-a-form"></a>Добавление веб-ресурса хранилища Azure в форму

Вложения, передаваемые в службу хранилища Azure, а не непосредственно в Common Data Service, можно управлять с помощью заметок в Common Data Service.

Чтобы разрешить передачу вложений из определенной формы в службу хранилища Azure, необходимо добавить веб-ресурс в эту форму и [настроить службу хранилища Azure для вашей организации](enable-azure-storage.md).

> [!Note]
> В этом примере форма добавляется в форму интереса для сущности интереса. При редактировании существующих форм рекомендуется использовать осторожность.

Когда файл (например, вложение. zip) отправляется в службу хранилища Azure с помощью портала, он представляется заметкой сущности и заполнителя вложения.

![Вложение в форму](media/notes-attachment-lead-form.png "Заполнитель для вложения в форму")

Обратите внимание, что файл вложения теперь называется вложение. zip. txt. По умолчанию Common Data Service не имеет замысла файла Azure, поэтому файл PlaceHolder. txt хранится в Common Data Service. В контексте хранилища Azure для файла заполнителя отображаются сведения о файле.
```
{
 Name: attachment.zip,
 Type: application/x-zip-compressed,
 Size: 24890882,
 "Url": "https://accountname.blob.core.windows.net/storage/81a9a9491c36e51182760026833bcf82/attachment.zip"
}
```

Чтобы просмотреть файл, хранящийся в Azure, и взаимодействовать с ним, необходимо добавить в форму веб-ресурс ADX. Annotations. HTML. В качестве предварительного требования убедитесь, что у пользователей есть доступ на чтение к adx_setting. В противном случае веб-ресурс не будет отображаться должным образом.

1. В редакторе форм для соответствующей формы выберите **веб-ресурс** на вкладке **Вставка** .

2. В поле **веб-ресурс** выберите **adx_annotations/ADX. Annotations. HTML**.

3. Введите имя и метку для ресурса.

4. В поле **Пользовательский параметр (данные)** введите **азуринаблед = true**. <br>Вы также можете использовать веб-ресурс, не включая поддержку Azure таким образом. в этом случае он будет работать почти полностью так же, как элемент управления по умолчанию.</br>

5. На вкладке **Форматирование** выберите любые правила форматирования. Рекомендуется снять флажок **отображать границу экрана** .

6. Нажмите кнопку **ОК** , чтобы сохранить ресурс.

7. При необходимости можно удалить существующий элемент управления Notes или переместить его на вкладку или раздел, которые помечены как невидимые по умолчанию.

8. Сохраните форму, а затем опубликуйте изменения.

   ![Добавить веб-ресурс](media/add-web-resource.png "Добавление веб-ресурса")

Теперь новый элемент управления будет отображен на странице, что дает возможность управлять вложениями в службе хранилища Azure.

![Вложение файлов Azure в форму](media/azure-file-attachment-lead-form.png "Вложение файлов Azure в форму")

Значок скрепки был заменен значком облака, чтобы отметить, что этот файл хранится в службе хранилища Azure. Вы можете продолжить хранение вложений в Common Data Service; Эти файлы будут отмечены значком скрепки.

> [!Note]
> Вы должны добавить правило общего доступа к ресурсам для разных источников (CORS) в учетной записи хранения Azure, как показано ниже. в противном случае вы увидите обычный значок вложения, а не значок облака.
> - **Разрешенные источники**: укажите домен. Например, contoso.crm.dynamics.com.
> - **Разрешенные команды**: Get, размещение, удаление, Head, POST
> - **Разрешенные заголовки**: укажите заголовки запросов, которые исходный домен может указать в запросе CORS. Например, x-MS-Meta-Data\*,\*x-MS-meta-Target. В этом случае необходимо указать *, в противном случае веб-ресурс будет отображаться неправильно.
> - **Представляемые заголовки**: укажите заголовки ответа, которые могут быть отправлены в ответ на запрос CORS и предоставленные браузером для поставщика запросов. Например, x-MS-meta-\*.
> - **Максимальный возраст (в секундах)** : Укажите максимальное время, в течение которого браузер должен КЭШИРОВАТЬ запрос параметров предварительной проверки. Например, 200.
> 
> [!include[More information](../../includes/proc-more-information.md)] [поддержку CORS для служб хранилища Azure](https://docs.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services).

Если присоединенный файл является изображением, этот элемент управления будет отображать изображение в виде эскиза независимо от того, хранится ли он в Common Data Service или в службе хранилища Azure.

> [!Note]
> Функция эскиза ограничена изображениями размером от 1 МБ.

![Эскиз заметок](media/notes-thumbnail.png "Эскиз заметок")

## <a name="cors-protocol-support"></a>Поддержка протокола CORS

Протокол [CORS](https://www.w3.org/TR/cors/) состоит из набора заголовков, указывающих, можно ли предоставить общий доступ к ответу другому домену.
Для настройки CORS используются следующие параметры сайта.

|                 Имя                  |                                                                            Description                                                                            |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HTTP/Access-Control-Allow-Credential | Единственное допустимое значение для этого заголовка — true (с учетом регистра). Если учетные данные не нужны, пропустите этот заголовок целиком (вместо того, чтобы присвоить ему значение false). |
|   HTTP/Access-Control-Allow-Headers   |                                                   Разделенный запятыми список поддерживаемых заголовков HTTP-запроса.                                                   |
|   HTTP/Access-Control — методы Allow   |                                      Разделенный запятыми список допустимых методов HTTP-запроса, таких как GET, POST и OPTIONS.                                       |
|   HTTP/Access-Control-Allow-Origin    |                   Чтобы разрешить любому ресурсу доступ к ресурсам, можно указать \*. В противном случае укажите универсальный код ресурса (URI), который может получить доступ к ресурсам.                   |
|  HTTP/Access-Control-раскрыть-Headers   |                Разделенный запятыми список имен HTTP-заголовков, отличных от простых заголовков ответа, которые может использовать ресурс и которые могут быть предоставлены.                 |
|      HTTP/Access-Control-max-age      |                                                       Максимальное количество секунд, в течение которых могут кэшироваться результаты.                                                        |
|                                       |                                                                                                                                                                   |

